

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Frequently Asked Questions &mdash; Ansible Documentation</title>
  

  
  
  
  
    <link rel="canonical" href="https://docs.ansible.com/ansible/latest/reference_appendices/faq.html"/>
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>
  <link href='https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.0.3/css/font-awesome.min.css' rel='stylesheet' type='text/css'>

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/ansible.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/ansible.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Glossary" href="glossary.html" />
    <link rel="prev" title="yamllint" href="../dev_guide/testing/sanity/yamllint.html" /> <!---- extra head elements for Ansible beyond RTD Sphinx Theme --->
<script type="text/javascript" src="//www.redhat.com/dtm.js"></script>
<!-- <meta class="swiftype" name="published_at" data-type="date" content="2017-12-13" /> -->
<meta class="swiftype" name="version" data-type="string" content="devel">

<!-- Google Tag Manager Data Layer -->
<script>
 dataLayer = [];
</script>
<!-- End Google Tag Manager Data Layer -->

<script src="//cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script> 
</head>

<body class="wy-body-for-nav">
   <!---- extra body elements for Ansible beyond RTD Sphinx Theme --->
<!-- Google Tag Manager -->
<noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-PSB293" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-PSB293');</script>
<!-- End Google Tag Manager -->

  <div class="DocSite-globalNav ansibleNav">
      <ul>
          <li><a href="https://www.ansible.com/ansiblefest" target="_blank">AnsibleFest</a></li>
          <li><a href="https://www.ansible.com/tower" target="_blank">Products</a></li>
          <li><a href="https://www.ansible.com/community" target="_blank">Community</a></li>
          <li><a href="https://www.ansible.com/webinars-training" target="_blank">Webinars & Training</a></li>
          <li><a href="https://www.ansible.com/blog" target="_blank">Blog</a></li>
      </ul>
  </div>

<a class="DocSite-nav" href="/" style="padding-bottom: 30px;">

  <img class="DocSiteNav-logo"
    src="../_static/images/logo_invert.png"
    alt="Ansible Logo">
  <div class="DocSiteNav-title">
    Documentation
  </div>
</a> 
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> Ansible
          

          
          </a>

          
            
            
              <div class="version">
                devel
              </div>
            
          

          <!--- Based on https://github.com/rtfd/sphinx_rtd_theme/pull/438/files -->

<div class="version">
  
    <div class="version-dropdown">
      <select class="version-list" id="version-list" onchange="javascript:location.href = this.value;">
        <script> x = document.getElementById("version-list"); </script>
        
          <script>
            current_url = window.location.href;
            option = document.createElement("option");
            option.text = "latest";
            if ( "latest" == "devel" ) {
              option.selected = true;
            }
            if (current_url.search("devel") > -1) {
              option.value = current_url.replace("devel","latest");
            } else {
              option.value = current_url.replace("latest","latest");
            }
            x.add(option);
          </script>
        
          <script>
            current_url = window.location.href;
            option = document.createElement("option");
            option.text = "2.8";
            if ( "2.8" == "devel" ) {
              option.selected = true;
            }
            if (current_url.search("devel") > -1) {
              option.value = current_url.replace("devel","2.8");
            } else {
              option.value = current_url.replace("latest","2.8");
            }
            x.add(option);
          </script>
        
          <script>
            current_url = window.location.href;
            option = document.createElement("option");
            option.text = "2.7";
            if ( "2.7" == "devel" ) {
              option.selected = true;
            }
            if (current_url.search("devel") > -1) {
              option.value = current_url.replace("devel","2.7");
            } else {
              option.value = current_url.replace("latest","2.7");
            }
            x.add(option);
          </script>
        
          <script>
            current_url = window.location.href;
            option = document.createElement("option");
            option.text = "devel";
            if ( "devel" == "devel" ) {
              option.selected = true;
            }
            if (current_url.search("devel") > -1) {
              option.value = current_url.replace("devel","devel");
            } else {
              option.value = current_url.replace("latest","devel");
            }
            x.add(option);
          </script>
        
      </select>
    </div>
  
</div>
          
<div role="search">
<!--  <form id="rtd-search-form" class="wy-form" action="../search.html" -->
  <form id="rtd-search-form" class="wy-form"  method="get">
    <input type="text" class="st-default-search-input" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Installation, Upgrade &amp; Configuration</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../installation_guide/index.html">Installation Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../porting_guides/porting_guides.html">Ansible Porting Guides</a></li>
</ul>
<p class="caption"><span class="caption-text">Using Ansible</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../user_guide/index.html">User Guide</a></li>
</ul>
<p class="caption"><span class="caption-text">Contributing to Ansible</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../community/index.html">Ansible Community Guide</a></li>
</ul>
<p class="caption"><span class="caption-text">Extending Ansible</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../dev_guide/index.html">Developer Guide</a></li>
</ul>
<p class="caption"><span class="caption-text">Common Ansible Scenarios</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../scenario_guides/cloud_guides.html">Public Cloud Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../scenario_guides/network_guides.html">Network Technology Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../scenario_guides/virt_guides.html">Virtualization and Containerization Guides</a></li>
</ul>
<p class="caption"><span class="caption-text">Network Automation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../network/getting_started/index.html">Network Automation Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../network/user_guide/index.html">Network Automation Advanced Topics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../network/dev_guide/index.html">Network Automation Developer Guide</a></li>
</ul>
<p class="caption"><span class="caption-text">Ansible Galaxy</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../galaxy/user_guide.html">Galaxy User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../galaxy/dev_guide.html">Galaxy Developer Guide</a></li>
</ul>
<p class="caption"><span class="caption-text">Reference &amp; Appendices</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../modules/modules_by_category.html">Module Index</a></li>
<li class="toctree-l1"><a class="reference internal" href="playbooks_keywords.html">Playbook Keywords</a></li>
<li class="toctree-l1"><a class="reference internal" href="common_return_values.html">Return Values</a></li>
<li class="toctree-l1"><a class="reference internal" href="config.html">Ansible Configuration Settings</a></li>
<li class="toctree-l1"><a class="reference internal" href="general_precedence.html">Controlling how Ansible behaves: precedence rules</a></li>
<li class="toctree-l1"><a class="reference internal" href="YAMLSyntax.html">YAML Syntax</a></li>
<li class="toctree-l1"><a class="reference internal" href="python_3_support.html">Python 3 Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="interpreter_discovery.html">Interpreter Discovery</a></li>
<li class="toctree-l1"><a class="reference internal" href="release_and_maintenance.html">Release and maintenance</a></li>
<li class="toctree-l1"><a class="reference internal" href="test_strategies.html">Testing Strategies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev_guide/testing/sanity/index.html">Sanity Tests</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Frequently Asked Questions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#how-can-i-set-the-path-or-any-other-environment-variable-for-a-task-or-entire-playbook">How can I set the PATH or any other environment variable for a task or entire playbook?</a></li>
<li class="toctree-l2"><a class="reference internal" href="#how-do-i-handle-different-machines-needing-different-user-accounts-or-ports-to-log-in-with">How do I handle different machines needing different user accounts or ports to log in with?</a></li>
<li class="toctree-l2"><a class="reference internal" href="#how-do-i-get-ansible-to-reuse-connections-enable-kerberized-ssh-or-have-ansible-pay-attention-to-my-local-ssh-config-file">How do I get ansible to reuse connections, enable Kerberized SSH, or have Ansible pay attention to my local SSH config file?</a></li>
<li class="toctree-l2"><a class="reference internal" href="#how-do-i-configure-a-jump-host-to-access-servers-that-i-have-no-direct-access-to">How do I configure a jump host to access servers that I have no direct access to?</a></li>
<li class="toctree-l2"><a class="reference internal" href="#how-do-i-get-ansible-to-notice-a-dead-target-in-a-timely-manner">How do I get Ansible to notice a dead target in a timely manner?</a></li>
<li class="toctree-l2"><a class="reference internal" href="#how-do-i-speed-up-management-inside-ec2">How do I speed up management inside EC2?</a></li>
<li class="toctree-l2"><a class="reference internal" href="#how-do-i-handle-not-having-a-python-interpreter-at-usr-bin-python-on-a-remote-machine">How do I handle not having a Python interpreter at /usr/bin/python on a remote machine?</a></li>
<li class="toctree-l2"><a class="reference internal" href="#how-do-i-handle-the-package-dependencies-required-by-ansible-package-dependencies-during-ansible-installation">How do I handle the package dependencies required by Ansible package dependencies during Ansible installation ?</a></li>
<li class="toctree-l2"><a class="reference internal" href="#common-platform-issues">Common Platform Issues</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#what-customer-platforms-does-red-hat-support">What customer platforms does Red Hat support?</a></li>
<li class="toctree-l3"><a class="reference internal" href="#running-in-a-virtualenv">Running in a virtualenv</a></li>
<li class="toctree-l3"><a class="reference internal" href="#running-on-bsd">Running on BSD</a></li>
<li class="toctree-l3"><a class="reference internal" href="#running-on-solaris">Running on Solaris</a></li>
<li class="toctree-l3"><a class="reference internal" href="#running-on-z-os">Running on z/OS</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#what-is-the-best-way-to-make-content-reusable-redistributable">What is the best way to make content reusable/redistributable?</a></li>
<li class="toctree-l2"><a class="reference internal" href="#where-does-the-configuration-file-live-and-what-can-i-configure-in-it">Where does the configuration file live and what can I configure in it?</a></li>
<li class="toctree-l2"><a class="reference internal" href="#how-do-i-disable-cowsay">How do I disable cowsay?</a></li>
<li class="toctree-l2"><a class="reference internal" href="#how-do-i-see-a-list-of-all-of-the-ansible-variables">How do I see a list of all of the ansible_ variables?</a></li>
<li class="toctree-l2"><a class="reference internal" href="#how-do-i-see-all-the-inventory-variables-defined-for-my-host">How do I see all the inventory variables defined for my host?</a></li>
<li class="toctree-l2"><a class="reference internal" href="#how-do-i-see-all-the-variables-specific-to-my-host">How do I see all the variables specific to my host?</a></li>
<li class="toctree-l2"><a class="reference internal" href="#how-do-i-loop-over-a-list-of-hosts-in-a-group-inside-of-a-template">How do I loop over a list of hosts in a group, inside of a template?</a></li>
<li class="toctree-l2"><a class="reference internal" href="#how-do-i-access-a-variable-name-programmatically">How do I access a variable name programmatically?</a></li>
<li class="toctree-l2"><a class="reference internal" href="#how-do-i-access-a-group-variable">How do I access a group variable?</a></li>
<li class="toctree-l2"><a class="reference internal" href="#how-do-i-access-a-variable-of-the-first-host-in-a-group">How do I access a variable of the first host in a group?</a></li>
<li class="toctree-l2"><a class="reference internal" href="#how-do-i-copy-files-recursively-onto-a-target-host">How do I copy files recursively onto a target host?</a></li>
<li class="toctree-l2"><a class="reference internal" href="#how-do-i-access-shell-environment-variables">How do I access shell environment variables?</a></li>
<li class="toctree-l2"><a class="reference internal" href="#how-do-i-generate-encrypted-passwords-for-the-user-module">How do I generate encrypted passwords for the user module?</a></li>
<li class="toctree-l2"><a class="reference internal" href="#ansible-allows-dot-notation-and-array-notation-for-variables-which-notation-should-i-use">Ansible allows dot notation and array notation for variables. Which notation should I use?</a></li>
<li class="toctree-l2"><a class="reference internal" href="#when-is-it-unsafe-to-bulk-set-task-arguments-from-a-variable">When is it unsafe to bulk-set task arguments from a variable?</a></li>
<li class="toctree-l2"><a class="reference internal" href="#can-i-get-training-on-ansible">Can I get training on Ansible?</a></li>
<li class="toctree-l2"><a class="reference internal" href="#is-there-a-web-interface-rest-api-etc">Is there a web interface / REST API / etc?</a></li>
<li class="toctree-l2"><a class="reference internal" href="#how-do-i-submit-a-change-to-the-documentation">How do I submit a change to the documentation?</a></li>
<li class="toctree-l2"><a class="reference internal" href="#how-do-i-keep-secret-data-in-my-playbook">How do I keep secret data in my playbook?</a></li>
<li class="toctree-l2"><a class="reference internal" href="#when-should-i-use-also-how-to-interpolate-variables-or-dynamic-variable-names">When should I use {{ }}? Also, how to interpolate variables or dynamic variable names</a></li>
<li class="toctree-l2"><a class="reference internal" href="#why-don-t-you-ship-in-x-format">Why don’t you ship in X format?</a></li>
<li class="toctree-l2"><a class="reference internal" href="#how-do-i-get-the-original-ansible-host-when-i-delegate-a-task">How do I get the original ansible_host when I delegate a task?</a></li>
<li class="toctree-l2"><a class="reference internal" href="#how-do-i-fix-protocol-error-filename-does-not-match-request-when-fetching-a-file">How do I fix ‘protocol error: filename does not match request’ when fetching a file?</a></li>
<li class="toctree-l2"><a class="reference internal" href="#i-don-t-see-my-question-here">I don’t see my question here</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="module_utils.html">Ansible Reference: Module Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="special_variables.html">Special Variables</a></li>
<li class="toctree-l1"><a class="reference internal" href="tower.html">Red Hat Ansible Tower</a></li>
<li class="toctree-l1"><a class="reference internal" href="automationhub.html">Ansible Automation Hub</a></li>
<li class="toctree-l1"><a class="reference internal" href="logging.html">Logging Ansible output</a></li>
</ul>
<p class="caption"><span class="caption-text">Roadmaps</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../roadmap/index.html">Ansible Roadmap</a></li>
</ul>

            
          
        </div>
        
         <!-- extra nav elements for Ansible beyond RTD Sphinx Theme --->
<!-- changeable widget links to tower - do not change as image controlled by Ansible-->
<div id="sideBanner">
  <br/>
  <a href="https://www.ansible.com/docs-left?utm_source=docs">
    <img style="border-width:0px;" src="https://cdn2.hubspot.net/hubfs/330046/docs-graphics/ASB-docs-left-rail.png" />
  </a>
  <br/><br/><br/>
</div>
      </div>
    </nav>
  </div>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Ansible</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          
















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>Frequently Asked Questions</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <!-- Ansible-specific additions for modules etc -->
                
                  <a href="https://github.com/ansible/ansible/edit/devel/docs/docsite/rst/reference_appendices/faq.rst?description=%23%23%23%23%23%20SUMMARY%0A%3C!---%20Your%20description%20here%20--%3E%0A%0A%0A%23%23%23%23%23%20ISSUE%20TYPE%0A-%20Docs%20Pull%20Request%0A%0A%2Blabel:%20docsite_pr" class="fa fa-github"> Edit on GitHub</a>
                
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <!--- Based on sphinx versionwarning extension. Extension currently only works on READTHEDOCS -->
  <script>
    // Create a banner if we're not on the official docs site
    if (location.host == "docs.testing.ansible.com") {
      document.write('<div id="testing_banner_id" class="admonition important">');
      para = document.createElement('p');
      banner_text=document.createTextNode("This is a testing site. For the official docs go to https://docs.ansible.com/");
      para.appendChild(banner_text);
      element = document.getElementById('testing_banner_id');
      element.appendChild(para);
      document.write('</div>');
    }

    // Create a banner if we're not the latest version
    current_url = window.location.href;
    if ((current_url.search("latest") > -1) || (current_url.search("/2.9/") > -1)) {
     // no banner for latest release
    } else if (current_url.search("devel") > -1) {
      document.write('<div id="banner_id" class="admonition caution">');
      para = document.createElement('p');
      banner_text=document.createTextNode("You are reading the *devel* version of the Ansible documentation - this version is not guaranteed stable. Use the version selection to the left if you want the latest stable released version.");
      para.appendChild(banner_text);
      element = document.getElementById('banner_id');
      element.appendChild(para);
      document.write('</div>');
    } else {
      document.write('<div id="banner_id" class="admonition caution">');
      para = document.createElement('p');
      banner_text=document.createTextNode("You are reading an older version of the Ansible documentation. Use the version selection to the left if you want the latest stable released version.");
      para.appendChild(banner_text);
      element = document.getElementById('banner_id');
      element.appendChild(para);
      document.write('</div>');
    }
  </script>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="frequently-asked-questions">
<span id="ansible-faq"></span><h1>Frequently Asked Questions<a class="headerlink" href="#frequently-asked-questions" title="Permalink to this headline">¶</a></h1>
<p>Here are some commonly asked questions and their answers.</p>
<div class="section" id="how-can-i-set-the-path-or-any-other-environment-variable-for-a-task-or-entire-playbook">
<span id="set-environment"></span><h2>How can I set the PATH or any other environment variable for a task or entire playbook?<a class="headerlink" href="#how-can-i-set-the-path-or-any-other-environment-variable-for-a-task-or-entire-playbook" title="Permalink to this headline">¶</a></h2>
<p>Setting environment variables can be done with the <cite>environment</cite> keyword. It can be used at the task or other levels in the play:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">environment</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">PATH</span><span class="p p-Indicator">:</span> <span class="s">&quot;</span><span class="cp">{{</span> <span class="nv">ansible_env.PATH</span> <span class="cp">}}</span><span class="s">:/thingy/bin&quot;</span>
  <span class="l l-Scalar l-Scalar-Plain">SOME</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">value</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">starting in 2.0.1 the setup task from gather_facts also inherits the environment directive from the play, you might need to use the <cite>|default</cite> filter to avoid errors if setting this at play level.</p>
</div>
</div>
<div class="section" id="how-do-i-handle-different-machines-needing-different-user-accounts-or-ports-to-log-in-with">
<span id="faq-setting-users-and-ports"></span><h2>How do I handle different machines needing different user accounts or ports to log in with?<a class="headerlink" href="#how-do-i-handle-different-machines-needing-different-user-accounts-or-ports-to-log-in-with" title="Permalink to this headline">¶</a></h2>
<p>Setting inventory variables in the inventory file is the easiest way.</p>
<p>For instance, suppose these hosts have different usernames and ports:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[webservers]</span>
<span class="na">asdf.example.com  ansible_port</span><span class="o">=</span><span class="s">5000   ansible_user=alice</span>
<span class="na">jkl.example.com   ansible_port</span><span class="o">=</span><span class="s">5001   ansible_user=bob</span>
</pre></div>
</div>
<p>You can also dictate the connection type to be used, if you want:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[testcluster]</span>
<span class="na">localhost           ansible_connection</span><span class="o">=</span><span class="s">local</span>
<span class="na">/path/to/chroot1    ansible_connection</span><span class="o">=</span><span class="s">chroot</span>
<span class="na">foo.example.com     ansible_connection</span><span class="o">=</span><span class="s">paramiko</span>
</pre></div>
</div>
<p>You may also wish to keep these in group variables instead, or file them in a group_vars/&lt;groupname&gt; file.
See the rest of the documentation for more information about how to organize variables.</p>
</div>
<div class="section" id="how-do-i-get-ansible-to-reuse-connections-enable-kerberized-ssh-or-have-ansible-pay-attention-to-my-local-ssh-config-file">
<span id="use-ssh"></span><h2>How do I get ansible to reuse connections, enable Kerberized SSH, or have Ansible pay attention to my local SSH config file?<a class="headerlink" href="#how-do-i-get-ansible-to-reuse-connections-enable-kerberized-ssh-or-have-ansible-pay-attention-to-my-local-ssh-config-file" title="Permalink to this headline">¶</a></h2>
<p>Switch your default connection type in the configuration file to ‘ssh’, or use ‘-c ssh’ to use
Native OpenSSH for connections instead of the python paramiko library.  In Ansible 1.2.1 and later, ‘ssh’ will be used
by default if OpenSSH is new enough to support ControlPersist as an option.</p>
<p>Paramiko is great for starting out, but the OpenSSH type offers many advanced options.  You will want to run Ansible
from a machine new enough to support ControlPersist, if you are using this connection type.  You can still manage
older clients.  If you are using RHEL 6, CentOS 6, SLES 10 or SLES 11 the version of OpenSSH is still a bit old, so
consider managing from a Fedora or openSUSE client even though you are managing older nodes, or just use paramiko.</p>
<p>We keep paramiko as the default as if you are first installing Ansible on an EL box, it offers a better experience
for new users.</p>
</div>
<div class="section" id="how-do-i-configure-a-jump-host-to-access-servers-that-i-have-no-direct-access-to">
<span id="use-ssh-jump-hosts"></span><h2>How do I configure a jump host to access servers that I have no direct access to?<a class="headerlink" href="#how-do-i-configure-a-jump-host-to-access-servers-that-i-have-no-direct-access-to" title="Permalink to this headline">¶</a></h2>
<p>You can set a <cite>ProxyCommand</cite> in the
<cite>ansible_ssh_common_args</cite> inventory variable. Any arguments specified in
this variable are added to the sftp/scp/ssh command line when connecting
to the relevant host(s). Consider the following inventory group:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[gatewayed]</span>
<span class="na">foo ansible_host</span><span class="o">=</span><span class="s">192.0.2.1</span>
<span class="na">bar ansible_host</span><span class="o">=</span><span class="s">192.0.2.2</span>
</pre></div>
</div>
<p>You can create <cite>group_vars/gatewayed.yml</cite> with the following contents:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">ansible_ssh_common_args</span><span class="p p-Indicator">:</span> <span class="s">&#39;-o</span><span class="nv"> </span><span class="s">ProxyCommand=&quot;ssh</span><span class="nv"> </span><span class="s">-W</span><span class="nv"> </span><span class="s">%h:%p</span><span class="nv"> </span><span class="s">-q</span><span class="nv"> </span><span class="s">user@gateway.example.com&quot;&#39;</span>
</pre></div>
</div>
<p>Ansible will append these arguments to the command line when trying to
connect to any hosts in the group <cite>gatewayed</cite>. (These arguments are used
in addition to any <cite>ssh_args</cite> from <cite>ansible.cfg</cite>, so you do not need to
repeat global <cite>ControlPersist</cite> settings in <cite>ansible_ssh_common_args</cite>.)</p>
<p>Note that <cite>ssh -W</cite> is available only with OpenSSH 5.4 or later. With
older versions, it’s necessary to execute <cite>nc %h:%p</cite> or some equivalent
command on the bastion host.</p>
<p>With earlier versions of Ansible, it was necessary to configure a
suitable <cite>ProxyCommand</cite> for one or more hosts in <cite>~/.ssh/config</cite>,
or globally by setting <cite>ssh_args</cite> in <cite>ansible.cfg</cite>.</p>
</div>
<div class="section" id="how-do-i-get-ansible-to-notice-a-dead-target-in-a-timely-manner">
<span id="ssh-serveraliveinterval"></span><h2>How do I get Ansible to notice a dead target in a timely manner?<a class="headerlink" href="#how-do-i-get-ansible-to-notice-a-dead-target-in-a-timely-manner" title="Permalink to this headline">¶</a></h2>
<p>You can add <code class="docutils literal notranslate"><span class="pre">-o</span> <span class="pre">ServerAliveInterval=NumberOfSeconds</span></code> in <code class="docutils literal notranslate"><span class="pre">ssh_args</span></code> from <code class="docutils literal notranslate"><span class="pre">ansible.cfg</span></code>. Without this option, SSH and therefore Ansible will wait until the TCP connection times out. Another solution is to add <code class="docutils literal notranslate"><span class="pre">ServerAliveInterval</span></code> into your global SSH configuration. A good value for <code class="docutils literal notranslate"><span class="pre">ServerAliveInterval</span></code> is up to you to decide; keep in mind that <code class="docutils literal notranslate"><span class="pre">ServerAliveCountMax=3</span></code> is the SSH default so any value you set will be tripled before terminating the SSH session.</p>
</div>
<div class="section" id="how-do-i-speed-up-management-inside-ec2">
<span id="ec2-cloud-performance"></span><h2>How do I speed up management inside EC2?<a class="headerlink" href="#how-do-i-speed-up-management-inside-ec2" title="Permalink to this headline">¶</a></h2>
<p>Don’t try to manage a fleet of EC2 machines from your laptop.  Connect to a management node inside EC2 first
and run Ansible from there.</p>
</div>
<div class="section" id="how-do-i-handle-not-having-a-python-interpreter-at-usr-bin-python-on-a-remote-machine">
<span id="python-interpreters"></span><h2>How do I handle not having a Python interpreter at /usr/bin/python on a remote machine?<a class="headerlink" href="#how-do-i-handle-not-having-a-python-interpreter-at-usr-bin-python-on-a-remote-machine" title="Permalink to this headline">¶</a></h2>
<p>While you can write Ansible modules in any language, most Ansible modules are written in Python,
including the ones central to letting Ansible work.</p>
<p>By default, Ansible assumes it can find a <strong class="command">/usr/bin/python</strong> on your remote system that is
either Python2, version 2.6 or higher or Python3, 3.5 or higher.</p>
<p>Setting the inventory variable <code class="docutils literal notranslate"><span class="pre">ansible_python_interpreter</span></code> on any host will tell Ansible to
auto-replace the Python interpreter with that value instead. Thus, you can point to any Python you
want on the system if <strong class="command">/usr/bin/python</strong> on your system does not point to a compatible
Python interpreter.</p>
<p>Some platforms may only have Python 3 installed by default. If it is not installed as
<strong class="command">/usr/bin/python</strong>, you will need to configure the path to the interpreter via
<code class="docutils literal notranslate"><span class="pre">ansible_python_interpreter</span></code>. Although most core modules will work with Python 3, there may be some
special purpose ones which do not or you may encounter a bug in an edge case. As a temporary
workaround you can install Python 2 on the managed host and configure Ansible to use that Python via
<code class="docutils literal notranslate"><span class="pre">ansible_python_interpreter</span></code>. If there’s no mention in the module’s documentation that the module
requires Python 2, you can also report a bug on our <a class="reference external" href="https://github.com/ansible/ansible/issues">bug tracker</a> so that the incompatibility can be fixed in a future release.</p>
<p>Do not replace the shebang lines of your python modules.  Ansible will do this for you automatically at deploy time.</p>
<p>Also, this works for ANY interpreter, i.e ruby: <cite>ansible_ruby_interpreter</cite>, perl: <cite>ansible_perl_interpreter</cite>, etc,
so you can use this for custom modules written in any scripting language and control the interpreter location.</p>
<p>Keep in mind that if you put <cite>env</cite> in your module shebang line (<cite>#!/usr/bin/env &lt;other&gt;</cite>),
this facility will be ignored so you will be at the mercy of the remote <cite>$PATH</cite>.</p>
</div>
<div class="section" id="how-do-i-handle-the-package-dependencies-required-by-ansible-package-dependencies-during-ansible-installation">
<span id="installation-faqs"></span><h2>How do I handle the package dependencies required by Ansible package dependencies during Ansible installation ?<a class="headerlink" href="#how-do-i-handle-the-package-dependencies-required-by-ansible-package-dependencies-during-ansible-installation" title="Permalink to this headline">¶</a></h2>
<p>While installing Ansible, sometimes you may encounter errors such as <cite>No package ‘libffi’ found</cite> or <cite>fatal error: Python.h: No such file or directory</cite>
These errors are generally caused by the missing packages, which are dependencies of the packages required by Ansible.
For example, <cite>libffi</cite> package is dependency of <cite>pynacl</cite> and <cite>paramiko</cite> (Ansible -&gt; paramiko -&gt; pynacl -&gt; libffi).</p>
<p>In order to solve these kinds of dependency issues, you might need to install required packages using the OS native package managers, such as <cite>yum</cite>, <cite>dnf</cite>, or <cite>apt</cite>, or as mentioned in the package installation guide.</p>
<p>Refer to the documentation of the respective package for such dependencies and their installation methods.</p>
</div>
<div class="section" id="common-platform-issues">
<h2>Common Platform Issues<a class="headerlink" href="#common-platform-issues" title="Permalink to this headline">¶</a></h2>
<div class="section" id="what-customer-platforms-does-red-hat-support">
<h3>What customer platforms does Red Hat support?<a class="headerlink" href="#what-customer-platforms-does-red-hat-support" title="Permalink to this headline">¶</a></h3>
<p>A number of them! For a definitive list please see this <a class="reference external" href="https://access.redhat.com/articles/3168091">Knowledge Base article</a>.</p>
</div>
<div class="section" id="running-in-a-virtualenv">
<h3>Running in a virtualenv<a class="headerlink" href="#running-in-a-virtualenv" title="Permalink to this headline">¶</a></h3>
<p>You can install Ansible into a virtualenv on the controller quite simply:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$ virtualenv ansible
$ <span class="nb">source</span> ./ansible/bin/activate
$ pip install ansible
</pre></div>
</div>
<p>If you want to run under Python 3 instead of Python 2 you may want to change that slightly:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$ virtualenv -p python3 ansible
$ <span class="nb">source</span> ./ansible/bin/activate
$ pip install ansible
</pre></div>
</div>
<p>If you need to use any libraries which are not available via pip (for instance, SELinux Python
bindings on systems such as Red Hat Enterprise Linux or Fedora that have SELinux enabled), then you
need to install them into the virtualenv. There are two methods:</p>
<ul>
<li><p class="first">When you create the virtualenv, specify <code class="docutils literal notranslate"><span class="pre">--system-site-packages</span></code> to make use of any libraries
installed in the system’s Python:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$ virtualenv ansible --system-site-packages
</pre></div>
</div>
</li>
<li><p class="first">Copy those files in manually from the system.  For instance, for SELinux bindings you might do:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$ virtualenv ansible --system-site-packages
$ cp -r -v /usr/lib64/python3.*/site-packages/selinux/ ./py3-ansible/lib64/python3.*/site-packages/
$ cp -v /usr/lib64/python3.*/site-packages/*selinux*.so ./py3-ansible/lib64/python3.*/site-packages/
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="running-on-bsd">
<h3>Running on BSD<a class="headerlink" href="#running-on-bsd" title="Permalink to this headline">¶</a></h3>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="../user_guide/intro_bsd.html#working-with-bsd"><span class="std std-ref">Ansible and BSD</span></a></p>
</div>
</div>
<div class="section" id="running-on-solaris">
<h3>Running on Solaris<a class="headerlink" href="#running-on-solaris" title="Permalink to this headline">¶</a></h3>
<p>By default, Solaris 10 and earlier run a non-POSIX shell which does not correctly expand the default
tmp directory Ansible uses ( <code class="file docutils literal notranslate"><span class="pre">~/.ansible/tmp</span></code>). If you see module failures on Solaris machines, this
is likely the problem. There are several workarounds:</p>
<ul>
<li><p class="first">You can set <code class="docutils literal notranslate"><span class="pre">remote_tmp</span></code> to a path that will expand correctly with the shell you are using (see the plugin documentation for <a class="reference external" href="https://docs.ansible.com/ansible/2.9/plugins/shell/csh.html#csh-shell" title="(in Ansible v2.9)"><span class="xref std std-ref">C shell</span></a>, <a class="reference external" href="https://docs.ansible.com/ansible/2.9/plugins/shell/fish.html#fish-shell" title="(in Ansible v2.9)"><span class="xref std std-ref">fish shell</span></a>, and <a class="reference internal" href="../plugins/shell/powershell.html#powershell-shell"><span class="std std-ref">Powershell</span></a>).  For
example, in the ansible config file you can set:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">remote_tmp=$HOME/.ansible/tmp</span>
</pre></div>
</div>
<p>In Ansible 2.5 and later, you can also set it per-host in inventory like this:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">solaris1 ansible_remote_tmp=$HOME/.ansible/tmp</span>
</pre></div>
</div>
</li>
<li><p class="first">You can set <a class="reference internal" href="../user_guide/intro_inventory.html#ansible-shell-executable"><span class="std std-ref">ansible_shell_executable</span></a> to the path to a POSIX compatible shell. For
instance, many Solaris hosts have a POSIX shell located at <code class="file docutils literal notranslate"><span class="pre">/usr/xpg4/bin/sh</span></code> so you can set
this in inventory like so:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">solaris1 ansible_shell_executable=/usr/xpg4/bin/sh</span>
</pre></div>
</div>
<p>(bash, ksh, and zsh should also be POSIX compatible if you have any of those installed).</p>
</li>
</ul>
</div>
<div class="section" id="running-on-z-os">
<h3>Running on z/OS<a class="headerlink" href="#running-on-z-os" title="Permalink to this headline">¶</a></h3>
<p>There are a few common errors that one might run into when trying to execute Ansible on z/OS as a target.</p>
<ul>
<li><p class="first">Version 2.7.6 of python for z/OS will not work with Ansible because it represents strings internally as EBCDIC.</p>
<p>To get around this limitation, download and install a later version of <a class="reference external" href="https://www.rocketsoftware.com/zos-open-source">python for z/OS</a> (2.7.13 or 3.6.1) that represents strings internally as ASCII.  Version 2.7.13 is verified to work.</p>
</li>
<li><p class="first">When <code class="docutils literal notranslate"><span class="pre">pipelining</span> <span class="pre">=</span> <span class="pre">False</span></code> in <cite>/etc/ansible/ansible.cfg</cite> then Ansible modules are transferred in binary mode via sftp however execution of python fails with</p>
<div class="admonition error">
<p class="first admonition-title">Error</p>
<p class="last">SyntaxError: Non-UTF-8 code starting with ‘\x83’ in file /a/user1/.ansible/tmp/ansible-tmp-1548232945.35-274513842609025/AnsiballZ_stat.py on line 1, but no encoding declared; see <a class="reference external" href="https://python.org/dev/peps/pep-0263/">https://python.org/dev/peps/pep-0263/</a> for details</p>
</div>
<p>To fix it set <code class="docutils literal notranslate"><span class="pre">pipelining</span> <span class="pre">=</span> <span class="pre">True</span></code> in <cite>/etc/ansible/ansible.cfg</cite>.</p>
</li>
<li><p class="first">Python interpret cannot be found in default location <code class="docutils literal notranslate"><span class="pre">/usr/bin/python</span></code> on target host.</p>
<div class="admonition error">
<p class="first admonition-title">Error</p>
<p class="last">/usr/bin/python: EDC5129I No such file or directory</p>
</div>
<p>To fix this set the path to the python installation in your inventory like so:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">zos1 ansible_python_interpreter=/usr/lpp/python/python-2017-04-12-py27/python27/bin/python</span>
</pre></div>
</div>
</li>
<li><p class="first">Start of python fails with <code class="docutils literal notranslate"><span class="pre">The</span> <span class="pre">module</span> <span class="pre">libpython2.7.so</span> <span class="pre">was</span> <span class="pre">not</span> <span class="pre">found.</span></code></p>
<div class="admonition error">
<p class="first admonition-title">Error</p>
<p class="last">EE3501S The module libpython2.7.so was not found.</p>
</div>
<p>On z/OS, you must execute python from gnu bash.  If gnu bash is installed at <code class="docutils literal notranslate"><span class="pre">/usr/lpp/bash</span></code>, you can fix this in your inventory by specifying an <code class="docutils literal notranslate"><span class="pre">ansible_shell_executable</span></code>:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">zos1 ansible_shell_executable=/usr/lpp/bash/bin/bash</span>
</pre></div>
</div>
</li>
</ul>
</div>
</div>
<div class="section" id="what-is-the-best-way-to-make-content-reusable-redistributable">
<span id="use-roles"></span><h2>What is the best way to make content reusable/redistributable?<a class="headerlink" href="#what-is-the-best-way-to-make-content-reusable-redistributable" title="Permalink to this headline">¶</a></h2>
<p>If you have not done so already, read all about “Roles” in the playbooks documentation.  This helps you make playbook content
self-contained, and works well with things like git submodules for sharing content with others.</p>
<p>If some of these plugin types look strange to you, see the API documentation for more details about ways Ansible can be extended.</p>
</div>
<div class="section" id="where-does-the-configuration-file-live-and-what-can-i-configure-in-it">
<span id="configuration-file"></span><h2>Where does the configuration file live and what can I configure in it?<a class="headerlink" href="#where-does-the-configuration-file-live-and-what-can-i-configure-in-it" title="Permalink to this headline">¶</a></h2>
<p>See <a class="reference internal" href="../installation_guide/intro_configuration.html#intro-configuration"><span class="std std-ref">Configuring Ansible</span></a>.</p>
</div>
<div class="section" id="how-do-i-disable-cowsay">
<span id="who-would-ever-want-to-disable-cowsay-but-ok-here-is-how"></span><h2>How do I disable cowsay?<a class="headerlink" href="#how-do-i-disable-cowsay" title="Permalink to this headline">¶</a></h2>
<p>If cowsay is installed, Ansible takes it upon itself to make your day happier when running playbooks.  If you decide
that you would like to work in a professional cow-free environment, you can either uninstall cowsay, set <code class="docutils literal notranslate"><span class="pre">nocows=1</span></code> in ansible.cfg, or set the <span class="target" id="index-0"></span><a class="reference internal" href="config.html#envvar-ANSIBLE_NOCOWS"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">ANSIBLE_NOCOWS</span></code></a> environment variable:</p>
<div class="highlight-shell-session notranslate"><div class="highlight"><pre><span></span><span class="go">export ANSIBLE_NOCOWS=1</span>
</pre></div>
</div>
</div>
<div class="section" id="how-do-i-see-a-list-of-all-of-the-ansible-variables">
<span id="browse-facts"></span><h2>How do I see a list of all of the ansible_ variables?<a class="headerlink" href="#how-do-i-see-a-list-of-all-of-the-ansible-variables" title="Permalink to this headline">¶</a></h2>
<p>Ansible by default gathers “facts” about the machines under management, and these facts can be accessed in Playbooks and in templates. To see a list of all of the facts that are available about a machine, you can run the “setup” module as an ad-hoc action:</p>
<div class="highlight-shell-session notranslate"><div class="highlight"><pre><span></span><span class="go">ansible -m setup hostname</span>
</pre></div>
</div>
<p>This will print out a dictionary of all of the facts that are available for that particular host. You might want to pipe the output to a pager.This does NOT include inventory variables or internal ‘magic’ variables. See the next question if you need more than just ‘facts’.</p>
</div>
<div class="section" id="how-do-i-see-all-the-inventory-variables-defined-for-my-host">
<span id="browse-inventory-vars"></span><h2>How do I see all the inventory variables defined for my host?<a class="headerlink" href="#how-do-i-see-all-the-inventory-variables-defined-for-my-host" title="Permalink to this headline">¶</a></h2>
<p>By running the following command, you can see inventory variables for a host:</p>
<div class="highlight-shell-session notranslate"><div class="highlight"><pre><span></span><span class="go">ansible-inventory --list --yaml</span>
</pre></div>
</div>
</div>
<div class="section" id="how-do-i-see-all-the-variables-specific-to-my-host">
<span id="browse-host-vars"></span><h2>How do I see all the variables specific to my host?<a class="headerlink" href="#how-do-i-see-all-the-variables-specific-to-my-host" title="Permalink to this headline">¶</a></h2>
<p>To see all host specific variables, which might include facts and other sources:</p>
<div class="highlight-shell-session notranslate"><div class="highlight"><pre><span></span><span class="go">ansible -m debug -a &quot;var=hostvars[&#39;hostname&#39;]&quot; localhost</span>
</pre></div>
</div>
<p>Unless you are using a fact cache, you normally need to use a play that gathers facts first, for facts included in the task above.</p>
</div>
<div class="section" id="how-do-i-loop-over-a-list-of-hosts-in-a-group-inside-of-a-template">
<span id="host-loops"></span><h2>How do I loop over a list of hosts in a group, inside of a template?<a class="headerlink" href="#how-do-i-loop-over-a-list-of-hosts-in-a-group-inside-of-a-template" title="Permalink to this headline">¶</a></h2>
<p>A pretty common pattern is to iterate over a list of hosts inside of a host group, perhaps to populate a template configuration
file with a list of servers. To do this, you can just access the “$groups” dictionary in your template, like this:</p>
<div class="highlight-jinja notranslate"><div class="highlight"><pre><span></span><span class="cp">{%</span> <span class="k">for</span> <span class="nv">host</span> <span class="k">in</span> <span class="nv">groups</span><span class="o">[</span><span class="s1">&#39;db_servers&#39;</span><span class="o">]</span> <span class="cp">%}</span><span class="x"></span>
<span class="x">    </span><span class="cp">{{</span> <span class="nv">host</span> <span class="cp">}}</span><span class="x"></span>
<span class="cp">{%</span> <span class="k">endfor</span> <span class="cp">%}</span><span class="x"></span>
</pre></div>
</div>
<p>If you need to access facts about these hosts, for instance, the IP address of each hostname, you need to make sure that the facts have been populated. For example, make sure you have a play that talks to db_servers:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">hosts</span><span class="p p-Indicator">:</span>  <span class="l l-Scalar l-Scalar-Plain">db_servers</span>
  <span class="l l-Scalar l-Scalar-Plain">tasks</span><span class="p p-Indicator">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">debug</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">msg=&quot;doesn&#39;t matter what you do, just that they were talked to previously.&quot;</span>
</pre></div>
</div>
<p>Then you can use the facts inside your template, like this:</p>
<div class="highlight-jinja notranslate"><div class="highlight"><pre><span></span><span class="cp">{%</span> <span class="k">for</span> <span class="nv">host</span> <span class="k">in</span> <span class="nv">groups</span><span class="o">[</span><span class="s1">&#39;db_servers&#39;</span><span class="o">]</span> <span class="cp">%}</span><span class="x"></span>
<span class="x">   </span><span class="cp">{{</span> <span class="nv">hostvars</span><span class="o">[</span><span class="nv">host</span><span class="o">][</span><span class="s1">&#39;ansible_eth0&#39;</span><span class="o">][</span><span class="s1">&#39;ipv4&#39;</span><span class="o">][</span><span class="s1">&#39;address&#39;</span><span class="o">]</span> <span class="cp">}}</span><span class="x"></span>
<span class="cp">{%</span> <span class="k">endfor</span> <span class="cp">%}</span><span class="x"></span>
</pre></div>
</div>
</div>
<div class="section" id="how-do-i-access-a-variable-name-programmatically">
<span id="programatic-access-to-a-variable"></span><h2>How do I access a variable name programmatically?<a class="headerlink" href="#how-do-i-access-a-variable-name-programmatically" title="Permalink to this headline">¶</a></h2>
<p>An example may come up where we need to get the ipv4 address of an arbitrary interface, where the interface to be used may be supplied
via a role parameter or other input.  Variable names can be built by adding strings together, like so:</p>
<div class="highlight-jinja notranslate"><div class="highlight"><pre><span></span><span class="cp">{{</span> <span class="nv">hostvars</span><span class="o">[</span><span class="nv">inventory_hostname</span><span class="o">][</span><span class="s1">&#39;ansible_&#39;</span> <span class="o">+</span> <span class="nv">which_interface</span><span class="o">][</span><span class="s1">&#39;ipv4&#39;</span><span class="o">][</span><span class="s1">&#39;address&#39;</span><span class="o">]</span> <span class="cp">}}</span><span class="x"></span>
</pre></div>
</div>
<p>The trick about going through hostvars is necessary because it’s a dictionary of the entire namespace of variables.  <code class="docutils literal notranslate"><span class="pre">inventory_hostname</span></code>
is a magic variable that indicates the current host you are looping over in the host loop.</p>
<p>In the example above, if your interface names have dashes, you must replace them with underscores:</p>
<div class="highlight-jinja notranslate"><div class="highlight"><pre><span></span><span class="cp">{{</span> <span class="nv">hostvars</span><span class="o">[</span><span class="nv">inventory_hostname</span><span class="o">][</span><span class="s1">&#39;ansible_&#39;</span> <span class="o">+</span> <span class="nv">which_interface</span> <span class="o">|</span> <span class="nf">replace</span><span class="o">(</span><span class="s1">&#39;_&#39;</span><span class="o">,</span> <span class="s1">&#39;-&#39;</span><span class="o">)</span> <span class="o">][</span><span class="s1">&#39;ipv4&#39;</span><span class="o">][</span><span class="s1">&#39;address&#39;</span><span class="o">]</span> <span class="cp">}}</span><span class="x"></span>
</pre></div>
</div>
<p>Also see <a class="reference internal" href="#dynamic-variables">dynamic_variables</a>.</p>
</div>
<div class="section" id="how-do-i-access-a-group-variable">
<span id="access-group-variable"></span><h2>How do I access a group variable?<a class="headerlink" href="#how-do-i-access-a-group-variable" title="Permalink to this headline">¶</a></h2>
<p>Technically, you don’t, Ansible does not really use groups directly. Groups are label for host selection and a way to bulk assign variables, they are not a first class entity, Ansible only cares about Hosts and Tasks.</p>
<p>That said, you could just access the variable by selecting a host that is part of that group, see <a class="reference internal" href="#first-host-in-a-group">first_host_in_a_group</a> below for an example.</p>
</div>
<div class="section" id="how-do-i-access-a-variable-of-the-first-host-in-a-group">
<span id="first-host-in-a-group"></span><h2>How do I access a variable of the first host in a group?<a class="headerlink" href="#how-do-i-access-a-variable-of-the-first-host-in-a-group" title="Permalink to this headline">¶</a></h2>
<p>What happens if we want the ip address of the first webserver in the webservers group?  Well, we can do that too.  Note that if we
are using dynamic inventory, which host is the ‘first’ may not be consistent, so you wouldn’t want to do this unless your inventory
is static and predictable.  (If you are using <a class="reference internal" href="tower.html#ansible-tower"><span class="std std-ref">Red Hat Ansible Tower</span></a>, it will use database order, so this isn’t a problem even if you are using cloud
based inventory scripts).</p>
<p>Anyway, here’s the trick:</p>
<div class="highlight-jinja notranslate"><div class="highlight"><pre><span></span><span class="cp">{{</span> <span class="nv">hostvars</span><span class="o">[</span><span class="nv">groups</span><span class="o">[</span><span class="s1">&#39;webservers&#39;</span><span class="o">][</span><span class="m">0</span><span class="o">]][</span><span class="s1">&#39;ansible_eth0&#39;</span><span class="o">][</span><span class="s1">&#39;ipv4&#39;</span><span class="o">][</span><span class="s1">&#39;address&#39;</span><span class="o">]</span> <span class="cp">}}</span><span class="x"></span>
</pre></div>
</div>
<p>Notice how we’re pulling out the hostname of the first machine of the webservers group.  If you are doing this in a template, you
could use the Jinja2 ‘#set’ directive to simplify this, or in a playbook, you could also use set_fact:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">set_fact</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">headnode=</span><span class="cp">{{</span> <span class="nv">groups</span><span class="o">[[</span><span class="s1">&#39;webservers&#39;</span><span class="o">][</span><span class="m">0</span><span class="o">]]</span> <span class="cp">}}</span>

<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">debug</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">msg=</span><span class="cp">{{</span> <span class="nv">hostvars</span><span class="o">[</span><span class="nv">headnode</span><span class="o">]</span><span class="nv">.ansible_eth0.ipv4.address</span> <span class="cp">}}</span>
</pre></div>
</div>
<p>Notice how we interchanged the bracket syntax for dots – that can be done anywhere.</p>
</div>
<div class="section" id="how-do-i-copy-files-recursively-onto-a-target-host">
<span id="file-recursion"></span><h2>How do I copy files recursively onto a target host?<a class="headerlink" href="#how-do-i-copy-files-recursively-onto-a-target-host" title="Permalink to this headline">¶</a></h2>
<p>The “copy” module has a recursive parameter.  However, take a look at the “synchronize” module if you want to do something more efficient for a large number of files.  The “synchronize” module wraps rsync.  See the module index for info on both of these modules.</p>
</div>
<div class="section" id="how-do-i-access-shell-environment-variables">
<span id="shell-env"></span><h2>How do I access shell environment variables?<a class="headerlink" href="#how-do-i-access-shell-environment-variables" title="Permalink to this headline">¶</a></h2>
<p>If you just need to access existing variables ON THE CONTROLLER, use the ‘env’ lookup plugin.
For example, to access the value of the HOME environment variable on the management machine:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="nn">---</span>
<span class="c1"># ...</span>
  <span class="l l-Scalar l-Scalar-Plain">vars</span><span class="p p-Indicator">:</span>
     <span class="l l-Scalar l-Scalar-Plain">local_home</span><span class="p p-Indicator">:</span> <span class="s">&quot;</span><span class="cp">{{</span> <span class="nv">lookup</span><span class="o">(</span><span class="s1">&#39;env&#39;</span><span class="o">,</span><span class="s1">&#39;HOME&#39;</span><span class="o">)</span> <span class="cp">}}</span><span class="s">&quot;</span>
</pre></div>
</div>
<p>For environment variables on the TARGET machines, they are available via facts in the ‘ansible_env’ variable:</p>
<div class="highlight-jinja notranslate"><div class="highlight"><pre><span></span><span class="cp">{{</span> <span class="nv">ansible_env.SOME_VARIABLE</span> <span class="cp">}}</span><span class="x"></span>
</pre></div>
</div>
<p>If you need to set environment variables for TASK execution, see <a class="reference internal" href="../user_guide/playbooks_environment.html#playbooks-environment"><span class="std std-ref">Setting the Environment (and Working With Proxies)</span></a> in the <a class="reference internal" href="../user_guide/playbooks_special_topics.html#playbooks-special-topics"><span class="std std-ref">Advanced Playbooks</span></a> section.
There are several ways to set environment variables on your target machines. You can use the <a class="reference internal" href="../modules/template_module.html#template-module"><span class="std std-ref">template</span></a>, <a class="reference internal" href="../modules/replace_module.html#replace-module"><span class="std std-ref">replace</span></a>, or <a class="reference internal" href="../modules/lineinfile_module.html#lineinfile-module"><span class="std std-ref">lineinfile</span></a> modules to introduce environment variables into files.
The exact files to edit vary depending on your OS and distribution and local configuration.</p>
</div>
<div class="section" id="how-do-i-generate-encrypted-passwords-for-the-user-module">
<span id="user-passwords"></span><h2>How do I generate encrypted passwords for the user module?<a class="headerlink" href="#how-do-i-generate-encrypted-passwords-for-the-user-module" title="Permalink to this headline">¶</a></h2>
<p>Ansible ad-hoc command is the easiest option:</p>
<div class="highlight-shell-session notranslate"><div class="highlight"><pre><span></span><span class="go">ansible all -i localhost, -m debug -a &quot;msg={{ &#39;mypassword&#39; | password_hash(&#39;sha512&#39;, &#39;mysecretsalt&#39;) }}&quot;</span>
</pre></div>
</div>
<p>The mkpasswd utility that is available on most Linux systems is also a great option:</p>
<div class="highlight-shell-session notranslate"><div class="highlight"><pre><span></span><span class="go">mkpasswd --method=sha-512</span>
</pre></div>
</div>
<p>If this utility is not installed on your system (e.g. you are using macOS) then you can still easily
generate these passwords using Python. First, ensure that the <a class="reference external" href="https://bitbucket.org/ecollins/passlib/wiki/Home">Passlib</a>
password hashing library is installed:</p>
<div class="highlight-shell-session notranslate"><div class="highlight"><pre><span></span><span class="go">pip install passlib</span>
</pre></div>
</div>
<p>Once the library is ready, SHA512 password values can then be generated as follows:</p>
<div class="highlight-shell-session notranslate"><div class="highlight"><pre><span></span><span class="go">python -c &quot;from passlib.hash import sha512_crypt; import getpass; print(sha512_crypt.using(rounds=5000).hash(getpass.getpass()))&quot;</span>
</pre></div>
</div>
<p>Use the integrated <a class="reference internal" href="../user_guide/playbooks_filters.html#hash-filters"><span class="std std-ref">Encryption filters</span></a> to generate a hashed version of a password.
You shouldn’t put plaintext passwords in your playbook or host_vars; instead, use <a class="reference internal" href="../user_guide/playbooks_vault.html#playbooks-vault"><span class="std std-ref">Using Vault in playbooks</span></a> to encrypt sensitive data.</p>
<p>In OpenBSD, a similar option is available in the base system called encrypt(1):</p>
<div class="highlight-shell-session notranslate"><div class="highlight"><pre><span></span><span class="go">encrypt</span>
</pre></div>
</div>
</div>
<div class="section" id="ansible-allows-dot-notation-and-array-notation-for-variables-which-notation-should-i-use">
<span id="dot-or-array-notation"></span><h2>Ansible allows dot notation and array notation for variables. Which notation should I use?<a class="headerlink" href="#ansible-allows-dot-notation-and-array-notation-for-variables-which-notation-should-i-use" title="Permalink to this headline">¶</a></h2>
<p>The dot notation comes from Jinja and works fine for variables without special
characters. If your variable contains dots (.), colons (:), or dashes (-), if
a key begins and ends with two underscores, or if a key uses any of the known
public attributes, it is safer to use the array notation. See <a class="reference internal" href="../user_guide/playbooks_variables.html#playbooks-variables"><span class="std std-ref">Using Variables</span></a>
for a list of the known public attributes.</p>
<div class="highlight-jinja notranslate"><div class="highlight"><pre><span></span><span class="x">item[0][&#39;checksum:md5&#39;]</span>
<span class="x">item[&#39;section&#39;][&#39;2.1&#39;]</span>
<span class="x">item[&#39;region&#39;][&#39;Mid-Atlantic&#39;]</span>
<span class="x">It is </span><span class="cp">{{</span> <span class="nv">temperature</span><span class="o">[</span><span class="s1">&#39;Celsius&#39;</span><span class="o">][</span><span class="s1">&#39;-3&#39;</span><span class="o">]</span> <span class="cp">}}</span><span class="x"> outside.</span>
</pre></div>
</div>
<p>Also array notation allows for dynamic variable composition, see <a class="reference internal" href="#dynamic-variables">dynamic_variables</a>.</p>
<p>Another problem with ‘dot notation’ is that some keys can cause problems because they collide with attributes and methods of python dictionaries.</p>
<div class="highlight-jinja notranslate"><div class="highlight"><pre><span></span><span class="x">item.update # this breaks if item is a dictionary, as &#39;update()&#39; is a python method for dictionaries</span>
<span class="x">item[&#39;update&#39;] # this works</span>
</pre></div>
</div>
</div>
<div class="section" id="when-is-it-unsafe-to-bulk-set-task-arguments-from-a-variable">
<span id="argsplat-unsafe"></span><h2>When is it unsafe to bulk-set task arguments from a variable?<a class="headerlink" href="#when-is-it-unsafe-to-bulk-set-task-arguments-from-a-variable" title="Permalink to this headline">¶</a></h2>
<p>You can set all of a task’s arguments from a dictionary-typed variable. This
technique can be useful in some dynamic execution scenarios. However, it
introduces a security risk. We do not recommend it, so Ansible issues a
warning when you do something like this:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="c1">#...</span>
<span class="l l-Scalar l-Scalar-Plain">vars</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">usermod_args</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">testuser</span>
    <span class="l l-Scalar l-Scalar-Plain">state</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">present</span>
    <span class="l l-Scalar l-Scalar-Plain">update_password</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">always</span>
<span class="l l-Scalar l-Scalar-Plain">tasks</span><span class="p p-Indicator">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">user</span><span class="p p-Indicator">:</span> <span class="s">&#39;</span><span class="cp">{{</span> <span class="nv">usermod_args</span> <span class="cp">}}</span><span class="s">&#39;</span>
</pre></div>
</div>
<p>This particular example is safe. However, constructing tasks like this is
risky because the parameters and values passed to <code class="docutils literal notranslate"><span class="pre">usermod_args</span></code> could
be overwritten by malicious values in the <code class="docutils literal notranslate"><span class="pre">host</span> <span class="pre">facts</span></code> on a compromised
target machine. To mitigate this risk:</p>
<ul class="simple">
<li>set bulk variables at a level of precedence greater than <code class="docutils literal notranslate"><span class="pre">host</span> <span class="pre">facts</span></code> in the order of precedence found in <a class="reference internal" href="../user_guide/playbooks_variables.html#ansible-variable-precedence"><span class="std std-ref">Variable precedence: Where should I put a variable?</span></a> (the example above is safe because play vars take precedence over facts)</li>
<li>disable the <a class="reference internal" href="config.html#inject-facts-as-vars"><span class="std std-ref">INJECT_FACTS_AS_VARS</span></a> configuration setting to prevent fact values from colliding with variables (this will also disable the original warning)</li>
</ul>
</div>
<div class="section" id="can-i-get-training-on-ansible">
<span id="commercial-support"></span><h2>Can I get training on Ansible?<a class="headerlink" href="#can-i-get-training-on-ansible" title="Permalink to this headline">¶</a></h2>
<p>Yes!  See our <a class="reference external" href="https://www.ansible.com/products/consulting">services page</a> for information on our services and training offerings. Email <a class="reference external" href="mailto:info&#37;&#52;&#48;ansible&#46;com">info<span>&#64;</span>ansible<span>&#46;</span>com</a> for further details.</p>
<p>We also offer free web-based training classes on a regular basis. See our <a class="reference external" href="https://www.ansible.com/resources/webinars-training">webinar page</a> for more info on upcoming webinars.</p>
</div>
<div class="section" id="is-there-a-web-interface-rest-api-etc">
<span id="web-interface"></span><h2>Is there a web interface / REST API / etc?<a class="headerlink" href="#is-there-a-web-interface-rest-api-etc" title="Permalink to this headline">¶</a></h2>
<p>Yes!  Ansible, Inc makes a great product that makes Ansible even more powerful and easy to use. See <a class="reference internal" href="tower.html#ansible-tower"><span class="std std-ref">Red Hat Ansible Tower</span></a>.</p>
</div>
<div class="section" id="how-do-i-submit-a-change-to-the-documentation">
<span id="docs-contributions"></span><h2>How do I submit a change to the documentation?<a class="headerlink" href="#how-do-i-submit-a-change-to-the-documentation" title="Permalink to this headline">¶</a></h2>
<p>Great question!  Documentation for Ansible is kept in the main project git repository, and complete instructions for contributing can be found in the docs README <a class="reference external" href="https://github.com/ansible/ansible/blob/devel/docs/docsite/README.md">viewable on GitHub</a>.  Thanks!</p>
</div>
<div class="section" id="how-do-i-keep-secret-data-in-my-playbook">
<span id="keep-secret-data"></span><h2>How do I keep secret data in my playbook?<a class="headerlink" href="#how-do-i-keep-secret-data-in-my-playbook" title="Permalink to this headline">¶</a></h2>
<p>If you would like to keep secret data in your Ansible content and still share it publicly or keep things in source control, see <a class="reference internal" href="../user_guide/playbooks_vault.html#playbooks-vault"><span class="std std-ref">Using Vault in playbooks</span></a>.</p>
<p>If you have a task that you don’t want to show the results or command given to it when using -v (verbose) mode, the following task or playbook attribute can be useful:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">secret task</span>
  <span class="l l-Scalar l-Scalar-Plain">shell</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">/usr/bin/do_something --value=</span><span class="cp">{{</span> <span class="nv">secret_value</span> <span class="cp">}}</span>
  <span class="l l-Scalar l-Scalar-Plain">no_log</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">True</span>
</pre></div>
</div>
<p>This can be used to keep verbose output but hide sensitive information from others who would otherwise like to be able to see the output.</p>
<p>The no_log attribute can also apply to an entire play:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">hosts</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">all</span>
  <span class="l l-Scalar l-Scalar-Plain">no_log</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">True</span>
</pre></div>
</div>
<p>Though this will make the play somewhat difficult to debug.  It’s recommended that this
be applied to single tasks only, once a playbook is completed. Note that the use of the
no_log attribute does not prevent data from being shown when debugging Ansible itself via
the <span class="target" id="index-1"></span><a class="reference internal" href="config.html#envvar-ANSIBLE_DEBUG"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">ANSIBLE_DEBUG</span></code></a> environment variable.</p>
</div>
<div class="section" id="when-should-i-use-also-how-to-interpolate-variables-or-dynamic-variable-names">
<span id="interpolate-variables"></span><span id="dynamic-variables"></span><span id="when-to-use-brackets"></span><h2>When should I use {{ }}? Also, how to interpolate variables or dynamic variable names<a class="headerlink" href="#when-should-i-use-also-how-to-interpolate-variables-or-dynamic-variable-names" title="Permalink to this headline">¶</a></h2>
<p>A steadfast rule is ‘always use <code class="docutils literal notranslate"><span class="pre">{{</span> <span class="pre">}}</span></code> except when <code class="docutils literal notranslate"><span class="pre">when:</span></code>’.
Conditionals are always run through Jinja2 as to resolve the expression,
so <code class="docutils literal notranslate"><span class="pre">when:</span></code>, <code class="docutils literal notranslate"><span class="pre">failed_when:</span></code> and <code class="docutils literal notranslate"><span class="pre">changed_when:</span></code> are always templated and you should avoid adding <code class="docutils literal notranslate"><span class="pre">{{</span> <span class="pre">}}</span></code>.</p>
<p>In most other cases you should always use the brackets, even if previously you could use variables without specifying (like <code class="docutils literal notranslate"><span class="pre">loop</span></code> or <code class="docutils literal notranslate"><span class="pre">with_</span></code> clauses), as this made it hard to distinguish between an undefined variable and a string.</p>
<p>Another rule is ‘moustaches don’t stack’. We often see this:</p>
<div class="highlight-jinja notranslate"><div class="highlight"><pre><span></span><span class="cp">{{</span> <span class="nv">somevar_</span><span class="o">{{</span><span class="nv">other_var</span><span class="cp">}}</span><span class="x"> }}</span>
</pre></div>
</div>
<p>The above DOES NOT WORK as you expect, if you need to use a dynamic variable use the following as appropriate:</p>
<div class="highlight-jinja notranslate"><div class="highlight"><pre><span></span><span class="cp">{{</span> <span class="nv">hostvars</span><span class="o">[</span><span class="nv">inventory_hostname</span><span class="o">][</span><span class="s1">&#39;somevar_&#39;</span> <span class="o">+</span> <span class="nv">other_var</span><span class="o">]</span> <span class="cp">}}</span><span class="x"></span>
</pre></div>
</div>
<p>For ‘non host vars’ you can use the <a class="reference internal" href="../plugins/lookup/vars.html#vars-lookup"><span class="std std-ref">vars lookup</span></a> plugin:</p>
<div class="highlight-jinja notranslate"><div class="highlight"><pre><span></span><span class="cp">{{</span> <span class="nv">lookup</span><span class="o">(</span><span class="s1">&#39;vars&#39;</span><span class="o">,</span> <span class="s1">&#39;somevar_&#39;</span> <span class="o">+</span> <span class="nv">other_var</span><span class="o">)</span> <span class="cp">}}</span><span class="x"></span>
</pre></div>
</div>
</div>
<div class="section" id="why-don-t-you-ship-in-x-format">
<span id="why-no-wheel"></span><h2>Why don’t you ship in X format?<a class="headerlink" href="#why-don-t-you-ship-in-x-format" title="Permalink to this headline">¶</a></h2>
<p>In most cases it has to do with maintainability. There are many ways to ship software and we do not have the resources to release Ansible on every platform.
In some cases there are technical issues. For example, our dependencies are not present on Python Wheels.</p>
</div>
<div class="section" id="how-do-i-get-the-original-ansible-host-when-i-delegate-a-task">
<span id="ansible-host-delegated"></span><h2>How do I get the original ansible_host when I delegate a task?<a class="headerlink" href="#how-do-i-get-the-original-ansible-host-when-i-delegate-a-task" title="Permalink to this headline">¶</a></h2>
<p>As the documentation states, connection variables are taken from the <code class="docutils literal notranslate"><span class="pre">delegate_to</span></code> host so <code class="docutils literal notranslate"><span class="pre">ansible_host</span></code> is overwritten,
but you can still access the original via <code class="docutils literal notranslate"><span class="pre">hostvars</span></code>:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">original_host</span><span class="p p-Indicator">:</span> <span class="s">&quot;</span><span class="cp">{{</span> <span class="nv">hostvars</span><span class="o">[</span><span class="nv">inventory_hostname</span><span class="o">][</span><span class="s1">&#39;ansible_host&#39;</span><span class="o">]</span> <span class="cp">}}</span><span class="s">&quot;</span>
</pre></div>
</div>
<p>This works for all overridden connection variables, like <code class="docutils literal notranslate"><span class="pre">ansible_user</span></code>, <code class="docutils literal notranslate"><span class="pre">ansible_port</span></code>, etc.</p>
</div>
<div class="section" id="how-do-i-fix-protocol-error-filename-does-not-match-request-when-fetching-a-file">
<span id="scp-protocol-error-filename"></span><h2>How do I fix ‘protocol error: filename does not match request’ when fetching a file?<a class="headerlink" href="#how-do-i-fix-protocol-error-filename-does-not-match-request-when-fetching-a-file" title="Permalink to this headline">¶</a></h2>
<p>Newer releases of OpenSSH have a <a class="reference external" href="https://bugzilla.mindrot.org/show_bug.cgi?id=2966">bug</a> in the SCP client that can trigger this error on the Ansible controller when using SCP as the file transfer mechanism:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">failed to transfer file to /tmp/ansible/file.txt\r\nprotocol error</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">filename does not match request</span>
</pre></div>
</div>
<p>In these releases, SCP tries to validate that the path of the file to fetch matches the requested path.
The validation
fails if the remote filename requires quotes to escape spaces or non-ascii characters in its path. To avoid this error:</p>
<ul class="simple">
<li><dl class="first docutils">
<dt>Use SFTP instead of SCP by setting <code class="docutils literal notranslate"><span class="pre">scp_if_ssh</span></code> to <code class="docutils literal notranslate"><span class="pre">smart</span></code> (which tries SFTP first) or to <code class="docutils literal notranslate"><span class="pre">False</span></code>. You can do this in one of four ways:</dt>
<dd><ul class="first last">
<li>Rely on the default setting, which is <code class="docutils literal notranslate"><span class="pre">smart</span></code> - this works if <code class="docutils literal notranslate"><span class="pre">scp_if_ssh</span></code> is not explicitly set anywhere</li>
<li>Set a <a class="reference internal" href="../user_guide/intro_inventory.html#host-variables"><span class="std std-ref">host variable</span></a> or <a class="reference internal" href="../user_guide/intro_inventory.html#group-variables"><span class="std std-ref">group variable</span></a> in inventory: <code class="docutils literal notranslate"><span class="pre">ansible_scp_if_ssh:</span> <span class="pre">False</span></code></li>
<li>Set an environment variable on your control node: <code class="docutils literal notranslate"><span class="pre">export</span> <span class="pre">ANSIBLE_SCP_IF_SSH=False</span></code></li>
<li>Pass an environment variable when you run Ansible: <code class="docutils literal notranslate"><span class="pre">ANSIBLE_SCP_IF_SSH=smart</span> <span class="pre">ansible-playbook</span></code></li>
<li>Modify your <code class="docutils literal notranslate"><span class="pre">ansible.cfg</span></code> file: add <code class="docutils literal notranslate"><span class="pre">scp_if_ssh=False</span></code> to the <code class="docutils literal notranslate"><span class="pre">[ssh_connection]</span></code> section</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>If you must use SCP, set the <code class="docutils literal notranslate"><span class="pre">-T</span></code> arg to tell the SCP client to ignore path validation. You can do this in one of three ways:</dt>
<dd><ul class="first last">
<li>Set a <a class="reference internal" href="../user_guide/intro_inventory.html#host-variables"><span class="std std-ref">host variable</span></a> or <a class="reference internal" href="../user_guide/intro_inventory.html#group-variables"><span class="std std-ref">group variable</span></a>: <code class="docutils literal notranslate"><span class="pre">ansible_scp_extra_args=-T</span></code>,</li>
<li>Export or pass an environment variable: <code class="docutils literal notranslate"><span class="pre">ANSIBLE_SCP_EXTRA_ARGS=-T</span></code></li>
<li>Modify your <code class="docutils literal notranslate"><span class="pre">ansible.cfg</span></code> file: add <code class="docutils literal notranslate"><span class="pre">scp_extra_args=-T</span></code> to the <code class="docutils literal notranslate"><span class="pre">[ssh_connection]</span></code> section</li>
</ul>
</dd>
</dl>
</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If you see an <code class="docutils literal notranslate"><span class="pre">invalid</span> <span class="pre">argument</span></code> error when using <code class="docutils literal notranslate"><span class="pre">-T</span></code>, then your SCP client is not performing filename validation and will not trigger this error.</p>
</div>
</div>
<div class="section" id="i-don-t-see-my-question-here">
<span id="i-dont-see-my-question"></span><h2>I don’t see my question here<a class="headerlink" href="#i-don-t-see-my-question-here" title="Permalink to this headline">¶</a></h2>
<p>Please see the section below for a link to IRC and the Google Group, where you can ask your question there.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="../user_guide/playbooks.html#working-with-playbooks"><span class="std std-ref">Working With Playbooks</span></a></dt>
<dd>An introduction to playbooks</dd>
<dt><a class="reference internal" href="../user_guide/playbooks_best_practices.html#playbooks-best-practices"><span class="std std-ref">Tips and tricks</span></a></dt>
<dd>Best practices advice</dd>
<dt><a class="reference external" href="https://groups.google.com/group/ansible-project">User Mailing List</a></dt>
<dd>Have a question?  Stop by the google group!</dd>
<dt><a class="reference external" href="http://irc.freenode.net">irc.freenode.net</a></dt>
<dd>#ansible IRC chat channel</dd>
</dl>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons">
      
        <a href="glossary.html" class="btn btn-neutral float-right" title="Glossary"/>Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../dev_guide/testing/sanity/yamllint.html" class="btn btn-neutral" title="yamllint"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>


<script type="text/javascript">
  (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
  (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
  e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
  })(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');

  _st('install','yABGvz2N8PwcwBxyfzUc','2.0.0');
</script>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019 Red Hat, Inc.
      <span class="lastupdated">
        Last updated on Aug 10, 2020.
      </span>

    </p>
  </div> 
</footer>
        </div>
      </div>

    </section>

  </div>

  <script type="text/javascript">
      jQuery(function () {
          
          SphinxRtdTheme.Navigation.enableSticky();
          
      });
  </script>

  
  
    
   <!-- extra footer elements for Ansible beyond RTD Sphinx Theme --->
<!-- begin analytics -->
<script type="text/javascript">
var _hsq = _hsq || [];
_hsq.push(["setContentType", "standard-page"]);
      (function(d,s,i,r) {
      if (d.getElementById(i)){return;}
      var n = d.createElement(s),e = document.getElementsByTagName(s)[0];
      n.id=i;n.src = '//js.hs-analytics.net/analytics/'+(Math.ceil(new Date()/r)*r)+'/330046.js';
      e.parentNode.insertBefore(n, e);
      })(document, "script", "hs-analytics",300000);
</script>
<!-- end analytics -->
<script type="text/javascript">
if (("undefined" !== typeof _satellite) && ("function" === typeof _satellite.pageBottom)) {
  _satellite.pageBottom();
}
</script> 

</body>
</html>