

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Using Variables &mdash; Ansible Documentation</title>
  

  
  
  
  
    <link rel="canonical" href="https://docs.ansible.com/ansible/latest/user_guide/playbooks_variables.html"/>
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>
  <link href='https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.0.3/css/font-awesome.min.css' rel='stylesheet' type='text/css'>

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/ansible.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/ansible.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Templating (Jinja2)" href="playbooks_templating.html" />
    <link rel="prev" title="Roles" href="playbooks_reuse_roles.html" /> <!---- extra head elements for Ansible beyond RTD Sphinx Theme --->
<script type="text/javascript" src="//www.redhat.com/dtm.js"></script>
<!-- <meta class="swiftype" name="published_at" data-type="date" content="2017-12-13" /> -->
<meta class="swiftype" name="version" data-type="string" content="devel">

<!-- Google Tag Manager Data Layer -->
<script>
 dataLayer = [];
</script>
<!-- End Google Tag Manager Data Layer -->

<script src="//cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script> 
</head>

<body class="wy-body-for-nav">
   <!---- extra body elements for Ansible beyond RTD Sphinx Theme --->
<!-- Google Tag Manager -->
<noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-PSB293" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-PSB293');</script>
<!-- End Google Tag Manager -->

  <div class="DocSite-globalNav ansibleNav">
      <ul>
          <li><a href="https://www.ansible.com/ansiblefest" target="_blank">AnsibleFest</a></li>
          <li><a href="https://www.ansible.com/tower" target="_blank">Products</a></li>
          <li><a href="https://www.ansible.com/community" target="_blank">Community</a></li>
          <li><a href="https://www.ansible.com/webinars-training" target="_blank">Webinars & Training</a></li>
          <li><a href="https://www.ansible.com/blog" target="_blank">Blog</a></li>
      </ul>
  </div>

<a class="DocSite-nav" href="/" style="padding-bottom: 30px;">

  <img class="DocSiteNav-logo"
    src="../_static/images/logo_invert.png"
    alt="Ansible Logo">
  <div class="DocSiteNav-title">
    Documentation
  </div>
</a> 
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> Ansible
          

          
          </a>

          
            
            
              <div class="version">
                devel
              </div>
            
          

          <!--- Based on https://github.com/rtfd/sphinx_rtd_theme/pull/438/files -->

<div class="version">
  
    <div class="version-dropdown">
      <select class="version-list" id="version-list" onchange="javascript:location.href = this.value;">
        <script> x = document.getElementById("version-list"); </script>
        
          <script>
            current_url = window.location.href;
            option = document.createElement("option");
            option.text = "latest";
            if ( "latest" == "devel" ) {
              option.selected = true;
            }
            if (current_url.search("devel") > -1) {
              option.value = current_url.replace("devel","latest");
            } else {
              option.value = current_url.replace("latest","latest");
            }
            x.add(option);
          </script>
        
          <script>
            current_url = window.location.href;
            option = document.createElement("option");
            option.text = "2.8";
            if ( "2.8" == "devel" ) {
              option.selected = true;
            }
            if (current_url.search("devel") > -1) {
              option.value = current_url.replace("devel","2.8");
            } else {
              option.value = current_url.replace("latest","2.8");
            }
            x.add(option);
          </script>
        
          <script>
            current_url = window.location.href;
            option = document.createElement("option");
            option.text = "2.7";
            if ( "2.7" == "devel" ) {
              option.selected = true;
            }
            if (current_url.search("devel") > -1) {
              option.value = current_url.replace("devel","2.7");
            } else {
              option.value = current_url.replace("latest","2.7");
            }
            x.add(option);
          </script>
        
          <script>
            current_url = window.location.href;
            option = document.createElement("option");
            option.text = "devel";
            if ( "devel" == "devel" ) {
              option.selected = true;
            }
            if (current_url.search("devel") > -1) {
              option.value = current_url.replace("devel","devel");
            } else {
              option.value = current_url.replace("latest","devel");
            }
            x.add(option);
          </script>
        
      </select>
    </div>
  
</div>
          
<div role="search">
<!--  <form id="rtd-search-form" class="wy-form" action="../search.html" -->
  <form id="rtd-search-form" class="wy-form"  method="get">
    <input type="text" class="st-default-search-input" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Installation, Upgrade &amp; Configuration</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../installation_guide/index.html">Installation Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../porting_guides/porting_guides.html">Ansible Porting Guides</a></li>
</ul>
<p class="caption"><span class="caption-text">Using Ansible</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">User Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="quickstart.html">Ansible Quickstart Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="basic_concepts.html">Ansible concepts</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro_getting_started.html">Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro_inventory.html">How to build your inventory</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro_dynamic_inventory.html">Working with dynamic inventory</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro_patterns.html">Patterns: targeting hosts and groups</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro_adhoc.html">Introduction to ad-hoc commands</a></li>
<li class="toctree-l2"><a class="reference internal" href="connection_details.html">Connection methods and details</a></li>
<li class="toctree-l2"><a class="reference internal" href="command_line_tools.html">Working with command line tools</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="playbooks.html">Working With Playbooks</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="playbooks_intro.html">Intro to Playbooks</a></li>
<li class="toctree-l3"><a class="reference internal" href="playbooks_best_practices.html">Tips and tricks</a></li>
<li class="toctree-l3"><a class="reference internal" href="playbooks_reuse.html">Re-using Ansible artifacts</a></li>
<li class="toctree-l3"><a class="reference internal" href="playbooks_reuse_roles.html">Roles</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Using Variables</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#creating-valid-variable-names">Creating valid variable names</a></li>
<li class="toctree-l4"><a class="reference internal" href="#defining-variables-in-inventory">Defining variables in inventory</a></li>
<li class="toctree-l4"><a class="reference internal" href="#defining-variables-in-a-playbook">Defining variables in a playbook</a></li>
<li class="toctree-l4"><a class="reference internal" href="#defining-variables-in-included-files-and-roles">Defining variables in included files and roles</a></li>
<li class="toctree-l4"><a class="reference internal" href="#using-variables-with-jinja2">Using variables with Jinja2</a></li>
<li class="toctree-l4"><a class="reference internal" href="#transforming-variables-with-jinja2-filters">Transforming variables with Jinja2 filters</a></li>
<li class="toctree-l4"><a class="reference internal" href="#hey-wait-a-yaml-gotcha">Hey wait, a YAML gotcha</a></li>
<li class="toctree-l4"><a class="reference internal" href="#variables-discovered-from-systems-facts">Variables discovered from systems: Facts</a></li>
<li class="toctree-l4"><a class="reference internal" href="#registering-variables">Registering variables</a></li>
<li class="toctree-l4"><a class="reference internal" href="#accessing-complex-variable-data">Accessing complex variable data</a></li>
<li class="toctree-l4"><a class="reference internal" href="#accessing-information-about-other-hosts-with-magic-variables">Accessing information about other hosts with magic variables</a></li>
<li class="toctree-l4"><a class="reference internal" href="#defining-variables-in-files">Defining variables in files</a></li>
<li class="toctree-l4"><a class="reference internal" href="#passing-variables-on-the-command-line">Passing variables on the command line</a></li>
<li class="toctree-l4"><a class="reference internal" href="#variable-precedence-where-should-i-put-a-variable">Variable precedence: Where should I put a variable?</a></li>
<li class="toctree-l4"><a class="reference internal" href="#using-advanced-variable-syntax">Using advanced variable syntax</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="playbooks_templating.html">Templating (Jinja2)</a></li>
<li class="toctree-l3"><a class="reference internal" href="playbooks_conditionals.html">Conditionals</a></li>
<li class="toctree-l3"><a class="reference internal" href="playbooks_loops.html">Loops</a></li>
<li class="toctree-l3"><a class="reference internal" href="playbooks_blocks.html">Blocks</a></li>
<li class="toctree-l3"><a class="reference internal" href="playbooks_special_topics.html">Advanced Playbooks Features</a></li>
<li class="toctree-l3"><a class="reference internal" href="playbooks_strategies.html">Controlling playbook execution: strategies and more</a></li>
<li class="toctree-l3"><a class="reference internal" href="guide_rolling_upgrade.html">Playbook Example: Continuous Delivery and Rolling Upgrades</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="become.html">Understanding privilege escalation: become</a></li>
<li class="toctree-l2"><a class="reference internal" href="vault.html">Ansible Vault</a></li>
<li class="toctree-l2"><a class="reference internal" href="sample_setup.html">Sample Ansible setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="modules.html">Working With Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="../plugins/plugins.html">Working With Plugins</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro_bsd.html">Ansible and BSD</a></li>
<li class="toctree-l2"><a class="reference internal" href="windows.html">Windows Guides</a></li>
<li class="toctree-l2"><a class="reference internal" href="collections_using.html">Using collections</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Contributing to Ansible</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../community/index.html">Ansible Community Guide</a></li>
</ul>
<p class="caption"><span class="caption-text">Extending Ansible</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../dev_guide/index.html">Developer Guide</a></li>
</ul>
<p class="caption"><span class="caption-text">Common Ansible Scenarios</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../scenario_guides/cloud_guides.html">Public Cloud Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../scenario_guides/network_guides.html">Network Technology Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../scenario_guides/virt_guides.html">Virtualization and Containerization Guides</a></li>
</ul>
<p class="caption"><span class="caption-text">Network Automation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../network/getting_started/index.html">Network Automation Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../network/user_guide/index.html">Network Automation Advanced Topics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../network/dev_guide/index.html">Network Automation Developer Guide</a></li>
</ul>
<p class="caption"><span class="caption-text">Ansible Galaxy</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../galaxy/user_guide.html">Galaxy User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../galaxy/dev_guide.html">Galaxy Developer Guide</a></li>
</ul>
<p class="caption"><span class="caption-text">Reference &amp; Appendices</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../modules/modules_by_category.html">Module Index</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference_appendices/playbooks_keywords.html">Playbook Keywords</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference_appendices/common_return_values.html">Return Values</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference_appendices/config.html">Ansible Configuration Settings</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference_appendices/general_precedence.html">Controlling how Ansible behaves: precedence rules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference_appendices/YAMLSyntax.html">YAML Syntax</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference_appendices/python_3_support.html">Python 3 Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference_appendices/interpreter_discovery.html">Interpreter Discovery</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference_appendices/release_and_maintenance.html">Release and maintenance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference_appendices/test_strategies.html">Testing Strategies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev_guide/testing/sanity/index.html">Sanity Tests</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference_appendices/faq.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference_appendices/glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference_appendices/module_utils.html">Ansible Reference: Module Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference_appendices/special_variables.html">Special Variables</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference_appendices/tower.html">Red Hat Ansible Tower</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference_appendices/automationhub.html">Ansible Automation Hub</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference_appendices/logging.html">Logging Ansible output</a></li>
</ul>
<p class="caption"><span class="caption-text">Roadmaps</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../roadmap/index.html">Ansible Roadmap</a></li>
</ul>

            
          
        </div>
        
         <!-- extra nav elements for Ansible beyond RTD Sphinx Theme --->
<!-- changeable widget links to tower - do not change as image controlled by Ansible-->
<div id="sideBanner">
  <br/>
  <a href="https://www.ansible.com/docs-left?utm_source=docs">
    <img style="border-width:0px;" src="https://cdn2.hubspot.net/hubfs/330046/docs-graphics/ASB-docs-left-rail.png" />
  </a>
  <br/><br/><br/>
</div>
      </div>
    </nav>
  </div>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Ansible</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          
















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">User Guide</a> &raquo;</li>
        
          <li><a href="playbooks.html">Working With Playbooks</a> &raquo;</li>
        
      <li>Using Variables</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <!-- Ansible-specific additions for modules etc -->
                
                  <a href="https://github.com/ansible/ansible/edit/devel/docs/docsite/rst/user_guide/playbooks_variables.rst?description=%23%23%23%23%23%20SUMMARY%0A%3C!---%20Your%20description%20here%20--%3E%0A%0A%0A%23%23%23%23%23%20ISSUE%20TYPE%0A-%20Docs%20Pull%20Request%0A%0A%2Blabel:%20docsite_pr" class="fa fa-github"> Edit on GitHub</a>
                
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <!--- Based on sphinx versionwarning extension. Extension currently only works on READTHEDOCS -->
  <script>
    // Create a banner if we're not on the official docs site
    if (location.host == "docs.testing.ansible.com") {
      document.write('<div id="testing_banner_id" class="admonition important">');
      para = document.createElement('p');
      banner_text=document.createTextNode("This is a testing site. For the official docs go to https://docs.ansible.com/");
      para.appendChild(banner_text);
      element = document.getElementById('testing_banner_id');
      element.appendChild(para);
      document.write('</div>');
    }

    // Create a banner if we're not the latest version
    current_url = window.location.href;
    if ((current_url.search("latest") > -1) || (current_url.search("/2.9/") > -1)) {
     // no banner for latest release
    } else if (current_url.search("devel") > -1) {
      document.write('<div id="banner_id" class="admonition caution">');
      para = document.createElement('p');
      banner_text=document.createTextNode("You are reading the *devel* version of the Ansible documentation - this version is not guaranteed stable. Use the version selection to the left if you want the latest stable released version.");
      para.appendChild(banner_text);
      element = document.getElementById('banner_id');
      element.appendChild(para);
      document.write('</div>');
    } else {
      document.write('<div id="banner_id" class="admonition caution">');
      para = document.createElement('p');
      banner_text=document.createTextNode("You are reading an older version of the Ansible documentation. Use the version selection to the left if you want the latest stable released version.");
      para.appendChild(banner_text);
      element = document.getElementById('banner_id');
      element.appendChild(para);
      document.write('</div>');
    }
  </script>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="using-variables">
<span id="playbooks-variables"></span><h1>Using Variables<a class="headerlink" href="#using-variables" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><a class="reference internal" href="#creating-valid-variable-names" id="id19">Creating valid variable names</a></li>
<li><a class="reference internal" href="#defining-variables-in-inventory" id="id20">Defining variables in inventory</a></li>
<li><a class="reference internal" href="#defining-variables-in-a-playbook" id="id21">Defining variables in a playbook</a></li>
<li><a class="reference internal" href="#defining-variables-in-included-files-and-roles" id="id22">Defining variables in included files and roles</a></li>
<li><a class="reference internal" href="#using-variables-with-jinja2" id="id23">Using variables with Jinja2</a></li>
<li><a class="reference internal" href="#transforming-variables-with-jinja2-filters" id="id24">Transforming variables with Jinja2 filters</a></li>
<li><a class="reference internal" href="#hey-wait-a-yaml-gotcha" id="id25">Hey wait, a YAML gotcha</a></li>
<li><a class="reference internal" href="#variables-discovered-from-systems-facts" id="id26">Variables discovered from systems: Facts</a><ul>
<li><a class="reference internal" href="#disabling-facts" id="id27">Disabling facts</a></li>
<li><a class="reference internal" href="#local-facts-facts-d" id="id28">Local facts (facts.d)</a></li>
<li><a class="reference internal" href="#ansible-version" id="id29">Ansible version</a></li>
<li><a class="reference internal" href="#caching-facts" id="id30">Caching Facts</a></li>
</ul>
</li>
<li><a class="reference internal" href="#registering-variables" id="id31">Registering variables</a></li>
<li><a class="reference internal" href="#accessing-complex-variable-data" id="id32">Accessing complex variable data</a></li>
<li><a class="reference internal" href="#accessing-information-about-other-hosts-with-magic-variables" id="id33">Accessing information about other hosts with magic variables</a></li>
<li><a class="reference internal" href="#defining-variables-in-files" id="id34">Defining variables in files</a></li>
<li><a class="reference internal" href="#passing-variables-on-the-command-line" id="id35">Passing variables on the command line</a></li>
<li><a class="reference internal" href="#variable-precedence-where-should-i-put-a-variable" id="id36">Variable precedence: Where should I put a variable?</a><ul>
<li><a class="reference internal" href="#scoping-variables" id="id37">Scoping variables</a></li>
<li><a class="reference internal" href="#examples-of-where-to-set-a-variable" id="id38">Examples of where to set a variable</a></li>
</ul>
</li>
<li><a class="reference internal" href="#using-advanced-variable-syntax" id="id39">Using advanced variable syntax</a></li>
</ul>
</div>
<p>While automation exists to make it easier to make things repeatable, all systems are not exactly alike; some may require configuration that is slightly different from others. In some instances, the observed behavior or state of one system might influence how you configure other systems. For example, you might need to find out the IP address of a system and use it as a configuration value on another system.</p>
<p>Ansible uses <em>variables</em> to help deal with differences between systems.</p>
<p>To understand variables you’ll also want to read <a class="reference internal" href="playbooks_conditionals.html#playbooks-conditionals"><span class="std std-ref">Conditionals</span></a> and <a class="reference internal" href="playbooks_loops.html#playbooks-loops"><span class="std std-ref">Loops</span></a>.
Useful things like the <strong>group_by</strong> module
and the <code class="docutils literal notranslate"><span class="pre">when</span></code> conditional can also be used with variables, and to help manage differences between systems.</p>
<p>The <a class="reference external" href="https://github.com/ansible/ansible-examples">ansible-examples github repository</a> contains many examples of how variables are used in Ansible.</p>
<div class="section" id="creating-valid-variable-names">
<span id="valid-variable-names"></span><h2><a class="toc-backref" href="#id19">Creating valid variable names</a><a class="headerlink" href="#creating-valid-variable-names" title="Permalink to this headline">¶</a></h2>
<p>Before you start using variables, it’s important to know what are valid variable names.</p>
<p>Variable names should be letters, numbers, and underscores.  Variables should always start with a letter.</p>
<p><code class="docutils literal notranslate"><span class="pre">foo_port</span></code> is a great variable.  <code class="docutils literal notranslate"><span class="pre">foo5</span></code> is fine too.</p>
<p><code class="docutils literal notranslate"><span class="pre">foo-port</span></code>, <code class="docutils literal notranslate"><span class="pre">foo</span> <span class="pre">port</span></code>, <code class="docutils literal notranslate"><span class="pre">foo.port</span></code> and <code class="docutils literal notranslate"><span class="pre">12</span></code> are not valid variable names.</p>
<p><a class="reference external" href="https://docs.python.org/3/reference/lexical_analysis.html#keywords">Python keywords</a>  such as <code class="docutils literal notranslate"><span class="pre">async</span></code> and <code class="docutils literal notranslate"><span class="pre">lambda</span></code> are not valid variable names and thus must be avoided.</p>
<p>YAML also supports dictionaries which map keys to values.  For instance:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">foo</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">field1</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">one</span>
  <span class="l l-Scalar l-Scalar-Plain">field2</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">two</span>
</pre></div>
</div>
<p>You can then reference a specific field in the dictionary using either bracket
notation or dot notation:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">foo[&#39;field1&#39;]</span>
<span class="l l-Scalar l-Scalar-Plain">foo.field1</span>
</pre></div>
</div>
<p>These will both reference the same value (“one”).  However, if you choose to
use dot notation be aware that some keys can cause problems because they
collide with attributes and methods of python dictionaries.  You should use
bracket notation instead of dot notation if you use keys which start and end
with two underscores (Those are reserved for special meanings in python) or
are any of the known public attributes:</p>
<p><code class="docutils literal notranslate"><span class="pre">add</span></code>, <code class="docutils literal notranslate"><span class="pre">append</span></code>, <code class="docutils literal notranslate"><span class="pre">as_integer_ratio</span></code>, <code class="docutils literal notranslate"><span class="pre">bit_length</span></code>, <code class="docutils literal notranslate"><span class="pre">capitalize</span></code>, <code class="docutils literal notranslate"><span class="pre">center</span></code>, <code class="docutils literal notranslate"><span class="pre">clear</span></code>, <code class="docutils literal notranslate"><span class="pre">conjugate</span></code>, <code class="docutils literal notranslate"><span class="pre">copy</span></code>, <code class="docutils literal notranslate"><span class="pre">count</span></code>, <code class="docutils literal notranslate"><span class="pre">decode</span></code>, <code class="docutils literal notranslate"><span class="pre">denominator</span></code>, <code class="docutils literal notranslate"><span class="pre">difference</span></code>, <code class="docutils literal notranslate"><span class="pre">difference_update</span></code>, <code class="docutils literal notranslate"><span class="pre">discard</span></code>, <code class="docutils literal notranslate"><span class="pre">encode</span></code>, <code class="docutils literal notranslate"><span class="pre">endswith</span></code>, <code class="docutils literal notranslate"><span class="pre">expandtabs</span></code>, <code class="docutils literal notranslate"><span class="pre">extend</span></code>, <code class="docutils literal notranslate"><span class="pre">find</span></code>, <code class="docutils literal notranslate"><span class="pre">format</span></code>, <code class="docutils literal notranslate"><span class="pre">fromhex</span></code>, <code class="docutils literal notranslate"><span class="pre">fromkeys</span></code>, <code class="docutils literal notranslate"><span class="pre">get</span></code>, <code class="docutils literal notranslate"><span class="pre">has_key</span></code>, <code class="docutils literal notranslate"><span class="pre">hex</span></code>, <code class="docutils literal notranslate"><span class="pre">imag</span></code>, <code class="docutils literal notranslate"><span class="pre">index</span></code>, <code class="docutils literal notranslate"><span class="pre">insert</span></code>, <code class="docutils literal notranslate"><span class="pre">intersection</span></code>, <code class="docutils literal notranslate"><span class="pre">intersection_update</span></code>, <code class="docutils literal notranslate"><span class="pre">isalnum</span></code>, <code class="docutils literal notranslate"><span class="pre">isalpha</span></code>, <code class="docutils literal notranslate"><span class="pre">isdecimal</span></code>, <code class="docutils literal notranslate"><span class="pre">isdigit</span></code>, <code class="docutils literal notranslate"><span class="pre">isdisjoint</span></code>, <code class="docutils literal notranslate"><span class="pre">is_integer</span></code>, <code class="docutils literal notranslate"><span class="pre">islower</span></code>, <code class="docutils literal notranslate"><span class="pre">isnumeric</span></code>, <code class="docutils literal notranslate"><span class="pre">isspace</span></code>, <code class="docutils literal notranslate"><span class="pre">issubset</span></code>, <code class="docutils literal notranslate"><span class="pre">issuperset</span></code>, <code class="docutils literal notranslate"><span class="pre">istitle</span></code>, <code class="docutils literal notranslate"><span class="pre">isupper</span></code>, <code class="docutils literal notranslate"><span class="pre">items</span></code>, <code class="docutils literal notranslate"><span class="pre">iteritems</span></code>, <code class="docutils literal notranslate"><span class="pre">iterkeys</span></code>, <code class="docutils literal notranslate"><span class="pre">itervalues</span></code>, <code class="docutils literal notranslate"><span class="pre">join</span></code>, <code class="docutils literal notranslate"><span class="pre">keys</span></code>, <code class="docutils literal notranslate"><span class="pre">ljust</span></code>, <code class="docutils literal notranslate"><span class="pre">lower</span></code>, <code class="docutils literal notranslate"><span class="pre">lstrip</span></code>, <code class="docutils literal notranslate"><span class="pre">numerator</span></code>, <code class="docutils literal notranslate"><span class="pre">partition</span></code>, <code class="docutils literal notranslate"><span class="pre">pop</span></code>, <code class="docutils literal notranslate"><span class="pre">popitem</span></code>, <code class="docutils literal notranslate"><span class="pre">real</span></code>, <code class="docutils literal notranslate"><span class="pre">remove</span></code>, <code class="docutils literal notranslate"><span class="pre">replace</span></code>, <code class="docutils literal notranslate"><span class="pre">reverse</span></code>, <code class="docutils literal notranslate"><span class="pre">rfind</span></code>, <code class="docutils literal notranslate"><span class="pre">rindex</span></code>, <code class="docutils literal notranslate"><span class="pre">rjust</span></code>, <code class="docutils literal notranslate"><span class="pre">rpartition</span></code>, <code class="docutils literal notranslate"><span class="pre">rsplit</span></code>, <code class="docutils literal notranslate"><span class="pre">rstrip</span></code>, <code class="docutils literal notranslate"><span class="pre">setdefault</span></code>, <code class="docutils literal notranslate"><span class="pre">sort</span></code>, <code class="docutils literal notranslate"><span class="pre">split</span></code>, <code class="docutils literal notranslate"><span class="pre">splitlines</span></code>, <code class="docutils literal notranslate"><span class="pre">startswith</span></code>, <code class="docutils literal notranslate"><span class="pre">strip</span></code>, <code class="docutils literal notranslate"><span class="pre">swapcase</span></code>, <code class="docutils literal notranslate"><span class="pre">symmetric_difference</span></code>, <code class="docutils literal notranslate"><span class="pre">symmetric_difference_update</span></code>, <code class="docutils literal notranslate"><span class="pre">title</span></code>, <code class="docutils literal notranslate"><span class="pre">translate</span></code>, <code class="docutils literal notranslate"><span class="pre">union</span></code>, <code class="docutils literal notranslate"><span class="pre">update</span></code>, <code class="docutils literal notranslate"><span class="pre">upper</span></code>, <code class="docutils literal notranslate"><span class="pre">values</span></code>, <code class="docutils literal notranslate"><span class="pre">viewitems</span></code>, <code class="docutils literal notranslate"><span class="pre">viewkeys</span></code>, <code class="docutils literal notranslate"><span class="pre">viewvalues</span></code>, <code class="docutils literal notranslate"><span class="pre">zfill</span></code>.</p>
</div>
<div class="section" id="defining-variables-in-inventory">
<span id="variables-in-inventory"></span><h2><a class="toc-backref" href="#id20">Defining variables in inventory</a><a class="headerlink" href="#defining-variables-in-inventory" title="Permalink to this headline">¶</a></h2>
<p>Often you’ll want to set variables for an individual host, or for a group of hosts in your inventory. For instance, machines in Boston
may all use ‘boston.ntp.example.com’ as an NTP server. The <a class="reference internal" href="intro_inventory.html#intro-inventory"><span class="std std-ref">How to build your inventory</span></a> page has details on setting <a class="reference internal" href="intro_inventory.html#host-variables"><span class="std std-ref">Assigning a variable to one machine: host variables</span></a> and <a class="reference internal" href="intro_inventory.html#group-variables"><span class="std std-ref">Assigning a variable to many machines: group variables</span></a> in inventory.</p>
</div>
<div class="section" id="defining-variables-in-a-playbook">
<span id="playbook-variables"></span><h2><a class="toc-backref" href="#id21">Defining variables in a playbook</a><a class="headerlink" href="#defining-variables-in-a-playbook" title="Permalink to this headline">¶</a></h2>
<p>You can define variables directly in a playbook:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">hosts</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">webservers</span>
  <span class="l l-Scalar l-Scalar-Plain">vars</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">http_port</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">80</span>
</pre></div>
</div>
<p>This can be nice as it’s right there when you are reading the playbook.</p>
</div>
<div class="section" id="defining-variables-in-included-files-and-roles">
<span id="included-variables"></span><h2><a class="toc-backref" href="#id22">Defining variables in included files and roles</a><a class="headerlink" href="#defining-variables-in-included-files-and-roles" title="Permalink to this headline">¶</a></h2>
<p>As described in <a class="reference internal" href="playbooks_reuse_roles.html#playbooks-reuse-roles"><span class="std std-ref">Roles</span></a>, variables can also be included in the playbook via include files, which may or may
not be part of an Ansible Role.  Usage of roles is preferred as it provides a nice organizational system.</p>
</div>
<div class="section" id="using-variables-with-jinja2">
<span id="about-jinja2"></span><h2><a class="toc-backref" href="#id23">Using variables with Jinja2</a><a class="headerlink" href="#using-variables-with-jinja2" title="Permalink to this headline">¶</a></h2>
<p>Once you’ve defined variables, you can use them in your playbooks using the Jinja2 templating system.  Here’s a simple Jinja2 template:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">My amp goes to</span> <span class="cp">{{</span> <span class="nv">max_amp_value</span> <span class="cp">}}</span>
</pre></div>
</div>
<p>This expression provides the most basic form of variable substitution.</p>
<p>You can use the same syntax in playbooks. For example:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">template</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">src=foo.cfg.j2 dest=</span><span class="cp">{{</span> <span class="nv">remote_install_path</span> <span class="cp">}}</span><span class="l l-Scalar l-Scalar-Plain">/foo.cfg</span>
</pre></div>
</div>
<p>Here the variable defines the location of a file, which can vary from one system to another.</p>
<p>Inside a template you automatically have access to all variables that are in scope for a host.  Actually
it’s more than that – you can also read variables about other hosts.  We’ll show how to do that in a bit.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">ansible allows Jinja2 loops and conditionals in templates, but in playbooks, we do not use them.  Ansible
playbooks are pure machine-parseable YAML.  This is a rather important feature as it means it is possible to code-generate
pieces of files, or to have other ecosystem tools read Ansible files.  Not everyone will need this but it can unlock
possibilities.</p>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="playbooks_templating.html#playbooks-templating"><span class="std std-ref">Templating (Jinja2)</span></a></dt>
<dd>More information about Jinja2 templating</dd>
</dl>
</div>
</div>
<div class="section" id="transforming-variables-with-jinja2-filters">
<span id="jinja2-filters"></span><h2><a class="toc-backref" href="#id24">Transforming variables with Jinja2 filters</a><a class="headerlink" href="#transforming-variables-with-jinja2-filters" title="Permalink to this headline">¶</a></h2>
<p>Jinja2 filters let you transform the value of a variable within a template expression. For example, the <code class="docutils literal notranslate"><span class="pre">capitalize</span></code> filter capitalizes any value passed to it; the <code class="docutils literal notranslate"><span class="pre">to_yaml</span></code> and <code class="docutils literal notranslate"><span class="pre">to_json</span></code> filters change the format of your variable values. Jinja2 includes many <a class="reference external" href="http://jinja.pocoo.org/docs/templates/#builtin-filters">built-in filters</a> and Ansible supplies <a class="reference internal" href="playbooks_filters.html#playbooks-filters"><span class="std std-ref">many more filters</span></a>.</p>
</div>
<div class="section" id="hey-wait-a-yaml-gotcha">
<span id="yaml-gotchas"></span><h2><a class="toc-backref" href="#id25">Hey wait, a YAML gotcha</a><a class="headerlink" href="#hey-wait-a-yaml-gotcha" title="Permalink to this headline">¶</a></h2>
<p>YAML syntax requires that if you start a value with <code class="docutils literal notranslate"><span class="pre">{{</span> <span class="pre">foo</span> <span class="pre">}}</span></code> you quote the whole line, since it wants to be
sure you aren’t trying to start a YAML dictionary.  This is covered on the <a class="reference internal" href="../reference_appendices/YAMLSyntax.html#yaml-syntax"><span class="std std-ref">YAML Syntax</span></a> documentation.</p>
<p>This won’t work:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">hosts</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">app_servers</span>
  <span class="l l-Scalar l-Scalar-Plain">vars</span><span class="p p-Indicator">:</span>
      <span class="l l-Scalar l-Scalar-Plain">app_path</span><span class="p p-Indicator">:</span> <span class="cp">{{</span> <span class="nv">base_path</span> <span class="cp">}}</span><span class="l l-Scalar l-Scalar-Plain">/22</span>
</pre></div>
</div>
<p>Do it like this and you’ll be fine:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">hosts</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">app_servers</span>
  <span class="l l-Scalar l-Scalar-Plain">vars</span><span class="p p-Indicator">:</span>
       <span class="l l-Scalar l-Scalar-Plain">app_path</span><span class="p p-Indicator">:</span> <span class="s">&quot;</span><span class="cp">{{</span> <span class="nv">base_path</span> <span class="cp">}}</span><span class="s">/22&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="variables-discovered-from-systems-facts">
<span id="vars-and-facts"></span><h2><a class="toc-backref" href="#id26">Variables discovered from systems: Facts</a><a class="headerlink" href="#variables-discovered-from-systems-facts" title="Permalink to this headline">¶</a></h2>
<p>There are other places where variables can come from, but these are a type of variable that are discovered, not set by the user.</p>
<p>Facts are information derived from speaking with your remote systems. You can find a complete set under the <code class="docutils literal notranslate"><span class="pre">ansible_facts</span></code> variable,
most facts are also ‘injected’ as top level variables preserving the <code class="docutils literal notranslate"><span class="pre">ansible_</span></code> prefix, but some are dropped due to conflicts.
This can be disabled via the <a class="reference internal" href="../reference_appendices/config.html#inject-facts-as-vars"><span class="std std-ref">INJECT_FACTS_AS_VARS</span></a> setting.</p>
<p>An example of this might be the IP address of the remote host, or what the operating system is.</p>
<p>To see what information is available, try the following in a play:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">debug</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">var=ansible_facts</span>
</pre></div>
</div>
<p>To see the ‘raw’ information as gathered:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">ansible hostname -m setup</span>
</pre></div>
</div>
<p>This will return a large amount of variable data, which may look like this on Ansible 2.7:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;ansible_all_ipv4_addresses&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;REDACTED IP ADDRESS&quot;</span>
    <span class="p">],</span>
    <span class="nt">&quot;ansible_all_ipv6_addresses&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;REDACTED IPV6 ADDRESS&quot;</span>
    <span class="p">],</span>
    <span class="nt">&quot;ansible_apparmor&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;disabled&quot;</span>
    <span class="p">},</span>
    <span class="nt">&quot;ansible_architecture&quot;</span><span class="p">:</span> <span class="s2">&quot;x86_64&quot;</span><span class="p">,</span>
    <span class="nt">&quot;ansible_bios_date&quot;</span><span class="p">:</span> <span class="s2">&quot;11/28/2013&quot;</span><span class="p">,</span>
    <span class="nt">&quot;ansible_bios_version&quot;</span><span class="p">:</span> <span class="s2">&quot;4.1.5&quot;</span><span class="p">,</span>
    <span class="nt">&quot;ansible_cmdline&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;BOOT_IMAGE&quot;</span><span class="p">:</span> <span class="s2">&quot;/boot/vmlinuz-3.10.0-862.14.4.el7.x86_64&quot;</span><span class="p">,</span>
        <span class="nt">&quot;console&quot;</span><span class="p">:</span> <span class="s2">&quot;ttyS0,115200&quot;</span><span class="p">,</span>
        <span class="nt">&quot;no_timer_check&quot;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
        <span class="nt">&quot;nofb&quot;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
        <span class="nt">&quot;nomodeset&quot;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
        <span class="nt">&quot;ro&quot;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
        <span class="nt">&quot;root&quot;</span><span class="p">:</span> <span class="s2">&quot;LABEL=cloudimg-rootfs&quot;</span><span class="p">,</span>
        <span class="nt">&quot;vga&quot;</span><span class="p">:</span> <span class="s2">&quot;normal&quot;</span>
    <span class="p">},</span>
    <span class="nt">&quot;ansible_date_time&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;date&quot;</span><span class="p">:</span> <span class="s2">&quot;2018-10-25&quot;</span><span class="p">,</span>
        <span class="nt">&quot;day&quot;</span><span class="p">:</span> <span class="s2">&quot;25&quot;</span><span class="p">,</span>
        <span class="nt">&quot;epoch&quot;</span><span class="p">:</span> <span class="s2">&quot;1540469324&quot;</span><span class="p">,</span>
        <span class="nt">&quot;hour&quot;</span><span class="p">:</span> <span class="s2">&quot;12&quot;</span><span class="p">,</span>
        <span class="nt">&quot;iso8601&quot;</span><span class="p">:</span> <span class="s2">&quot;2018-10-25T12:08:44Z&quot;</span><span class="p">,</span>
        <span class="nt">&quot;iso8601_basic&quot;</span><span class="p">:</span> <span class="s2">&quot;20181025T120844109754&quot;</span><span class="p">,</span>
        <span class="nt">&quot;iso8601_basic_short&quot;</span><span class="p">:</span> <span class="s2">&quot;20181025T120844&quot;</span><span class="p">,</span>
        <span class="nt">&quot;iso8601_micro&quot;</span><span class="p">:</span> <span class="s2">&quot;2018-10-25T12:08:44.109968Z&quot;</span><span class="p">,</span>
        <span class="nt">&quot;minute&quot;</span><span class="p">:</span> <span class="s2">&quot;08&quot;</span><span class="p">,</span>
        <span class="nt">&quot;month&quot;</span><span class="p">:</span> <span class="s2">&quot;10&quot;</span><span class="p">,</span>
        <span class="nt">&quot;second&quot;</span><span class="p">:</span> <span class="s2">&quot;44&quot;</span><span class="p">,</span>
        <span class="nt">&quot;time&quot;</span><span class="p">:</span> <span class="s2">&quot;12:08:44&quot;</span><span class="p">,</span>
        <span class="nt">&quot;tz&quot;</span><span class="p">:</span> <span class="s2">&quot;UTC&quot;</span><span class="p">,</span>
        <span class="nt">&quot;tz_offset&quot;</span><span class="p">:</span> <span class="s2">&quot;+0000&quot;</span><span class="p">,</span>
        <span class="nt">&quot;weekday&quot;</span><span class="p">:</span> <span class="s2">&quot;Thursday&quot;</span><span class="p">,</span>
        <span class="nt">&quot;weekday_number&quot;</span><span class="p">:</span> <span class="s2">&quot;4&quot;</span><span class="p">,</span>
        <span class="nt">&quot;weeknumber&quot;</span><span class="p">:</span> <span class="s2">&quot;43&quot;</span><span class="p">,</span>
        <span class="nt">&quot;year&quot;</span><span class="p">:</span> <span class="s2">&quot;2018&quot;</span>
    <span class="p">},</span>
    <span class="nt">&quot;ansible_default_ipv4&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;address&quot;</span><span class="p">:</span> <span class="s2">&quot;REDACTED&quot;</span><span class="p">,</span>
        <span class="nt">&quot;alias&quot;</span><span class="p">:</span> <span class="s2">&quot;eth0&quot;</span><span class="p">,</span>
        <span class="nt">&quot;broadcast&quot;</span><span class="p">:</span> <span class="s2">&quot;REDACTED&quot;</span><span class="p">,</span>
        <span class="nt">&quot;gateway&quot;</span><span class="p">:</span> <span class="s2">&quot;REDACTED&quot;</span><span class="p">,</span>
        <span class="nt">&quot;interface&quot;</span><span class="p">:</span> <span class="s2">&quot;eth0&quot;</span><span class="p">,</span>
        <span class="nt">&quot;macaddress&quot;</span><span class="p">:</span> <span class="s2">&quot;REDACTED&quot;</span><span class="p">,</span>
        <span class="nt">&quot;mtu&quot;</span><span class="p">:</span> <span class="mi">1500</span><span class="p">,</span>
        <span class="nt">&quot;netmask&quot;</span><span class="p">:</span> <span class="s2">&quot;255.255.255.0&quot;</span><span class="p">,</span>
        <span class="nt">&quot;network&quot;</span><span class="p">:</span> <span class="s2">&quot;REDACTED&quot;</span><span class="p">,</span>
        <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;ether&quot;</span>
    <span class="p">},</span>
    <span class="nt">&quot;ansible_default_ipv6&quot;</span><span class="p">:</span> <span class="p">{},</span>
    <span class="nt">&quot;ansible_device_links&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;ids&quot;</span><span class="p">:</span> <span class="p">{},</span>
        <span class="nt">&quot;labels&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="nt">&quot;xvda1&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="s2">&quot;cloudimg-rootfs&quot;</span>
            <span class="p">],</span>
            <span class="nt">&quot;xvdd&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="s2">&quot;config-2&quot;</span>
            <span class="p">]</span>
        <span class="p">},</span>
        <span class="nt">&quot;masters&quot;</span><span class="p">:</span> <span class="p">{},</span>
        <span class="nt">&quot;uuids&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="nt">&quot;xvda1&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="s2">&quot;cac81d61-d0f8-4b47-84aa-b48798239164&quot;</span>
            <span class="p">],</span>
            <span class="nt">&quot;xvdd&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="s2">&quot;2018-10-25-12-05-57-00&quot;</span>
            <span class="p">]</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="nt">&quot;ansible_devices&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;xvda&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="nt">&quot;holders&quot;</span><span class="p">:</span> <span class="p">[],</span>
            <span class="nt">&quot;host&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="nt">&quot;links&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="nt">&quot;ids&quot;</span><span class="p">:</span> <span class="p">[],</span>
                <span class="nt">&quot;labels&quot;</span><span class="p">:</span> <span class="p">[],</span>
                <span class="nt">&quot;masters&quot;</span><span class="p">:</span> <span class="p">[],</span>
                <span class="nt">&quot;uuids&quot;</span><span class="p">:</span> <span class="p">[]</span>
            <span class="p">},</span>
            <span class="nt">&quot;model&quot;</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
            <span class="nt">&quot;partitions&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="nt">&quot;xvda1&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="nt">&quot;holders&quot;</span><span class="p">:</span> <span class="p">[],</span>
                    <span class="nt">&quot;links&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="nt">&quot;ids&quot;</span><span class="p">:</span> <span class="p">[],</span>
                        <span class="nt">&quot;labels&quot;</span><span class="p">:</span> <span class="p">[</span>
                            <span class="s2">&quot;cloudimg-rootfs&quot;</span>
                        <span class="p">],</span>
                        <span class="nt">&quot;masters&quot;</span><span class="p">:</span> <span class="p">[],</span>
                        <span class="nt">&quot;uuids&quot;</span><span class="p">:</span> <span class="p">[</span>
                            <span class="s2">&quot;cac81d61-d0f8-4b47-84aa-b48798239164&quot;</span>
                        <span class="p">]</span>
                    <span class="p">},</span>
                    <span class="nt">&quot;sectors&quot;</span><span class="p">:</span> <span class="s2">&quot;83883999&quot;</span><span class="p">,</span>
                    <span class="nt">&quot;sectorsize&quot;</span><span class="p">:</span> <span class="mi">512</span><span class="p">,</span>
                    <span class="nt">&quot;size&quot;</span><span class="p">:</span> <span class="s2">&quot;40.00 GB&quot;</span><span class="p">,</span>
                    <span class="nt">&quot;start&quot;</span><span class="p">:</span> <span class="s2">&quot;2048&quot;</span><span class="p">,</span>
                    <span class="nt">&quot;uuid&quot;</span><span class="p">:</span> <span class="s2">&quot;cac81d61-d0f8-4b47-84aa-b48798239164&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="nt">&quot;removable&quot;</span><span class="p">:</span> <span class="s2">&quot;0&quot;</span><span class="p">,</span>
            <span class="nt">&quot;rotational&quot;</span><span class="p">:</span> <span class="s2">&quot;0&quot;</span><span class="p">,</span>
            <span class="nt">&quot;sas_address&quot;</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
            <span class="nt">&quot;sas_device_handle&quot;</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
            <span class="nt">&quot;scheduler_mode&quot;</span><span class="p">:</span> <span class="s2">&quot;deadline&quot;</span><span class="p">,</span>
            <span class="nt">&quot;sectors&quot;</span><span class="p">:</span> <span class="s2">&quot;83886080&quot;</span><span class="p">,</span>
            <span class="nt">&quot;sectorsize&quot;</span><span class="p">:</span> <span class="s2">&quot;512&quot;</span><span class="p">,</span>
            <span class="nt">&quot;size&quot;</span><span class="p">:</span> <span class="s2">&quot;40.00 GB&quot;</span><span class="p">,</span>
            <span class="nt">&quot;support_discard&quot;</span><span class="p">:</span> <span class="s2">&quot;0&quot;</span><span class="p">,</span>
            <span class="nt">&quot;vendor&quot;</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
            <span class="nt">&quot;virtual&quot;</span><span class="p">:</span> <span class="mi">1</span>
        <span class="p">},</span>
        <span class="nt">&quot;xvdd&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="nt">&quot;holders&quot;</span><span class="p">:</span> <span class="p">[],</span>
            <span class="nt">&quot;host&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="nt">&quot;links&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="nt">&quot;ids&quot;</span><span class="p">:</span> <span class="p">[],</span>
                <span class="nt">&quot;labels&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="s2">&quot;config-2&quot;</span>
                <span class="p">],</span>
                <span class="nt">&quot;masters&quot;</span><span class="p">:</span> <span class="p">[],</span>
                <span class="nt">&quot;uuids&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="s2">&quot;2018-10-25-12-05-57-00&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span>
            <span class="nt">&quot;model&quot;</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
            <span class="nt">&quot;partitions&quot;</span><span class="p">:</span> <span class="p">{},</span>
            <span class="nt">&quot;removable&quot;</span><span class="p">:</span> <span class="s2">&quot;0&quot;</span><span class="p">,</span>
            <span class="nt">&quot;rotational&quot;</span><span class="p">:</span> <span class="s2">&quot;0&quot;</span><span class="p">,</span>
            <span class="nt">&quot;sas_address&quot;</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
            <span class="nt">&quot;sas_device_handle&quot;</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
            <span class="nt">&quot;scheduler_mode&quot;</span><span class="p">:</span> <span class="s2">&quot;deadline&quot;</span><span class="p">,</span>
            <span class="nt">&quot;sectors&quot;</span><span class="p">:</span> <span class="s2">&quot;131072&quot;</span><span class="p">,</span>
            <span class="nt">&quot;sectorsize&quot;</span><span class="p">:</span> <span class="s2">&quot;512&quot;</span><span class="p">,</span>
            <span class="nt">&quot;size&quot;</span><span class="p">:</span> <span class="s2">&quot;64.00 MB&quot;</span><span class="p">,</span>
            <span class="nt">&quot;support_discard&quot;</span><span class="p">:</span> <span class="s2">&quot;0&quot;</span><span class="p">,</span>
            <span class="nt">&quot;vendor&quot;</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
            <span class="nt">&quot;virtual&quot;</span><span class="p">:</span> <span class="mi">1</span>
        <span class="p">},</span>
        <span class="nt">&quot;xvde&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="nt">&quot;holders&quot;</span><span class="p">:</span> <span class="p">[],</span>
            <span class="nt">&quot;host&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="nt">&quot;links&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="nt">&quot;ids&quot;</span><span class="p">:</span> <span class="p">[],</span>
                <span class="nt">&quot;labels&quot;</span><span class="p">:</span> <span class="p">[],</span>
                <span class="nt">&quot;masters&quot;</span><span class="p">:</span> <span class="p">[],</span>
                <span class="nt">&quot;uuids&quot;</span><span class="p">:</span> <span class="p">[]</span>
            <span class="p">},</span>
            <span class="nt">&quot;model&quot;</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
            <span class="nt">&quot;partitions&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="nt">&quot;xvde1&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="nt">&quot;holders&quot;</span><span class="p">:</span> <span class="p">[],</span>
                    <span class="nt">&quot;links&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="nt">&quot;ids&quot;</span><span class="p">:</span> <span class="p">[],</span>
                        <span class="nt">&quot;labels&quot;</span><span class="p">:</span> <span class="p">[],</span>
                        <span class="nt">&quot;masters&quot;</span><span class="p">:</span> <span class="p">[],</span>
                        <span class="nt">&quot;uuids&quot;</span><span class="p">:</span> <span class="p">[]</span>
                    <span class="p">},</span>
                    <span class="nt">&quot;sectors&quot;</span><span class="p">:</span> <span class="s2">&quot;167770112&quot;</span><span class="p">,</span>
                    <span class="nt">&quot;sectorsize&quot;</span><span class="p">:</span> <span class="mi">512</span><span class="p">,</span>
                    <span class="nt">&quot;size&quot;</span><span class="p">:</span> <span class="s2">&quot;80.00 GB&quot;</span><span class="p">,</span>
                    <span class="nt">&quot;start&quot;</span><span class="p">:</span> <span class="s2">&quot;2048&quot;</span><span class="p">,</span>
                    <span class="nt">&quot;uuid&quot;</span><span class="p">:</span> <span class="kc">null</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="nt">&quot;removable&quot;</span><span class="p">:</span> <span class="s2">&quot;0&quot;</span><span class="p">,</span>
            <span class="nt">&quot;rotational&quot;</span><span class="p">:</span> <span class="s2">&quot;0&quot;</span><span class="p">,</span>
            <span class="nt">&quot;sas_address&quot;</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
            <span class="nt">&quot;sas_device_handle&quot;</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
            <span class="nt">&quot;scheduler_mode&quot;</span><span class="p">:</span> <span class="s2">&quot;deadline&quot;</span><span class="p">,</span>
            <span class="nt">&quot;sectors&quot;</span><span class="p">:</span> <span class="s2">&quot;167772160&quot;</span><span class="p">,</span>
            <span class="nt">&quot;sectorsize&quot;</span><span class="p">:</span> <span class="s2">&quot;512&quot;</span><span class="p">,</span>
            <span class="nt">&quot;size&quot;</span><span class="p">:</span> <span class="s2">&quot;80.00 GB&quot;</span><span class="p">,</span>
            <span class="nt">&quot;support_discard&quot;</span><span class="p">:</span> <span class="s2">&quot;0&quot;</span><span class="p">,</span>
            <span class="nt">&quot;vendor&quot;</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
            <span class="nt">&quot;virtual&quot;</span><span class="p">:</span> <span class="mi">1</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="nt">&quot;ansible_distribution&quot;</span><span class="p">:</span> <span class="s2">&quot;CentOS&quot;</span><span class="p">,</span>
    <span class="nt">&quot;ansible_distribution_file_parsed&quot;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="nt">&quot;ansible_distribution_file_path&quot;</span><span class="p">:</span> <span class="s2">&quot;/etc/redhat-release&quot;</span><span class="p">,</span>
    <span class="nt">&quot;ansible_distribution_file_variety&quot;</span><span class="p">:</span> <span class="s2">&quot;RedHat&quot;</span><span class="p">,</span>
    <span class="nt">&quot;ansible_distribution_major_version&quot;</span><span class="p">:</span> <span class="s2">&quot;7&quot;</span><span class="p">,</span>
    <span class="nt">&quot;ansible_distribution_release&quot;</span><span class="p">:</span> <span class="s2">&quot;Core&quot;</span><span class="p">,</span>
    <span class="nt">&quot;ansible_distribution_version&quot;</span><span class="p">:</span> <span class="s2">&quot;7.5.1804&quot;</span><span class="p">,</span>
    <span class="nt">&quot;ansible_dns&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;nameservers&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s2">&quot;127.0.0.1&quot;</span>
        <span class="p">]</span>
    <span class="p">},</span>
    <span class="nt">&quot;ansible_domain&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="nt">&quot;ansible_effective_group_id&quot;</span><span class="p">:</span> <span class="mi">1000</span><span class="p">,</span>
    <span class="nt">&quot;ansible_effective_user_id&quot;</span><span class="p">:</span> <span class="mi">1000</span><span class="p">,</span>
    <span class="nt">&quot;ansible_env&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;HOME&quot;</span><span class="p">:</span> <span class="s2">&quot;/home/zuul&quot;</span><span class="p">,</span>
        <span class="nt">&quot;LANG&quot;</span><span class="p">:</span> <span class="s2">&quot;en_US.UTF-8&quot;</span><span class="p">,</span>
        <span class="nt">&quot;LESSOPEN&quot;</span><span class="p">:</span> <span class="s2">&quot;||/usr/bin/lesspipe.sh %s&quot;</span><span class="p">,</span>
        <span class="nt">&quot;LOGNAME&quot;</span><span class="p">:</span> <span class="s2">&quot;zuul&quot;</span><span class="p">,</span>
        <span class="nt">&quot;MAIL&quot;</span><span class="p">:</span> <span class="s2">&quot;/var/mail/zuul&quot;</span><span class="p">,</span>
        <span class="nt">&quot;PATH&quot;</span><span class="p">:</span> <span class="s2">&quot;/usr/local/bin:/usr/bin&quot;</span><span class="p">,</span>
        <span class="nt">&quot;PWD&quot;</span><span class="p">:</span> <span class="s2">&quot;/home/zuul&quot;</span><span class="p">,</span>
        <span class="nt">&quot;SELINUX_LEVEL_REQUESTED&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="nt">&quot;SELINUX_ROLE_REQUESTED&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="nt">&quot;SELINUX_USE_CURRENT_RANGE&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="nt">&quot;SHELL&quot;</span><span class="p">:</span> <span class="s2">&quot;/bin/bash&quot;</span><span class="p">,</span>
        <span class="nt">&quot;SHLVL&quot;</span><span class="p">:</span> <span class="s2">&quot;2&quot;</span><span class="p">,</span>
        <span class="nt">&quot;SSH_CLIENT&quot;</span><span class="p">:</span> <span class="s2">&quot;REDACTED 55672 22&quot;</span><span class="p">,</span>
        <span class="nt">&quot;SSH_CONNECTION&quot;</span><span class="p">:</span> <span class="s2">&quot;REDACTED 55672 REDACTED 22&quot;</span><span class="p">,</span>
        <span class="nt">&quot;USER&quot;</span><span class="p">:</span> <span class="s2">&quot;zuul&quot;</span><span class="p">,</span>
        <span class="nt">&quot;XDG_RUNTIME_DIR&quot;</span><span class="p">:</span> <span class="s2">&quot;/run/user/1000&quot;</span><span class="p">,</span>
        <span class="nt">&quot;XDG_SESSION_ID&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
        <span class="nt">&quot;_&quot;</span><span class="p">:</span> <span class="s2">&quot;/usr/bin/python2&quot;</span>
    <span class="p">},</span>
    <span class="nt">&quot;ansible_eth0&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;active&quot;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
        <span class="nt">&quot;device&quot;</span><span class="p">:</span> <span class="s2">&quot;eth0&quot;</span><span class="p">,</span>
        <span class="nt">&quot;ipv4&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="nt">&quot;address&quot;</span><span class="p">:</span> <span class="s2">&quot;REDACTED&quot;</span><span class="p">,</span>
            <span class="nt">&quot;broadcast&quot;</span><span class="p">:</span> <span class="s2">&quot;REDACTED&quot;</span><span class="p">,</span>
            <span class="nt">&quot;netmask&quot;</span><span class="p">:</span> <span class="s2">&quot;255.255.255.0&quot;</span><span class="p">,</span>
            <span class="nt">&quot;network&quot;</span><span class="p">:</span> <span class="s2">&quot;REDACTED&quot;</span>
        <span class="p">},</span>
        <span class="nt">&quot;ipv6&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="nt">&quot;address&quot;</span><span class="p">:</span> <span class="s2">&quot;REDACTED&quot;</span><span class="p">,</span>
                <span class="nt">&quot;prefix&quot;</span><span class="p">:</span> <span class="s2">&quot;64&quot;</span><span class="p">,</span>
                <span class="nt">&quot;scope&quot;</span><span class="p">:</span> <span class="s2">&quot;link&quot;</span>
            <span class="p">}</span>
        <span class="p">],</span>
        <span class="nt">&quot;macaddress&quot;</span><span class="p">:</span> <span class="s2">&quot;REDACTED&quot;</span><span class="p">,</span>
        <span class="nt">&quot;module&quot;</span><span class="p">:</span> <span class="s2">&quot;xen_netfront&quot;</span><span class="p">,</span>
        <span class="nt">&quot;mtu&quot;</span><span class="p">:</span> <span class="mi">1500</span><span class="p">,</span>
        <span class="nt">&quot;pciid&quot;</span><span class="p">:</span> <span class="s2">&quot;vif-0&quot;</span><span class="p">,</span>
        <span class="nt">&quot;promisc&quot;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
        <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;ether&quot;</span>
    <span class="p">},</span>
    <span class="nt">&quot;ansible_eth1&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;active&quot;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
        <span class="nt">&quot;device&quot;</span><span class="p">:</span> <span class="s2">&quot;eth1&quot;</span><span class="p">,</span>
        <span class="nt">&quot;ipv4&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="nt">&quot;address&quot;</span><span class="p">:</span> <span class="s2">&quot;REDACTED&quot;</span><span class="p">,</span>
            <span class="nt">&quot;broadcast&quot;</span><span class="p">:</span> <span class="s2">&quot;REDACTED&quot;</span><span class="p">,</span>
            <span class="nt">&quot;netmask&quot;</span><span class="p">:</span> <span class="s2">&quot;255.255.224.0&quot;</span><span class="p">,</span>
            <span class="nt">&quot;network&quot;</span><span class="p">:</span> <span class="s2">&quot;REDACTED&quot;</span>
        <span class="p">},</span>
        <span class="nt">&quot;ipv6&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="nt">&quot;address&quot;</span><span class="p">:</span> <span class="s2">&quot;REDACTED&quot;</span><span class="p">,</span>
                <span class="nt">&quot;prefix&quot;</span><span class="p">:</span> <span class="s2">&quot;64&quot;</span><span class="p">,</span>
                <span class="nt">&quot;scope&quot;</span><span class="p">:</span> <span class="s2">&quot;link&quot;</span>
            <span class="p">}</span>
        <span class="p">],</span>
        <span class="nt">&quot;macaddress&quot;</span><span class="p">:</span> <span class="s2">&quot;REDACTED&quot;</span><span class="p">,</span>
        <span class="nt">&quot;module&quot;</span><span class="p">:</span> <span class="s2">&quot;xen_netfront&quot;</span><span class="p">,</span>
        <span class="nt">&quot;mtu&quot;</span><span class="p">:</span> <span class="mi">1500</span><span class="p">,</span>
        <span class="nt">&quot;pciid&quot;</span><span class="p">:</span> <span class="s2">&quot;vif-1&quot;</span><span class="p">,</span>
        <span class="nt">&quot;promisc&quot;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
        <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;ether&quot;</span>
    <span class="p">},</span>
    <span class="nt">&quot;ansible_fips&quot;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
    <span class="nt">&quot;ansible_form_factor&quot;</span><span class="p">:</span> <span class="s2">&quot;Other&quot;</span><span class="p">,</span>
    <span class="nt">&quot;ansible_fqdn&quot;</span><span class="p">:</span> <span class="s2">&quot;centos-7-rax-dfw-0003427354&quot;</span><span class="p">,</span>
    <span class="nt">&quot;ansible_hostname&quot;</span><span class="p">:</span> <span class="s2">&quot;centos-7-rax-dfw-0003427354&quot;</span><span class="p">,</span>
    <span class="nt">&quot;ansible_interfaces&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;lo&quot;</span><span class="p">,</span>
        <span class="s2">&quot;eth1&quot;</span><span class="p">,</span>
        <span class="s2">&quot;eth0&quot;</span>
    <span class="p">],</span>
    <span class="nt">&quot;ansible_is_chroot&quot;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
    <span class="nt">&quot;ansible_kernel&quot;</span><span class="p">:</span> <span class="s2">&quot;3.10.0-862.14.4.el7.x86_64&quot;</span><span class="p">,</span>
    <span class="nt">&quot;ansible_lo&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;active&quot;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
        <span class="nt">&quot;device&quot;</span><span class="p">:</span> <span class="s2">&quot;lo&quot;</span><span class="p">,</span>
        <span class="nt">&quot;ipv4&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="nt">&quot;address&quot;</span><span class="p">:</span> <span class="s2">&quot;127.0.0.1&quot;</span><span class="p">,</span>
            <span class="nt">&quot;broadcast&quot;</span><span class="p">:</span> <span class="s2">&quot;host&quot;</span><span class="p">,</span>
            <span class="nt">&quot;netmask&quot;</span><span class="p">:</span> <span class="s2">&quot;255.0.0.0&quot;</span><span class="p">,</span>
            <span class="nt">&quot;network&quot;</span><span class="p">:</span> <span class="s2">&quot;127.0.0.0&quot;</span>
        <span class="p">},</span>
        <span class="nt">&quot;ipv6&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="nt">&quot;address&quot;</span><span class="p">:</span> <span class="s2">&quot;::1&quot;</span><span class="p">,</span>
                <span class="nt">&quot;prefix&quot;</span><span class="p">:</span> <span class="s2">&quot;128&quot;</span><span class="p">,</span>
                <span class="nt">&quot;scope&quot;</span><span class="p">:</span> <span class="s2">&quot;host&quot;</span>
            <span class="p">}</span>
        <span class="p">],</span>
        <span class="nt">&quot;mtu&quot;</span><span class="p">:</span> <span class="mi">65536</span><span class="p">,</span>
        <span class="nt">&quot;promisc&quot;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
        <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;loopback&quot;</span>
    <span class="p">},</span>
    <span class="nt">&quot;ansible_local&quot;</span><span class="p">:</span> <span class="p">{},</span>
    <span class="nt">&quot;ansible_lsb&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;codename&quot;</span><span class="p">:</span> <span class="s2">&quot;Core&quot;</span><span class="p">,</span>
        <span class="nt">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;CentOS Linux release 7.5.1804 (Core)&quot;</span><span class="p">,</span>
        <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;CentOS&quot;</span><span class="p">,</span>
        <span class="nt">&quot;major_release&quot;</span><span class="p">:</span> <span class="s2">&quot;7&quot;</span><span class="p">,</span>
        <span class="nt">&quot;release&quot;</span><span class="p">:</span> <span class="s2">&quot;7.5.1804&quot;</span>
    <span class="p">},</span>
    <span class="nt">&quot;ansible_machine&quot;</span><span class="p">:</span> <span class="s2">&quot;x86_64&quot;</span><span class="p">,</span>
    <span class="nt">&quot;ansible_machine_id&quot;</span><span class="p">:</span> <span class="s2">&quot;2db133253c984c82aef2fafcce6f2bed&quot;</span><span class="p">,</span>
    <span class="nt">&quot;ansible_memfree_mb&quot;</span><span class="p">:</span> <span class="mi">7709</span><span class="p">,</span>
    <span class="nt">&quot;ansible_memory_mb&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;nocache&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="nt">&quot;free&quot;</span><span class="p">:</span> <span class="mi">7804</span><span class="p">,</span>
            <span class="nt">&quot;used&quot;</span><span class="p">:</span> <span class="mi">173</span>
        <span class="p">},</span>
        <span class="nt">&quot;real&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="nt">&quot;free&quot;</span><span class="p">:</span> <span class="mi">7709</span><span class="p">,</span>
            <span class="nt">&quot;total&quot;</span><span class="p">:</span> <span class="mi">7977</span><span class="p">,</span>
            <span class="nt">&quot;used&quot;</span><span class="p">:</span> <span class="mi">268</span>
        <span class="p">},</span>
        <span class="nt">&quot;swap&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="nt">&quot;cached&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="nt">&quot;free&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="nt">&quot;total&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="nt">&quot;used&quot;</span><span class="p">:</span> <span class="mi">0</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="nt">&quot;ansible_memtotal_mb&quot;</span><span class="p">:</span> <span class="mi">7977</span><span class="p">,</span>
    <span class="nt">&quot;ansible_mounts&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="nt">&quot;block_available&quot;</span><span class="p">:</span> <span class="mi">7220998</span><span class="p">,</span>
            <span class="nt">&quot;block_size&quot;</span><span class="p">:</span> <span class="mi">4096</span><span class="p">,</span>
            <span class="nt">&quot;block_total&quot;</span><span class="p">:</span> <span class="mi">9817227</span><span class="p">,</span>
            <span class="nt">&quot;block_used&quot;</span><span class="p">:</span> <span class="mi">2596229</span><span class="p">,</span>
            <span class="nt">&quot;device&quot;</span><span class="p">:</span> <span class="s2">&quot;/dev/xvda1&quot;</span><span class="p">,</span>
            <span class="nt">&quot;fstype&quot;</span><span class="p">:</span> <span class="s2">&quot;ext4&quot;</span><span class="p">,</span>
            <span class="nt">&quot;inode_available&quot;</span><span class="p">:</span> <span class="mi">10052341</span><span class="p">,</span>
            <span class="nt">&quot;inode_total&quot;</span><span class="p">:</span> <span class="mi">10419200</span><span class="p">,</span>
            <span class="nt">&quot;inode_used&quot;</span><span class="p">:</span> <span class="mi">366859</span><span class="p">,</span>
            <span class="nt">&quot;mount&quot;</span><span class="p">:</span> <span class="s2">&quot;/&quot;</span><span class="p">,</span>
            <span class="nt">&quot;options&quot;</span><span class="p">:</span> <span class="s2">&quot;rw,seclabel,relatime,data=ordered&quot;</span><span class="p">,</span>
            <span class="nt">&quot;size_available&quot;</span><span class="p">:</span> <span class="mi">29577207808</span><span class="p">,</span>
            <span class="nt">&quot;size_total&quot;</span><span class="p">:</span> <span class="mi">40211361792</span><span class="p">,</span>
            <span class="nt">&quot;uuid&quot;</span><span class="p">:</span> <span class="s2">&quot;cac81d61-d0f8-4b47-84aa-b48798239164&quot;</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="nt">&quot;block_available&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="nt">&quot;block_size&quot;</span><span class="p">:</span> <span class="mi">2048</span><span class="p">,</span>
            <span class="nt">&quot;block_total&quot;</span><span class="p">:</span> <span class="mi">252</span><span class="p">,</span>
            <span class="nt">&quot;block_used&quot;</span><span class="p">:</span> <span class="mi">252</span><span class="p">,</span>
            <span class="nt">&quot;device&quot;</span><span class="p">:</span> <span class="s2">&quot;/dev/xvdd&quot;</span><span class="p">,</span>
            <span class="nt">&quot;fstype&quot;</span><span class="p">:</span> <span class="s2">&quot;iso9660&quot;</span><span class="p">,</span>
            <span class="nt">&quot;inode_available&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="nt">&quot;inode_total&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="nt">&quot;inode_used&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="nt">&quot;mount&quot;</span><span class="p">:</span> <span class="s2">&quot;/mnt/config&quot;</span><span class="p">,</span>
            <span class="nt">&quot;options&quot;</span><span class="p">:</span> <span class="s2">&quot;ro,relatime,mode=0700&quot;</span><span class="p">,</span>
            <span class="nt">&quot;size_available&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="nt">&quot;size_total&quot;</span><span class="p">:</span> <span class="mi">516096</span><span class="p">,</span>
            <span class="nt">&quot;uuid&quot;</span><span class="p">:</span> <span class="s2">&quot;2018-10-25-12-05-57-00&quot;</span>
        <span class="p">}</span>
    <span class="p">],</span>
    <span class="nt">&quot;ansible_nodename&quot;</span><span class="p">:</span> <span class="s2">&quot;centos-7-rax-dfw-0003427354&quot;</span><span class="p">,</span>
    <span class="nt">&quot;ansible_os_family&quot;</span><span class="p">:</span> <span class="s2">&quot;RedHat&quot;</span><span class="p">,</span>
    <span class="nt">&quot;ansible_pkg_mgr&quot;</span><span class="p">:</span> <span class="s2">&quot;yum&quot;</span><span class="p">,</span>
    <span class="nt">&quot;ansible_processor&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;0&quot;</span><span class="p">,</span>
        <span class="s2">&quot;GenuineIntel&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Intel(R) Xeon(R) CPU E5-2670 0 @ 2.60GHz&quot;</span><span class="p">,</span>
        <span class="s2">&quot;1&quot;</span><span class="p">,</span>
        <span class="s2">&quot;GenuineIntel&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Intel(R) Xeon(R) CPU E5-2670 0 @ 2.60GHz&quot;</span><span class="p">,</span>
        <span class="s2">&quot;2&quot;</span><span class="p">,</span>
        <span class="s2">&quot;GenuineIntel&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Intel(R) Xeon(R) CPU E5-2670 0 @ 2.60GHz&quot;</span><span class="p">,</span>
        <span class="s2">&quot;3&quot;</span><span class="p">,</span>
        <span class="s2">&quot;GenuineIntel&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Intel(R) Xeon(R) CPU E5-2670 0 @ 2.60GHz&quot;</span><span class="p">,</span>
        <span class="s2">&quot;4&quot;</span><span class="p">,</span>
        <span class="s2">&quot;GenuineIntel&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Intel(R) Xeon(R) CPU E5-2670 0 @ 2.60GHz&quot;</span><span class="p">,</span>
        <span class="s2">&quot;5&quot;</span><span class="p">,</span>
        <span class="s2">&quot;GenuineIntel&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Intel(R) Xeon(R) CPU E5-2670 0 @ 2.60GHz&quot;</span><span class="p">,</span>
        <span class="s2">&quot;6&quot;</span><span class="p">,</span>
        <span class="s2">&quot;GenuineIntel&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Intel(R) Xeon(R) CPU E5-2670 0 @ 2.60GHz&quot;</span><span class="p">,</span>
        <span class="s2">&quot;7&quot;</span><span class="p">,</span>
        <span class="s2">&quot;GenuineIntel&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Intel(R) Xeon(R) CPU E5-2670 0 @ 2.60GHz&quot;</span>
    <span class="p">],</span>
    <span class="nt">&quot;ansible_processor_cores&quot;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
    <span class="nt">&quot;ansible_processor_count&quot;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
    <span class="nt">&quot;ansible_processor_threads_per_core&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="nt">&quot;ansible_processor_vcpus&quot;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
    <span class="nt">&quot;ansible_product_name&quot;</span><span class="p">:</span> <span class="s2">&quot;HVM domU&quot;</span><span class="p">,</span>
    <span class="nt">&quot;ansible_product_serial&quot;</span><span class="p">:</span> <span class="s2">&quot;REDACTED&quot;</span><span class="p">,</span>
    <span class="nt">&quot;ansible_product_uuid&quot;</span><span class="p">:</span> <span class="s2">&quot;REDACTED&quot;</span><span class="p">,</span>
    <span class="nt">&quot;ansible_product_version&quot;</span><span class="p">:</span> <span class="s2">&quot;4.1.5&quot;</span><span class="p">,</span>
    <span class="nt">&quot;ansible_python&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;executable&quot;</span><span class="p">:</span> <span class="s2">&quot;/usr/bin/python2&quot;</span><span class="p">,</span>
        <span class="nt">&quot;has_sslcontext&quot;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
        <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;CPython&quot;</span><span class="p">,</span>
        <span class="nt">&quot;version&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="nt">&quot;major&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
            <span class="nt">&quot;micro&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
            <span class="nt">&quot;minor&quot;</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span>
            <span class="nt">&quot;releaselevel&quot;</span><span class="p">:</span> <span class="s2">&quot;final&quot;</span><span class="p">,</span>
            <span class="nt">&quot;serial&quot;</span><span class="p">:</span> <span class="mi">0</span>
        <span class="p">},</span>
        <span class="nt">&quot;version_info&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="mi">2</span><span class="p">,</span>
            <span class="mi">7</span><span class="p">,</span>
            <span class="mi">5</span><span class="p">,</span>
            <span class="s2">&quot;final&quot;</span><span class="p">,</span>
            <span class="mi">0</span>
        <span class="p">]</span>
    <span class="p">},</span>
    <span class="nt">&quot;ansible_python_version&quot;</span><span class="p">:</span> <span class="s2">&quot;2.7.5&quot;</span><span class="p">,</span>
    <span class="nt">&quot;ansible_real_group_id&quot;</span><span class="p">:</span> <span class="mi">1000</span><span class="p">,</span>
    <span class="nt">&quot;ansible_real_user_id&quot;</span><span class="p">:</span> <span class="mi">1000</span><span class="p">,</span>
    <span class="nt">&quot;ansible_selinux&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;config_mode&quot;</span><span class="p">:</span> <span class="s2">&quot;enforcing&quot;</span><span class="p">,</span>
        <span class="nt">&quot;mode&quot;</span><span class="p">:</span> <span class="s2">&quot;enforcing&quot;</span><span class="p">,</span>
        <span class="nt">&quot;policyvers&quot;</span><span class="p">:</span> <span class="mi">31</span><span class="p">,</span>
        <span class="nt">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;enabled&quot;</span><span class="p">,</span>
        <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;targeted&quot;</span>
    <span class="p">},</span>
    <span class="nt">&quot;ansible_selinux_python_present&quot;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="nt">&quot;ansible_service_mgr&quot;</span><span class="p">:</span> <span class="s2">&quot;systemd&quot;</span><span class="p">,</span>
    <span class="nt">&quot;ansible_ssh_host_key_ecdsa_public&quot;</span><span class="p">:</span> <span class="s2">&quot;REDACTED KEY VALUE&quot;</span><span class="p">,</span>
    <span class="nt">&quot;ansible_ssh_host_key_ed25519_public&quot;</span><span class="p">:</span> <span class="s2">&quot;REDACTED KEY VALUE&quot;</span><span class="p">,</span>
    <span class="nt">&quot;ansible_ssh_host_key_rsa_public&quot;</span><span class="p">:</span> <span class="s2">&quot;REDACTED KEY VALUE&quot;</span><span class="p">,</span>
    <span class="nt">&quot;ansible_swapfree_mb&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="nt">&quot;ansible_swaptotal_mb&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="nt">&quot;ansible_system&quot;</span><span class="p">:</span> <span class="s2">&quot;Linux&quot;</span><span class="p">,</span>
    <span class="nt">&quot;ansible_system_capabilities&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;&quot;</span>
    <span class="p">],</span>
    <span class="nt">&quot;ansible_system_capabilities_enforced&quot;</span><span class="p">:</span> <span class="s2">&quot;True&quot;</span><span class="p">,</span>
    <span class="nt">&quot;ansible_system_vendor&quot;</span><span class="p">:</span> <span class="s2">&quot;Xen&quot;</span><span class="p">,</span>
    <span class="nt">&quot;ansible_uptime_seconds&quot;</span><span class="p">:</span> <span class="mi">151</span><span class="p">,</span>
    <span class="nt">&quot;ansible_user_dir&quot;</span><span class="p">:</span> <span class="s2">&quot;/home/zuul&quot;</span><span class="p">,</span>
    <span class="nt">&quot;ansible_user_gecos&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="nt">&quot;ansible_user_gid&quot;</span><span class="p">:</span> <span class="mi">1000</span><span class="p">,</span>
    <span class="nt">&quot;ansible_user_id&quot;</span><span class="p">:</span> <span class="s2">&quot;zuul&quot;</span><span class="p">,</span>
    <span class="nt">&quot;ansible_user_shell&quot;</span><span class="p">:</span> <span class="s2">&quot;/bin/bash&quot;</span><span class="p">,</span>
    <span class="nt">&quot;ansible_user_uid&quot;</span><span class="p">:</span> <span class="mi">1000</span><span class="p">,</span>
    <span class="nt">&quot;ansible_userspace_architecture&quot;</span><span class="p">:</span> <span class="s2">&quot;x86_64&quot;</span><span class="p">,</span>
    <span class="nt">&quot;ansible_userspace_bits&quot;</span><span class="p">:</span> <span class="s2">&quot;64&quot;</span><span class="p">,</span>
    <span class="nt">&quot;ansible_virtualization_role&quot;</span><span class="p">:</span> <span class="s2">&quot;guest&quot;</span><span class="p">,</span>
    <span class="nt">&quot;ansible_virtualization_type&quot;</span><span class="p">:</span> <span class="s2">&quot;xen&quot;</span><span class="p">,</span>
    <span class="nt">&quot;gather_subset&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;all&quot;</span>
    <span class="p">],</span>
    <span class="nt">&quot;module_setup&quot;</span><span class="p">:</span> <span class="kc">true</span>
<span class="p">}</span>
</pre></div>
</div>
<p>In the above the model of the first disk may be referenced in a template or playbook as:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="cp">{{</span> <span class="nv">ansible_facts</span><span class="o">[</span><span class="s1">&#39;devices&#39;</span><span class="o">][</span><span class="s1">&#39;xvda&#39;</span><span class="o">][</span><span class="s1">&#39;model&#39;</span><span class="o">]</span> <span class="cp">}}</span>
</pre></div>
</div>
<p>Similarly, the hostname as the system reports it is:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="cp">{{</span> <span class="nv">ansible_facts</span><span class="o">[</span><span class="s1">&#39;nodename&#39;</span><span class="o">]</span> <span class="cp">}}</span>
</pre></div>
</div>
<p>Facts are frequently used in conditionals (see <a class="reference internal" href="playbooks_conditionals.html#playbooks-conditionals"><span class="std std-ref">Conditionals</span></a>) and also in templates.</p>
<p>Facts can be also used to create dynamic groups of hosts that match particular criteria, see the <a class="reference external" href="https://docs.python.org/3/library/modules.html#modules" title="(in Python v3.8)"><span>Importing Modules</span></a> documentation on <strong>group_by</strong> for details, as well as in generalized conditional statements as discussed in the <a class="reference internal" href="playbooks_conditionals.html#playbooks-conditionals"><span class="std std-ref">Conditionals</span></a> chapter.</p>
<div class="section" id="disabling-facts">
<span id="id1"></span><h3><a class="toc-backref" href="#id27">Disabling facts</a><a class="headerlink" href="#disabling-facts" title="Permalink to this headline">¶</a></h3>
<p>If you know you don’t need any fact data about your hosts, and know everything about your systems centrally, you
can turn off fact gathering.  This has advantages in scaling Ansible in push mode with very large numbers of
systems, mainly, or if you are using Ansible on experimental platforms.   In any play, just do this:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">hosts</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">whatever</span>
  <span class="l l-Scalar l-Scalar-Plain">gather_facts</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">no</span>
</pre></div>
</div>
</div>
<div class="section" id="local-facts-facts-d">
<span id="local-facts"></span><h3><a class="toc-backref" href="#id28">Local facts (facts.d)</a><a class="headerlink" href="#local-facts-facts-d" title="Permalink to this headline">¶</a></h3>
<div class="versionadded">
<p><span class="versionmodified">New in version 1.3.</span></p>
</div>
<p>As discussed in the playbooks chapter, Ansible facts are a way of getting data about remote systems for use in playbook variables.</p>
<p>Usually these are discovered automatically by the <code class="docutils literal notranslate"><span class="pre">setup</span></code> module in Ansible. Users can also write custom facts modules, as described in the API guide. However, what if you want to have a simple way to provide system or user provided data for use in Ansible variables, without writing a fact module?</p>
<p>“Facts.d” is one mechanism for users to control some aspect of how their systems are managed.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Perhaps “local facts” is a bit of a misnomer, it means “locally supplied user values” as opposed to “centrally supplied user values”, or what facts are – “locally dynamically determined values”.</p>
</div>
<p>If a remotely managed system has an <code class="docutils literal notranslate"><span class="pre">/etc/ansible/facts.d</span></code> directory, any files in this directory
ending in <code class="docutils literal notranslate"><span class="pre">.fact</span></code>, can be JSON, INI, or executable files returning JSON, and these can supply local facts in Ansible.
An alternate directory can be specified using the <code class="docutils literal notranslate"><span class="pre">fact_path</span></code> play keyword.</p>
<p>For example, assume <code class="docutils literal notranslate"><span class="pre">/etc/ansible/facts.d/preferences.fact</span></code> contains:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">[</span><span class="nv">general</span><span class="p p-Indicator">]</span>
<span class="l l-Scalar l-Scalar-Plain">asdf=1</span>
<span class="l l-Scalar l-Scalar-Plain">bar=2</span>
</pre></div>
</div>
<p>This will produce a hash variable fact named <code class="docutils literal notranslate"><span class="pre">general</span></code> with <code class="docutils literal notranslate"><span class="pre">asdf</span></code> and <code class="docutils literal notranslate"><span class="pre">bar</span></code> as members.
To validate this, run the following:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">ansible &lt;hostname&gt; -m setup -a &quot;filter=ansible_local&quot;</span>
</pre></div>
</div>
<p>And you will see the following fact added:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="s">&quot;ansible_local&quot;</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">{</span>
        <span class="s">&quot;preferences&quot;</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">{</span>
            <span class="s">&quot;general&quot;</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">{</span>
                <span class="s">&quot;asdf&quot;</span> <span class="p p-Indicator">:</span> <span class="s">&quot;1&quot;</span><span class="p p-Indicator">,</span>
                <span class="s">&quot;bar&quot;</span>  <span class="p p-Indicator">:</span> <span class="s">&quot;2&quot;</span>
            <span class="p p-Indicator">}</span>
        <span class="p p-Indicator">}</span>
 <span class="p p-Indicator">}</span>
</pre></div>
</div>
<p>And this data can be accessed in a <code class="docutils literal notranslate"><span class="pre">template/playbook</span></code> as:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="cp">{{</span> <span class="nv">ansible_local</span><span class="o">[</span><span class="s1">&#39;preferences&#39;</span><span class="o">][</span><span class="s1">&#39;general&#39;</span><span class="o">][</span><span class="s1">&#39;asdf&#39;</span><span class="o">]</span> <span class="cp">}}</span>
</pre></div>
</div>
<p>The local namespace prevents any user supplied fact from overriding system facts or variables defined elsewhere in the playbook.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The key part in the key=value pairs will be converted into lowercase inside the ansible_local variable. Using the example above, if the ini file contained <code class="docutils literal notranslate"><span class="pre">XYZ=3</span></code> in the <code class="docutils literal notranslate"><span class="pre">[general]</span></code> section, then you should expect to access it as: <code class="docutils literal notranslate"><span class="pre">{{</span> <span class="pre">ansible_local['preferences']['general']['xyz']</span> <span class="pre">}}</span></code> and not <code class="docutils literal notranslate"><span class="pre">{{</span> <span class="pre">ansible_local['preferences']['general']['XYZ']</span> <span class="pre">}}</span></code>. This is because Ansible uses Python’s <a class="reference external" href="https://docs.python.org/2/library/configparser.html">ConfigParser</a> which passes all option names through the <a class="reference external" href="https://docs.python.org/2/library/configparser.html#ConfigParser.RawConfigParser.optionxform">optionxform</a> method and this method’s default implementation converts option names to lower case.</p>
</div>
<p>If you have a playbook that is copying over a custom fact and then running it, making an explicit call to re-run the setup module
can allow that fact to be used during that particular play.  Otherwise, it will be available in the next play that gathers fact information.
Here is an example of what that might look like:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">hosts</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">webservers</span>
  <span class="l l-Scalar l-Scalar-Plain">tasks</span><span class="p p-Indicator">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">create directory for ansible custom facts</span>
      <span class="l l-Scalar l-Scalar-Plain">file</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">state=directory recurse=yes path=/etc/ansible/facts.d</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">install custom ipmi fact</span>
      <span class="l l-Scalar l-Scalar-Plain">copy</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">src=ipmi.fact dest=/etc/ansible/facts.d</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">re-read facts after adding custom fact</span>
      <span class="l l-Scalar l-Scalar-Plain">setup</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">filter=ansible_local</span>
</pre></div>
</div>
<p>In this pattern however, you could also write a fact module as well, and may wish to consider this as an option.</p>
</div>
<div class="section" id="ansible-version">
<span id="id2"></span><h3><a class="toc-backref" href="#id29">Ansible version</a><a class="headerlink" href="#ansible-version" title="Permalink to this headline">¶</a></h3>
<div class="versionadded">
<p><span class="versionmodified">New in version 1.8.</span></p>
</div>
<p>To adapt playbook behavior to specific version of ansible, a variable ansible_version is available, with the following
structure:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="s">&quot;ansible_version&quot;</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">{</span>
    <span class="s">&quot;full&quot;</span><span class="p p-Indicator">:</span> <span class="s">&quot;2.0.0.2&quot;</span><span class="p p-Indicator">,</span>
    <span class="s">&quot;major&quot;</span><span class="p p-Indicator">:</span> <span class="nv">2</span><span class="p p-Indicator">,</span>
    <span class="s">&quot;minor&quot;</span><span class="p p-Indicator">:</span> <span class="nv">0</span><span class="p p-Indicator">,</span>
    <span class="s">&quot;revision&quot;</span><span class="p p-Indicator">:</span> <span class="nv">0</span><span class="p p-Indicator">,</span>
    <span class="s">&quot;string&quot;</span><span class="p p-Indicator">:</span> <span class="s">&quot;2.0.0.2&quot;</span>
<span class="p p-Indicator">}</span>
</pre></div>
</div>
</div>
<div class="section" id="caching-facts">
<span id="fact-caching"></span><h3><a class="toc-backref" href="#id30">Caching Facts</a><a class="headerlink" href="#caching-facts" title="Permalink to this headline">¶</a></h3>
<div class="versionadded">
<p><span class="versionmodified">New in version 1.8.</span></p>
</div>
<p>As shown elsewhere in the docs, it is possible for one server to reference variables about another, like so:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="cp">{{</span> <span class="nv">hostvars</span><span class="o">[</span><span class="s1">&#39;asdf.example.com&#39;</span><span class="o">][</span><span class="s1">&#39;ansible_facts&#39;</span><span class="o">][</span><span class="s1">&#39;os_family&#39;</span><span class="o">]</span> <span class="cp">}}</span>
</pre></div>
</div>
<p>With “Fact Caching” disabled, in order to do this, Ansible must have already talked to ‘asdf.example.com’ in the
current play, or another play up higher in the playbook.  This is the default configuration of ansible.</p>
<p>To avoid this, Ansible 1.8 allows the ability to save facts between playbook runs, but this feature must be manually
enabled.  Why might this be useful?</p>
<p>With a very large infrastructure with thousands of hosts, fact caching could be configured to run nightly. Configuration of a small set of servers could run ad-hoc or periodically throughout the day. With fact caching enabled, it would
not be necessary to “hit” all servers to reference variables and information about them.</p>
<p>With fact caching enabled, it is possible for machine in one group to reference variables about machines in the other group, despite the fact that they have not been communicated with in the current execution of /usr/bin/ansible-playbook.</p>
<p>To benefit from cached facts, you will want to change the <code class="docutils literal notranslate"><span class="pre">gathering</span></code> setting to <code class="docutils literal notranslate"><span class="pre">smart</span></code> or <code class="docutils literal notranslate"><span class="pre">explicit</span></code> or set <code class="docutils literal notranslate"><span class="pre">gather_facts</span></code> to <code class="docutils literal notranslate"><span class="pre">False</span></code> in most plays.</p>
<p>Currently, Ansible ships with two persistent cache plugins: redis and jsonfile.</p>
<p>To configure fact caching using redis, enable it in <code class="docutils literal notranslate"><span class="pre">ansible.cfg</span></code> as follows:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">[</span><span class="nv">defaults</span><span class="p p-Indicator">]</span>
<span class="l l-Scalar l-Scalar-Plain">gathering = smart</span>
<span class="l l-Scalar l-Scalar-Plain">fact_caching = redis</span>
<span class="l l-Scalar l-Scalar-Plain">fact_caching_timeout = 86400</span>
<span class="l l-Scalar l-Scalar-Plain"># seconds</span>
</pre></div>
</div>
<p>To get redis up and running, perform the equivalent OS commands:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">yum install redis</span>
<span class="l l-Scalar l-Scalar-Plain">service redis start</span>
<span class="l l-Scalar l-Scalar-Plain">pip install redis</span>
</pre></div>
</div>
<p>Note that the Python redis library should be installed from pip, the version packaged in EPEL is too old for use by Ansible.</p>
<p>In current embodiments, this feature is in beta-level state and the Redis plugin does not support port or password configuration, this is expected to change in the near future.</p>
<p>To configure fact caching using jsonfile, enable it in <code class="docutils literal notranslate"><span class="pre">ansible.cfg</span></code> as follows:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">[</span><span class="nv">defaults</span><span class="p p-Indicator">]</span>
<span class="l l-Scalar l-Scalar-Plain">gathering = smart</span>
<span class="l l-Scalar l-Scalar-Plain">fact_caching = jsonfile</span>
<span class="l l-Scalar l-Scalar-Plain">fact_caching_connection = /path/to/cachedir</span>
<span class="l l-Scalar l-Scalar-Plain">fact_caching_timeout = 86400</span>
<span class="l l-Scalar l-Scalar-Plain"># seconds</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">fact_caching_connection</span></code> is a local filesystem path to a writeable
directory (ansible will attempt to create the directory if one does not exist).</p>
<p><code class="docutils literal notranslate"><span class="pre">fact_caching_timeout</span></code> is the number of seconds to cache the recorded facts.</p>
</div>
</div>
<div class="section" id="registering-variables">
<span id="registered-variables"></span><h2><a class="toc-backref" href="#id31">Registering variables</a><a class="headerlink" href="#registering-variables" title="Permalink to this headline">¶</a></h2>
<p>Another major use of variables is running a command and registering the result of that command as a variable. When you execute a task and save the return value in a variable for use in later tasks, you create a registered variable. There are more examples of this in the
<a class="reference internal" href="playbooks_conditionals.html#playbooks-conditionals"><span class="std std-ref">Conditionals</span></a> chapter.</p>
<p>For example:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">hosts</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">web_servers</span>

  <span class="l l-Scalar l-Scalar-Plain">tasks</span><span class="p p-Indicator">:</span>

     <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">shell</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">/usr/bin/foo</span>
       <span class="l l-Scalar l-Scalar-Plain">register</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">foo_result</span>
       <span class="l l-Scalar l-Scalar-Plain">ignore_errors</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">True</span>

     <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">shell</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">/usr/bin/bar</span>
       <span class="l l-Scalar l-Scalar-Plain">when</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">foo_result.rc == 5</span>
</pre></div>
</div>
<p>Results will vary from module to module. Each module’s documentation includes a <code class="docutils literal notranslate"><span class="pre">RETURN</span></code> section describing that module’s return values. To see the values for a particular task, run your playbook with <code class="docutils literal notranslate"><span class="pre">-v</span></code>.</p>
<p>Registered variables are similar to facts, with a few key differences. Like facts, registered variables are host-level variables. However, registered variables are only stored in memory. (Ansible facts are backed by whatever cache plugin you have configured.) Registered variables are only valid on the host for the rest of the current playbook run. Finally, registered variables and facts have different <a class="reference internal" href="#ansible-variable-precedence"><span class="std std-ref">precedence levels</span></a>.</p>
<p>When you register a variable in a task with a loop, the registered variable contains a value for each item in the loop. The data structure placed in the variable during the loop will contain a <code class="docutils literal notranslate"><span class="pre">results</span></code> attribute, that is a list of all responses from the module. For a more in-depth example of how this works, see the <a class="reference internal" href="playbooks_loops.html#playbooks-loops"><span class="std std-ref">Loops</span></a> section on using register with a loop.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If a task fails or is skipped, the variable still is registered with a failure or skipped status, the only way to avoid registering a variable is using tags.</p>
</div>
</div>
<div class="section" id="accessing-complex-variable-data">
<span id="id3"></span><h2><a class="toc-backref" href="#id32">Accessing complex variable data</a><a class="headerlink" href="#accessing-complex-variable-data" title="Permalink to this headline">¶</a></h2>
<p>We already described facts a little higher up in the documentation.</p>
<p>Some provided facts, like networking information, are made available as nested data structures.  To access
them a simple <code class="docutils literal notranslate"><span class="pre">{{</span> <span class="pre">foo</span> <span class="pre">}}</span></code> is not sufficient, but it is still easy to do.   Here’s how we get an IP address:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="cp">{{</span> <span class="nv">ansible_facts</span><span class="o">[</span><span class="s2">&quot;eth0&quot;</span><span class="o">][</span><span class="s2">&quot;ipv4&quot;</span><span class="o">][</span><span class="s2">&quot;address&quot;</span><span class="o">]</span> <span class="cp">}}</span>
</pre></div>
</div>
<p>OR alternatively:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="cp">{{</span> <span class="nv">ansible_facts.eth0.ipv4.address</span> <span class="cp">}}</span>
</pre></div>
</div>
<p>Similarly, this is how we access the first element of an array:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="cp">{{</span> <span class="nv">foo</span><span class="o">[</span><span class="m">0</span><span class="o">]</span> <span class="cp">}}</span>
</pre></div>
</div>
</div>
<div class="section" id="accessing-information-about-other-hosts-with-magic-variables">
<span id="magic-variables-and-hostvars"></span><h2><a class="toc-backref" href="#id33">Accessing information about other hosts with magic variables</a><a class="headerlink" href="#accessing-information-about-other-hosts-with-magic-variables" title="Permalink to this headline">¶</a></h2>
<p>Whether or not you define any variables, you can access information about your hosts with the <a class="reference internal" href="../reference_appendices/special_variables.html#special-variables"><span class="std std-ref">Special Variables</span></a> Ansible provides, including “magic” variables, facts, and connection variables. Magic variable names are reserved - do not set variables with these names. The variable <code class="docutils literal notranslate"><span class="pre">environment</span></code> is also reserved.</p>
<p>The most commonly used magic variables are <code class="docutils literal notranslate"><span class="pre">hostvars</span></code>, <code class="docutils literal notranslate"><span class="pre">groups</span></code>, <code class="docutils literal notranslate"><span class="pre">group_names</span></code>, and <code class="docutils literal notranslate"><span class="pre">inventory_hostname</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">hostvars</span></code> lets you access variables for another host, including facts that have been gathered about that host. You can access host variables at any point in a playbook. Even if you haven’t connected to that host yet in any play in the playbook or set of playbooks, you can still get the variables, but you will not be able to see the facts.</p>
<p>If your database server wants to use the value of a ‘fact’ from another node, or an inventory variable
assigned to another node, it’s easy to do so within a template or even an action line:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="cp">{{</span> <span class="nv">hostvars</span><span class="o">[</span><span class="s1">&#39;test.example.com&#39;</span><span class="o">][</span><span class="s1">&#39;ansible_facts&#39;</span><span class="o">][</span><span class="s1">&#39;distribution&#39;</span><span class="o">]</span> <span class="cp">}}</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">groups</span></code> is a list of all the groups (and hosts) in the inventory.  This can be used to enumerate all hosts within a group. For example:</p>
<div class="highlight-jinja notranslate"><div class="highlight"><pre><span></span><span class="cp">{%</span> <span class="k">for</span> <span class="nv">host</span> <span class="k">in</span> <span class="nv">groups</span><span class="o">[</span><span class="s1">&#39;app_servers&#39;</span><span class="o">]</span> <span class="cp">%}</span><span class="x"></span>
<span class="x">   # something that applies to all app servers.</span>
<span class="cp">{%</span> <span class="k">endfor</span> <span class="cp">%}</span><span class="x"></span>
</pre></div>
</div>
<p>A frequently used idiom is walking a group to find all IP addresses in that group.</p>
<div class="highlight-jinja notranslate"><div class="highlight"><pre><span></span><span class="cp">{%</span> <span class="k">for</span> <span class="nv">host</span> <span class="k">in</span> <span class="nv">groups</span><span class="o">[</span><span class="s1">&#39;app_servers&#39;</span><span class="o">]</span> <span class="cp">%}</span><span class="x"></span>
<span class="x">   </span><span class="cp">{{</span> <span class="nv">hostvars</span><span class="o">[</span><span class="nv">host</span><span class="o">][</span><span class="s1">&#39;ansible_facts&#39;</span><span class="o">][</span><span class="s1">&#39;eth0&#39;</span><span class="o">][</span><span class="s1">&#39;ipv4&#39;</span><span class="o">][</span><span class="s1">&#39;address&#39;</span><span class="o">]</span> <span class="cp">}}</span><span class="x"></span>
<span class="cp">{%</span> <span class="k">endfor</span> <span class="cp">%}</span><span class="x"></span>
</pre></div>
</div>
<p>You can use this idiom to point a frontend proxy server to all of the app servers, to set up the correct firewall rules between servers, etc.
You need to make sure that the facts of those hosts have been populated before though, for example by running a play against them if the facts have not been cached recently (fact caching was added in Ansible 1.8).</p>
<p><code class="docutils literal notranslate"><span class="pre">group_names</span></code> is a list (array) of all the groups the current host is in.  This can be used in templates using Jinja2 syntax to make template source files that vary based on the group membership (or role) of the host:</p>
<div class="highlight-jinja notranslate"><div class="highlight"><pre><span></span><span class="cp">{%</span> <span class="k">if</span> <span class="s1">&#39;webserver&#39;</span> <span class="k">in</span> <span class="nv">group_names</span> <span class="cp">%}</span><span class="x"></span>
<span class="x">   # some part of a configuration file that only applies to webservers</span>
<span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span><span class="x"></span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">inventory_hostname</span></code> is the name of the hostname as configured in Ansible’s inventory host file.  This can
be useful when you’ve disabled fact-gathering, or you don’t want to rely on the discovered hostname <code class="docutils literal notranslate"><span class="pre">ansible_hostname</span></code>.  If you have a long FQDN, you can use <code class="docutils literal notranslate"><span class="pre">inventory_hostname_short</span></code>, which contains the part up to the first
period, without the rest of the domain.</p>
<p>Other useful magic variables refer to the current play or playbook, including:</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 2.2.</span></p>
</div>
<p><code class="docutils literal notranslate"><span class="pre">ansible_play_hosts</span></code> is the full list of all hosts still active in the current play.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 2.2.</span></p>
</div>
<p><code class="docutils literal notranslate"><span class="pre">ansible_play_batch</span></code> is available as a list of hostnames that are in scope for the current ‘batch’ of the play. The batch size is defined by <code class="docutils literal notranslate"><span class="pre">serial</span></code>, when not set it is equivalent to the whole play (making it the same as <code class="docutils literal notranslate"><span class="pre">ansible_play_hosts</span></code>).</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 2.3.</span></p>
</div>
<p><code class="docutils literal notranslate"><span class="pre">ansible_playbook_python</span></code> is the path to the python executable used to invoke the Ansible command line tool.</p>
<p>These vars may be useful for filling out templates with multiple hostnames or for injecting the list into the rules for a load balancer.</p>
<p>Also available, <code class="docutils literal notranslate"><span class="pre">inventory_dir</span></code> is the pathname of the directory holding Ansible’s inventory host file, <code class="docutils literal notranslate"><span class="pre">inventory_file</span></code> is the pathname and the filename pointing to the Ansible’s inventory host file.</p>
<p><code class="docutils literal notranslate"><span class="pre">playbook_dir</span></code> contains the playbook base directory.</p>
<p>We then have <code class="docutils literal notranslate"><span class="pre">role_path</span></code> which will return the current role’s pathname (since 1.8). This will only work inside a role.</p>
<p>And finally, <code class="docutils literal notranslate"><span class="pre">ansible_check_mode</span></code> (added in version 2.1), a boolean magic variable which will be set to <code class="docutils literal notranslate"><span class="pre">True</span></code> if you run Ansible with <code class="docutils literal notranslate"><span class="pre">--check</span></code>.</p>
</div>
<div class="section" id="defining-variables-in-files">
<span id="variable-file-separation-details"></span><h2><a class="toc-backref" href="#id34">Defining variables in files</a><a class="headerlink" href="#defining-variables-in-files" title="Permalink to this headline">¶</a></h2>
<p>It’s a great idea to keep your playbooks under source control, but
you may wish to make the playbook source public while keeping certain
important variables private.  Similarly, sometimes you may just
want to keep certain information in different files, away from
the main playbook.</p>
<p>You can do this by using an external variables file, or files, just like this:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="nn">---</span>

<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">hosts</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">all</span>
  <span class="l l-Scalar l-Scalar-Plain">remote_user</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">root</span>
  <span class="l l-Scalar l-Scalar-Plain">vars</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">favcolor</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">blue</span>
  <span class="l l-Scalar l-Scalar-Plain">vars_files</span><span class="p p-Indicator">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">/vars/external_vars.yml</span>

  <span class="l l-Scalar l-Scalar-Plain">tasks</span><span class="p p-Indicator">:</span>

  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">this is just a placeholder</span>
    <span class="l l-Scalar l-Scalar-Plain">command</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">/bin/echo foo</span>
</pre></div>
</div>
<p>This removes the risk of sharing sensitive data with others when
sharing your playbook source with them.</p>
<p>The contents of each variables file is a simple YAML dictionary, like this:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="nn">---</span>
<span class="c1"># in the above example, this would be vars/external_vars.yml</span>
<span class="l l-Scalar l-Scalar-Plain">somevar</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">somevalue</span>
<span class="l l-Scalar l-Scalar-Plain">password</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">magic</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">It’s also possible to keep per-host and per-group variables in very
similar files, this is covered in <a class="reference internal" href="intro_inventory.html#splitting-out-vars"><span class="std std-ref">Organizing host and group variables</span></a>.</p>
</div>
</div>
<div class="section" id="passing-variables-on-the-command-line">
<span id="id4"></span><h2><a class="toc-backref" href="#id35">Passing variables on the command line</a><a class="headerlink" href="#passing-variables-on-the-command-line" title="Permalink to this headline">¶</a></h2>
<p>In addition to <code class="docutils literal notranslate"><span class="pre">vars_prompt</span></code> and <code class="docutils literal notranslate"><span class="pre">vars_files</span></code>, it is possible to set variables at the
command line using the <code class="docutils literal notranslate"><span class="pre">--extra-vars</span></code> (or <code class="docutils literal notranslate"><span class="pre">-e</span></code>) argument.  Variables can be defined using
a single quoted string (containing one or more variables) using one of the formats below</p>
<p>key=value format:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">ansible-playbook release.yml --extra-vars &quot;version=1.23.45 other_variable=foo&quot;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Values passed in using the <code class="docutils literal notranslate"><span class="pre">key=value</span></code> syntax are interpreted as strings.
Use the JSON format if you need to pass in anything that shouldn’t be a string (Booleans, integers, floats, lists etc).</p>
</div>
<p>JSON string format:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">ansible-playbook release.yml --extra-vars &#39;{&quot;version&quot;:&quot;1.23.45&quot;,&quot;other_variable&quot;:&quot;foo&quot;}&#39;</span>
<span class="l l-Scalar l-Scalar-Plain">ansible-playbook arcade.yml --extra-vars &#39;{&quot;pacman&quot;:&quot;mrs&quot;,&quot;ghosts&quot;:[&quot;inky&quot;,&quot;pinky&quot;,&quot;clyde&quot;,&quot;sue&quot;]}&#39;</span>
</pre></div>
</div>
<p>vars from a JSON or YAML file:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">ansible-playbook release.yml --extra-vars &quot;@some_file.json&quot;</span>
</pre></div>
</div>
<p>This is useful for, among other things, setting the hosts group or the user for the playbook.</p>
<p>Escaping quotes and other special characters:</p>
<p>Ensure you’re escaping quotes appropriately for both your markup (e.g. JSON), and for
the shell you’re operating in.:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">ansible-playbook arcade.yml --extra-vars &quot;{\&quot;name\&quot;:\&quot;Conan O\&#39;Brien\&quot;}&quot;</span>
<span class="l l-Scalar l-Scalar-Plain">ansible-playbook arcade.yml --extra-vars &#39;{&quot;name&quot;:&quot;Conan O&#39;\\\&#39;&#39;Brien&quot;}&#39;</span>
<span class="l l-Scalar l-Scalar-Plain">ansible-playbook script.yml --extra-vars &quot;{\&quot;dialog\&quot;:\&quot;He said \\\&quot;I just can\&#39;t get enough of those single and double-quotes&quot;\!&quot;\\\&quot;\&quot;}&quot;</span>
</pre></div>
</div>
<p>In these cases, it’s probably best to use a JSON or YAML file containing the variable
definitions.</p>
</div>
<div class="section" id="variable-precedence-where-should-i-put-a-variable">
<span id="ansible-variable-precedence"></span><h2><a class="toc-backref" href="#id36">Variable precedence: Where should I put a variable?</a><a class="headerlink" href="#variable-precedence-where-should-i-put-a-variable" title="Permalink to this headline">¶</a></h2>
<p>A lot of folks may ask about how variables override another.  Ultimately it’s Ansible’s philosophy that it’s better
you know where to put a variable, and then you have to think about it a lot less.</p>
<p>Avoid defining the variable “x” in 47 places and then ask the question “which x gets used”.
Why?  Because that’s not Ansible’s Zen philosophy of doing things.</p>
<p>There is only one Empire State Building. One Mona Lisa, etc.  Figure out where to define a variable, and don’t make
it complicated.</p>
<p>However, let’s go ahead and get precedence out of the way!  It exists.  It’s a real thing, and you might have
a use for it.</p>
<p>If multiple variables of the same name are defined in different places, they get overwritten in a certain order.</p>
<p>Here is the order of precedence from least to greatest (the last listed variables winning prioritization):</p>
<blockquote>
<div><ol class="arabic simple">
<li>command line values (eg “-u user”)</li>
<li>role defaults (defined in role/defaults/main.yml) <a class="footnote-reference" href="#id15" id="id5">[1]</a></li>
<li>inventory file or script group vars <a class="footnote-reference" href="#id16" id="id6">[2]</a></li>
<li>inventory group_vars/all <a class="footnote-reference" href="#id17" id="id7">[3]</a></li>
<li>playbook group_vars/all <a class="footnote-reference" href="#id17" id="id8">[3]</a></li>
<li>inventory group_vars/* <a class="footnote-reference" href="#id17" id="id9">[3]</a></li>
<li>playbook group_vars/* <a class="footnote-reference" href="#id17" id="id10">[3]</a></li>
<li>inventory file or script host vars <a class="footnote-reference" href="#id16" id="id11">[2]</a></li>
<li>inventory host_vars/* <a class="footnote-reference" href="#id17" id="id12">[3]</a></li>
<li>playbook host_vars/* <a class="footnote-reference" href="#id17" id="id13">[3]</a></li>
<li>host facts / cached set_facts <a class="footnote-reference" href="#id18" id="id14">[4]</a></li>
<li>play vars</li>
<li>play vars_prompt</li>
<li>play vars_files</li>
<li>role vars (defined in role/vars/main.yml)</li>
<li>block vars (only for tasks in block)</li>
<li>task vars (only for the task)</li>
<li>include_vars</li>
<li>set_facts / registered vars</li>
<li>role (and include_role) params</li>
<li>include params</li>
<li>extra vars (always win precedence)</li>
</ol>
</div></blockquote>
<p>Basically, anything that goes into “role defaults” (the defaults folder inside the role) is the most malleable and easily overridden. Anything in the vars directory of the role overrides previous versions of that variable in namespace.  The idea here to follow is that the more explicit you get in scope, the more precedence it takes with command line <code class="docutils literal notranslate"><span class="pre">-e</span></code> extra vars always winning.  Host and/or inventory variables can win over role defaults, but not explicit includes like the vars directory or an <code class="docutils literal notranslate"><span class="pre">include_vars</span></code> task.</p>
<p class="rubric">Footnotes</p>
<table class="docutils footnote" frame="void" id="id15" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id5">[1]</a></td><td>Tasks in each role will see their own role’s defaults. Tasks defined outside of a role will see the last role’s defaults.</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id16" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[2]</td><td><em>(<a class="fn-backref" href="#id6">1</a>, <a class="fn-backref" href="#id11">2</a>)</em> Variables defined in inventory file or provided by dynamic inventory.</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id17" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[3]</td><td><em>(<a class="fn-backref" href="#id7">1</a>, <a class="fn-backref" href="#id8">2</a>, <a class="fn-backref" href="#id9">3</a>, <a class="fn-backref" href="#id10">4</a>, <a class="fn-backref" href="#id12">5</a>, <a class="fn-backref" href="#id13">6</a>)</em> Includes vars added by ‘vars plugins’ as well as host_vars and group_vars which are added by the default vars plugin shipped with Ansible.</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id18" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id14">[4]</a></td><td>When created with set_facts’s cacheable option, variables will have the high precedence in the play,
but will be the same as a host facts precedence when they come from the cache.</td></tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Within any section, redefining a var will overwrite the previous instance.
If multiple groups have the same variable, the last one loaded wins.
If you define a variable twice in a play’s <code class="docutils literal notranslate"><span class="pre">vars:</span></code> section, the second one wins.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The previous describes the default config <code class="docutils literal notranslate"><span class="pre">hash_behaviour=replace</span></code>, switch to <code class="docutils literal notranslate"><span class="pre">merge</span></code> to only partially overwrite.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Group loading follows parent/child relationships. Groups of the same ‘parent/child’ level are then merged following alphabetical order.
This last one can be superseded by the user via <code class="docutils literal notranslate"><span class="pre">ansible_group_priority</span></code>, which defaults to <code class="docutils literal notranslate"><span class="pre">1</span></code> for all groups.
This variable, <code class="docutils literal notranslate"><span class="pre">ansible_group_priority</span></code>, can only be set in the inventory source and not in group_vars/ as the variable is used in the loading of group_vars/.</p>
</div>
<p>Another important thing to consider (for all versions) is that connection variables override config, command line and play/role/task specific options and keywords. See <a class="reference internal" href="../reference_appendices/general_precedence.html#general-precedence-rules"><span class="std std-ref">Controlling how Ansible behaves: precedence rules</span></a> for more details. For example, if your inventory specifies <code class="docutils literal notranslate"><span class="pre">ansible_user:</span> <span class="pre">ramon</span></code> and you run:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">ansible -u lola myhost</span>
</pre></div>
</div>
<p>This will still connect as <code class="docutils literal notranslate"><span class="pre">ramon</span></code> because the value from the variable takes priority (in this case, the variable came from the inventory, but the same would be true no matter where the variable was defined).</p>
<p>For plays/tasks this is also true for <code class="docutils literal notranslate"><span class="pre">remote_user</span></code>. Assuming the same inventory config, the following play:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">hosts</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">myhost</span>
  <span class="l l-Scalar l-Scalar-Plain">tasks</span><span class="p p-Indicator">:</span>
   <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">command</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">I&#39;ll connect as ramon still</span>
     <span class="l l-Scalar l-Scalar-Plain">remote_user</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">lola</span>
</pre></div>
</div>
<p>will have the value of <code class="docutils literal notranslate"><span class="pre">remote_user</span></code> overwritten by <code class="docutils literal notranslate"><span class="pre">ansible_user</span></code> in the inventory.</p>
<p>This is done so host-specific settings can override the general settings. These variables are normally defined per host or group in inventory,
but they behave like other variables.</p>
<p>If you want to override the remote user globally (even over inventory) you can use extra vars. For instance, if you run:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">ansible... -e &quot;ansible_user=maria&quot; -u lola</span>
</pre></div>
</div>
<p>the <code class="docutils literal notranslate"><span class="pre">lola</span></code> value is still ignored, but <code class="docutils literal notranslate"><span class="pre">ansible_user=maria</span></code> takes precedence over all other places where <code class="docutils literal notranslate"><span class="pre">ansible_user</span></code> (or <code class="docutils literal notranslate"><span class="pre">remote_user</span></code>) might be set.</p>
<p>A connection-specific version of a variable takes precedence over more generic
versions.  For example, <code class="docutils literal notranslate"><span class="pre">ansible_ssh_user</span></code> specified as a group_var would have
a higher precedence than <code class="docutils literal notranslate"><span class="pre">ansible_user</span></code> specified as a host_var.</p>
<p>You can also override as a normal variable in a play:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">hosts</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">all</span>
  <span class="l l-Scalar l-Scalar-Plain">vars</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">ansible_user</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">lola</span>
  <span class="l l-Scalar l-Scalar-Plain">tasks</span><span class="p p-Indicator">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">command</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">I&#39;ll connect as lola!</span>
</pre></div>
</div>
<div class="section" id="scoping-variables">
<span id="variable-scopes"></span><h3><a class="toc-backref" href="#id37">Scoping variables</a><a class="headerlink" href="#scoping-variables" title="Permalink to this headline">¶</a></h3>
<p>You can decide where to set a variable based on the scope you want that value to have. Ansible has three main scopes:</p>
<blockquote>
<div><ul class="simple">
<li>Global: this is set by config, environment variables and the command line</li>
<li>Play: each play and contained structures, vars entries (vars; vars_files; vars_prompt), role defaults and vars.</li>
<li>Host: variables directly associated to a host, like inventory, include_vars, facts or registered task outputs</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="examples-of-where-to-set-a-variable">
<span id="variable-examples"></span><h3><a class="toc-backref" href="#id38">Examples of where to set a variable</a><a class="headerlink" href="#examples-of-where-to-set-a-variable" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div>Let’s show some examples and where you would choose to put what based on the kind of control you might want over values.</div></blockquote>
<p>First off, group variables are powerful.</p>
<p>Site-wide defaults should be defined as a <code class="docutils literal notranslate"><span class="pre">group_vars/all</span></code> setting.  Group variables are generally placed alongside
your inventory file.  They can also be returned by a dynamic inventory script (see <a class="reference internal" href="intro_dynamic_inventory.html#intro-dynamic-inventory"><span class="std std-ref">Working with dynamic inventory</span></a>) or defined
in things like <a class="reference internal" href="../reference_appendices/tower.html#ansible-tower"><span class="std std-ref">Red Hat Ansible Tower</span></a> from the UI or API:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="nn">---</span>
<span class="c1"># file: /etc/ansible/group_vars/all</span>
<span class="c1"># this is the site wide default</span>
<span class="l l-Scalar l-Scalar-Plain">ntp_server</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">default-time.example.com</span>
</pre></div>
</div>
<p>Regional information might be defined in a <code class="docutils literal notranslate"><span class="pre">group_vars/region</span></code> variable.  If this group is a child of the <code class="docutils literal notranslate"><span class="pre">all</span></code> group (which it is, because all groups are), it will override the group that is higher up and more general:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="nn">---</span>
<span class="c1"># file: /etc/ansible/group_vars/boston</span>
<span class="l l-Scalar l-Scalar-Plain">ntp_server</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">boston-time.example.com</span>
</pre></div>
</div>
<p>If for some crazy reason we wanted to tell just a specific host to use a specific NTP server, it would then override the group variable!:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="nn">---</span>
<span class="c1"># file: /etc/ansible/host_vars/xyz.boston.example.com</span>
<span class="l l-Scalar l-Scalar-Plain">ntp_server</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">override.example.com</span>
</pre></div>
</div>
<p>So that covers inventory and what you would normally set there.  It’s a great place for things that deal with geography or behavior.  Since groups are frequently the entity that maps roles onto hosts, it is sometimes a shortcut to set variables on the group instead of defining them on a role.  You could go either way.</p>
<p>Remember:  Child groups override parent groups, and hosts always override their groups.</p>
<p>Next up: learning about role variable precedence.</p>
<p>We’ll pretty much assume you are using roles at this point.  You should be using roles for sure.  Roles are great.  You are using
roles aren’t you?  Hint hint.</p>
<p>If you are writing a redistributable role with reasonable defaults, put those in the <code class="docutils literal notranslate"><span class="pre">roles/x/defaults/main.yml</span></code> file.  This means
the role will bring along a default value but ANYTHING in Ansible will override it.
See <a class="reference internal" href="playbooks_reuse_roles.html#playbooks-reuse-roles"><span class="std std-ref">Roles</span></a> for more info about this:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="nn">---</span>
<span class="c1"># file: roles/x/defaults/main.yml</span>
<span class="c1"># if not overridden in inventory or as a parameter, this is the value that will be used</span>
<span class="l l-Scalar l-Scalar-Plain">http_port</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">80</span>
</pre></div>
</div>
<p>If you are writing a role and want to ensure the value in the role is absolutely used in that role, and is not going to be overridden
by inventory, you should put it in <code class="docutils literal notranslate"><span class="pre">roles/x/vars/main.yml</span></code> like so, and inventory values cannot override it.  <code class="docutils literal notranslate"><span class="pre">-e</span></code> however, still will:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="nn">---</span>
<span class="c1"># file: roles/x/vars/main.yml</span>
<span class="c1"># this will absolutely be used in this role</span>
<span class="l l-Scalar l-Scalar-Plain">http_port</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">80</span>
</pre></div>
</div>
<p>This is one way to plug in constants about the role that are always true.  If you are not sharing your role with others,
app specific behaviors like ports is fine to put in here.  But if you are sharing roles with others, putting variables in here might
be bad. Nobody will be able to override them with inventory, but they still can by passing a parameter to the role.</p>
<p>Parameterized roles are useful.</p>
<p>If you are using a role and want to override a default, pass it as a parameter to the role like so:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">roles</span><span class="p p-Indicator">:</span>
   <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">role</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">apache</span>
     <span class="l l-Scalar l-Scalar-Plain">vars</span><span class="p p-Indicator">:</span>
        <span class="l l-Scalar l-Scalar-Plain">http_port</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">8080</span>
</pre></div>
</div>
<p>This makes it clear to the playbook reader that you’ve made a conscious choice to override some default in the role, or pass in some
configuration that the role can’t assume by itself.  It also allows you to pass something site-specific that isn’t really part of the
role you are sharing with others.</p>
<p>This can often be used for things that might apply to some hosts multiple times. For example:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">roles</span><span class="p p-Indicator">:</span>
   <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">role</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">app_user</span>
     <span class="l l-Scalar l-Scalar-Plain">vars</span><span class="p p-Indicator">:</span>
        <span class="l l-Scalar l-Scalar-Plain">myname</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">Ian</span>
   <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">role</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">app_user</span>
     <span class="l l-Scalar l-Scalar-Plain">vars</span><span class="p p-Indicator">:</span>
       <span class="l l-Scalar l-Scalar-Plain">myname</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">Terry</span>
   <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">role</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">app_user</span>
     <span class="l l-Scalar l-Scalar-Plain">vars</span><span class="p p-Indicator">:</span>
       <span class="l l-Scalar l-Scalar-Plain">myname</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">Graham</span>
   <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">role</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">app_user</span>
     <span class="l l-Scalar l-Scalar-Plain">vars</span><span class="p p-Indicator">:</span>
       <span class="l l-Scalar l-Scalar-Plain">myname</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">John</span>
</pre></div>
</div>
<p>In this example, the same role was invoked multiple times.  It’s quite likely there was
no default for <code class="docutils literal notranslate"><span class="pre">myname</span></code> supplied at all.  Ansible can warn you when variables aren’t defined – it’s the default behavior in fact.</p>
<p>There are a few other things that go on with roles.</p>
<p>Generally speaking, variables set in one role are available to others.  This means if you have a <code class="docutils literal notranslate"><span class="pre">roles/common/vars/main.yml</span></code> you
can set variables in there and make use of them in other roles and elsewhere in your playbook:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">roles</span><span class="p p-Indicator">:</span>
   <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">role</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">common_settings</span>
   <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">role</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">something</span>
     <span class="l l-Scalar l-Scalar-Plain">vars</span><span class="p p-Indicator">:</span>
       <span class="l l-Scalar l-Scalar-Plain">foo</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">12</span>
   <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">role</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">something_else</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">There are some protections in place to avoid the need to namespace variables.
In the above, variables defined in common_settings are most definitely available to ‘something’ and ‘something_else’ tasks, but if
“something’s” guaranteed to have foo set at 12, even if somewhere deep in common settings it set foo to 20.</p>
</div>
<p>So, that’s precedence, explained in a more direct way.  Don’t worry about precedence, just think about if your role is defining a
variable that is a default, or a “live” variable you definitely want to use.  Inventory lies in precedence right in the middle, and
if you want to forcibly override something, use <code class="docutils literal notranslate"><span class="pre">-e</span></code>.</p>
<p>If you found that a little hard to understand, take a look at the <a class="reference external" href="https://github.com/ansible/ansible-examples">ansible-examples</a> repo on GitHub for a bit more about how all of these things can work together.</p>
</div>
</div>
<div class="section" id="using-advanced-variable-syntax">
<h2><a class="toc-backref" href="#id39">Using advanced variable syntax</a><a class="headerlink" href="#using-advanced-variable-syntax" title="Permalink to this headline">¶</a></h2>
<p>For information about advanced YAML syntax used to declare variables and have more control over the data placed in YAML files used by Ansible, see <a class="reference internal" href="playbooks_advanced_syntax.html#playbooks-advanced-syntax"><span class="std std-ref">Advanced Syntax</span></a>.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="playbooks_intro.html#about-playbooks"><span class="std std-ref">Intro to Playbooks</span></a></dt>
<dd>An introduction to playbooks</dd>
<dt><a class="reference internal" href="playbooks_conditionals.html#playbooks-conditionals"><span class="std std-ref">Conditionals</span></a></dt>
<dd>Conditional statements in playbooks</dd>
<dt><a class="reference internal" href="playbooks_filters.html#playbooks-filters"><span class="std std-ref">Filters</span></a></dt>
<dd>Jinja2 filters and their uses</dd>
<dt><a class="reference internal" href="playbooks_loops.html#playbooks-loops"><span class="std std-ref">Loops</span></a></dt>
<dd>Looping in playbooks</dd>
<dt><a class="reference internal" href="playbooks_reuse_roles.html#playbooks-reuse-roles"><span class="std std-ref">Roles</span></a></dt>
<dd>Playbook organization by roles</dd>
<dt><a class="reference internal" href="playbooks_best_practices.html#playbooks-best-practices"><span class="std std-ref">Tips and tricks</span></a></dt>
<dd>Best practices in playbooks</dd>
<dt><a class="reference internal" href="../reference_appendices/special_variables.html#special-variables"><span class="std std-ref">Special Variables</span></a></dt>
<dd>List of special variables</dd>
<dt><a class="reference external" href="https://groups.google.com/group/ansible-devel">User Mailing List</a></dt>
<dd>Have a question?  Stop by the google group!</dd>
<dt><a class="reference external" href="http://irc.freenode.net">irc.freenode.net</a></dt>
<dd>#ansible IRC chat channel</dd>
</dl>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons">
      
        <a href="playbooks_templating.html" class="btn btn-neutral float-right" title="Templating (Jinja2)"/>Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="playbooks_reuse_roles.html" class="btn btn-neutral" title="Roles"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>


<script type="text/javascript">
  (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
  (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
  e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
  })(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');

  _st('install','yABGvz2N8PwcwBxyfzUc','2.0.0');
</script>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019 Red Hat, Inc.
      <span class="lastupdated">
        Last updated on Aug 10, 2020.
      </span>

    </p>
  </div> 
</footer>
        </div>
      </div>

    </section>

  </div>

  <script type="text/javascript">
      jQuery(function () {
          
          SphinxRtdTheme.Navigation.enableSticky();
          
      });
  </script>

  
  
    
   <!-- extra footer elements for Ansible beyond RTD Sphinx Theme --->
<!-- begin analytics -->
<script type="text/javascript">
var _hsq = _hsq || [];
_hsq.push(["setContentType", "standard-page"]);
      (function(d,s,i,r) {
      if (d.getElementById(i)){return;}
      var n = d.createElement(s),e = document.getElementsByTagName(s)[0];
      n.id=i;n.src = '//js.hs-analytics.net/analytics/'+(Math.ceil(new Date()/r)*r)+'/330046.js';
      e.parentNode.insertBefore(n, e);
      })(document, "script", "hs-analytics",300000);
</script>
<!-- end analytics -->
<script type="text/javascript">
if (("undefined" !== typeof _satellite) && ("function" === typeof _satellite.pageBottom)) {
  _satellite.pageBottom();
}
</script> 

</body>
</html>