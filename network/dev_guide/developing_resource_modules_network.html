

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Developing network resource modules &mdash; Ansible Documentation</title>
  

  
  
  
  
    <link rel="canonical" href="https://docs.ansible.com/ansible/latest/network/dev_guide/developing_resource_modules_network.html"/>
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>
  <link href='https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.0.3/css/font-awesome.min.css' rel='stylesheet' type='text/css'>

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/ansible.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/ansible.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Network connection plugins" href="developing_plugins_network.html" />
    <link rel="prev" title="Network Automation Developer Guide" href="index.html" /> <!---- extra head elements for Ansible beyond RTD Sphinx Theme --->
<script type="text/javascript" src="//www.redhat.com/dtm.js"></script>
<!-- <meta class="swiftype" name="published_at" data-type="date" content="2017-12-13" /> -->
<meta class="swiftype" name="version" data-type="string" content="devel">

<!-- Google Tag Manager Data Layer -->
<script>
 dataLayer = [];
</script>
<!-- End Google Tag Manager Data Layer -->

<script src="//cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script> 
</head>

<body class="wy-body-for-nav">
   <!---- extra body elements for Ansible beyond RTD Sphinx Theme --->
<!-- Google Tag Manager -->
<noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-PSB293" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-PSB293');</script>
<!-- End Google Tag Manager -->

  <div class="DocSite-globalNav ansibleNav">
      <ul>
          <li><a href="https://www.ansible.com/ansiblefest" target="_blank">AnsibleFest</a></li>
          <li><a href="https://www.ansible.com/tower" target="_blank">Products</a></li>
          <li><a href="https://www.ansible.com/community" target="_blank">Community</a></li>
          <li><a href="https://www.ansible.com/webinars-training" target="_blank">Webinars & Training</a></li>
          <li><a href="https://www.ansible.com/blog" target="_blank">Blog</a></li>
      </ul>
  </div>

<a class="DocSite-nav" href="/" style="padding-bottom: 30px;">

  <img class="DocSiteNav-logo"
    src="../../_static/images/logo_invert.png"
    alt="Ansible Logo">
  <div class="DocSiteNav-title">
    Documentation
  </div>
</a> 
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> Ansible
          

          
          </a>

          
            
            
              <div class="version">
                devel
              </div>
            
          

          <!--- Based on https://github.com/rtfd/sphinx_rtd_theme/pull/438/files -->

<div class="version">
  
    <div class="version-dropdown">
      <select class="version-list" id="version-list" onchange="javascript:location.href = this.value;">
        <script> x = document.getElementById("version-list"); </script>
        
          <script>
            current_url = window.location.href;
            option = document.createElement("option");
            option.text = "latest";
            if ( "latest" == "devel" ) {
              option.selected = true;
            }
            if (current_url.search("devel") > -1) {
              option.value = current_url.replace("devel","latest");
            } else {
              option.value = current_url.replace("latest","latest");
            }
            x.add(option);
          </script>
        
          <script>
            current_url = window.location.href;
            option = document.createElement("option");
            option.text = "2.8";
            if ( "2.8" == "devel" ) {
              option.selected = true;
            }
            if (current_url.search("devel") > -1) {
              option.value = current_url.replace("devel","2.8");
            } else {
              option.value = current_url.replace("latest","2.8");
            }
            x.add(option);
          </script>
        
          <script>
            current_url = window.location.href;
            option = document.createElement("option");
            option.text = "2.7";
            if ( "2.7" == "devel" ) {
              option.selected = true;
            }
            if (current_url.search("devel") > -1) {
              option.value = current_url.replace("devel","2.7");
            } else {
              option.value = current_url.replace("latest","2.7");
            }
            x.add(option);
          </script>
        
          <script>
            current_url = window.location.href;
            option = document.createElement("option");
            option.text = "devel";
            if ( "devel" == "devel" ) {
              option.selected = true;
            }
            if (current_url.search("devel") > -1) {
              option.value = current_url.replace("devel","devel");
            } else {
              option.value = current_url.replace("latest","devel");
            }
            x.add(option);
          </script>
        
      </select>
    </div>
  
</div>
          
<div role="search">
<!--  <form id="rtd-search-form" class="wy-form" action="../../search.html" -->
  <form id="rtd-search-form" class="wy-form"  method="get">
    <input type="text" class="st-default-search-input" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Installation, Upgrade &amp; Configuration</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../installation_guide/index.html">Installation Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../porting_guides/porting_guides.html">Ansible Porting Guides</a></li>
</ul>
<p class="caption"><span class="caption-text">Using Ansible</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../user_guide/index.html">User Guide</a></li>
</ul>
<p class="caption"><span class="caption-text">Contributing to Ansible</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../community/index.html">Ansible Community Guide</a></li>
</ul>
<p class="caption"><span class="caption-text">Extending Ansible</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../dev_guide/index.html">Developer Guide</a></li>
</ul>
<p class="caption"><span class="caption-text">Common Ansible Scenarios</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../scenario_guides/cloud_guides.html">Public Cloud Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../scenario_guides/network_guides.html">Network Technology Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../scenario_guides/virt_guides.html">Virtualization and Containerization Guides</a></li>
</ul>
<p class="caption"><span class="caption-text">Network Automation</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../getting_started/index.html">Network Automation Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_guide/index.html">Network Automation Advanced Topics</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Network Automation Developer Guide</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Developing network resource modules</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#accessing-the-resource-module-builder">Accessing the resource module builder</a></li>
<li class="toctree-l3"><a class="reference internal" href="#creating-a-model">Creating a model</a></li>
<li class="toctree-l3"><a class="reference internal" href="#using-the-resource-module-builder">Using the resource module builder</a></li>
<li class="toctree-l3"><a class="reference internal" href="#examples">Examples</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#collection-directory-layout">Collection directory layout</a></li>
<li class="toctree-l4"><a class="reference internal" href="#role-directory-layout">Role directory layout</a></li>
<li class="toctree-l4"><a class="reference internal" href="#using-the-collection">Using the collection</a></li>
<li class="toctree-l4"><a class="reference internal" href="#using-the-role">Using the role</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#resource-module-structure-and-workflow">Resource module structure and workflow</a></li>
<li class="toctree-l3"><a class="reference internal" href="#developer-notes">Developer notes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#unit-testing-ansible-network-resource-modules">Unit testing Ansible network resource modules</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#using-mock-objects-to-unit-test-ansible-network-resource-modules">Using mock objects to unit test Ansible network resource modules</a></li>
<li class="toctree-l4"><a class="reference internal" href="#mocking-device-data">Mocking device data</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="developing_plugins_network.html">Network connection plugins</a></li>
<li class="toctree-l2"><a class="reference internal" href="documenting_modules_network.html">Documenting new network platforms</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Ansible Galaxy</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../galaxy/user_guide.html">Galaxy User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../galaxy/dev_guide.html">Galaxy Developer Guide</a></li>
</ul>
<p class="caption"><span class="caption-text">Reference &amp; Appendices</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../modules/modules_by_category.html">Module Index</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference_appendices/playbooks_keywords.html">Playbook Keywords</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference_appendices/common_return_values.html">Return Values</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference_appendices/config.html">Ansible Configuration Settings</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference_appendices/general_precedence.html">Controlling how Ansible behaves: precedence rules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference_appendices/YAMLSyntax.html">YAML Syntax</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference_appendices/python_3_support.html">Python 3 Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference_appendices/interpreter_discovery.html">Interpreter Discovery</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference_appendices/release_and_maintenance.html">Release and maintenance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference_appendices/test_strategies.html">Testing Strategies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dev_guide/testing/sanity/index.html">Sanity Tests</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference_appendices/faq.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference_appendices/glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference_appendices/module_utils.html">Ansible Reference: Module Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference_appendices/special_variables.html">Special Variables</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference_appendices/tower.html">Red Hat Ansible Tower</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference_appendices/automationhub.html">Ansible Automation Hub</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference_appendices/logging.html">Logging Ansible output</a></li>
</ul>
<p class="caption"><span class="caption-text">Roadmaps</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../roadmap/index.html">Ansible Roadmap</a></li>
</ul>

            
          
        </div>
        
         <!-- extra nav elements for Ansible beyond RTD Sphinx Theme --->
<!-- changeable widget links to tower - do not change as image controlled by Ansible-->
<div id="sideBanner">
  <br/>
  <a href="https://www.ansible.com/docs-left?utm_source=docs">
    <img style="border-width:0px;" src="https://cdn2.hubspot.net/hubfs/330046/docs-graphics/ASB-docs-left-rail.png" />
  </a>
  <br/><br/><br/>
</div>
      </div>
    </nav>
  </div>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Ansible</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          
















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">Network Automation Developer Guide</a> &raquo;</li>
        
      <li>Developing network resource modules</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <!-- Ansible-specific additions for modules etc -->
                
                  <a href="https://github.com/ansible/ansible/edit/devel/docs/docsite/rst/network/dev_guide/developing_resource_modules_network.rst?description=%23%23%23%23%23%20SUMMARY%0A%3C!---%20Your%20description%20here%20--%3E%0A%0A%0A%23%23%23%23%23%20ISSUE%20TYPE%0A-%20Docs%20Pull%20Request%0A%0A%2Blabel:%20docsite_pr" class="fa fa-github"> Edit on GitHub</a>
                
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <!--- Based on sphinx versionwarning extension. Extension currently only works on READTHEDOCS -->
  <script>
    // Create a banner if we're not on the official docs site
    if (location.host == "docs.testing.ansible.com") {
      document.write('<div id="testing_banner_id" class="admonition important">');
      para = document.createElement('p');
      banner_text=document.createTextNode("This is a testing site. For the official docs go to https://docs.ansible.com/");
      para.appendChild(banner_text);
      element = document.getElementById('testing_banner_id');
      element.appendChild(para);
      document.write('</div>');
    }

    // Create a banner if we're not the latest version
    current_url = window.location.href;
    if ((current_url.search("latest") > -1) || (current_url.search("/2.9/") > -1)) {
     // no banner for latest release
    } else if (current_url.search("devel") > -1) {
      document.write('<div id="banner_id" class="admonition caution">');
      para = document.createElement('p');
      banner_text=document.createTextNode("You are reading the *devel* version of the Ansible documentation - this version is not guaranteed stable. Use the version selection to the left if you want the latest stable released version.");
      para.appendChild(banner_text);
      element = document.getElementById('banner_id');
      element.appendChild(para);
      document.write('</div>');
    } else {
      document.write('<div id="banner_id" class="admonition caution">');
      para = document.createElement('p');
      banner_text=document.createTextNode("You are reading an older version of the Ansible documentation. Use the version selection to the left if you want the latest stable released version.");
      para.appendChild(banner_text);
      element = document.getElementById('banner_id');
      element.appendChild(para);
      document.write('</div>');
    }
  </script>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="developing-network-resource-modules">
<span id="developing-resource-modules"></span><h1>Developing network resource modules<a class="headerlink" href="#developing-network-resource-modules" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><a class="reference internal" href="#accessing-the-resource-module-builder" id="id1">Accessing the resource module builder</a></li>
<li><a class="reference internal" href="#creating-a-model" id="id2">Creating a model</a></li>
<li><a class="reference internal" href="#using-the-resource-module-builder" id="id3">Using the resource module builder</a></li>
<li><a class="reference internal" href="#examples" id="id4">Examples</a><ul>
<li><a class="reference internal" href="#collection-directory-layout" id="id5">Collection directory layout</a></li>
<li><a class="reference internal" href="#role-directory-layout" id="id6">Role directory layout</a></li>
<li><a class="reference internal" href="#using-the-collection" id="id7">Using the collection</a></li>
<li><a class="reference internal" href="#using-the-role" id="id8">Using the role</a></li>
</ul>
</li>
<li><a class="reference internal" href="#resource-module-structure-and-workflow" id="id9">Resource module structure and workflow</a></li>
<li><a class="reference internal" href="#developer-notes" id="id10">Developer notes</a></li>
<li><a class="reference internal" href="#unit-testing-ansible-network-resource-modules" id="id11">Unit testing Ansible network resource modules</a><ul>
<li><a class="reference internal" href="#using-mock-objects-to-unit-test-ansible-network-resource-modules" id="id12">Using mock objects to unit test Ansible network resource modules</a></li>
<li><a class="reference internal" href="#mocking-device-data" id="id13">Mocking device data</a></li>
</ul>
</li>
</ul>
</div>
<p>The resource module builder is an Ansible Playbook that helps developers scaffold and maintain an Ansible network resource module.</p>
<p>The resource module builder has the following capabilities:</p>
<ul class="simple">
<li>Uses a defined model to scaffold a resource module directory layout and initial class files.</li>
<li>Scaffolds either an Ansible role or a collection.</li>
<li>Subsequent uses of the resource module builder will only replace the module arspec and file containing the module docstring.</li>
<li>Allows you to store complex examples along side the model in the same directory.</li>
<li>Maintains the model as the source of truth for the module and use resource module builder to update the source files as needed.</li>
<li>Generates working sample modules for both <code class="docutils literal notranslate"><span class="pre">&lt;network_os&gt;_&lt;resource&gt;</span></code> and <code class="docutils literal notranslate"><span class="pre">&lt;network_os&gt;_facts</span></code>.</li>
</ul>
<div class="section" id="accessing-the-resource-module-builder">
<h2><a class="toc-backref" href="#id1">Accessing the resource module builder</a><a class="headerlink" href="#accessing-the-resource-module-builder" title="Permalink to this headline">¶</a></h2>
<p>To access the resource module builder:</p>
<ol class="arabic simple">
<li>clone the github repository:</li>
</ol>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git clone https://github.com/ansible-network/resource_module_builder.git
</pre></div>
</div>
</div></blockquote>
<ol class="arabic simple" start="2">
<li>Install the requirements:</li>
</ol>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip install -r requirements.txt
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="creating-a-model">
<h2><a class="toc-backref" href="#id2">Creating a model</a><a class="headerlink" href="#creating-a-model" title="Permalink to this headline">¶</a></h2>
<p>You must create a model for your new resource. The resource module builder uses this model to create:</p>
<ul class="simple">
<li>The scaffold for a new module</li>
<li>The argspec for the new module</li>
<li>The docstring for the new module</li>
</ul>
<p>The model is then the single source of truth for both the argspec and docstring, keeping them in sync. Use the resource module builder to generate this scaffolding. For any subsequent updates to the module, update the model first and use the resource module builder to update the module argspec and docstring.</p>
<p>For example, the resource model builder includes the <code class="docutils literal notranslate"><span class="pre">myos_interfaces.yml</span></code> sample in the <code class="file docutils literal notranslate"><span class="pre">models</span></code> directory, as seen below:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nn">---</span>
<span class="l l-Scalar l-Scalar-Plain">GENERATOR_VERSION</span><span class="p p-Indicator">:</span> <span class="s">&#39;1.0&#39;</span>
<span class="l l-Scalar l-Scalar-Plain">ANSIBLE_METADATA</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">|</span>
    <span class="no">{</span>
        <span class="no">&#39;metadata_version&#39;: &#39;1.1&#39;,</span>
        <span class="no">&#39;status&#39;: [&#39;preview&#39;],</span>
        <span class="no">&#39;supported_by&#39;: &#39;&lt;support_group&gt;&#39;</span>
    <span class="no">}</span>
<span class="l l-Scalar l-Scalar-Plain">NETWORK_OS</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">myos</span>
<span class="l l-Scalar l-Scalar-Plain">RESOURCE</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">interfaces</span>
<span class="l l-Scalar l-Scalar-Plain">COPYRIGHT</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">Copyright 2019 Red Hat</span>
<span class="l l-Scalar l-Scalar-Plain">LICENSE</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">gpl-3.0.txt</span>

<span class="l l-Scalar l-Scalar-Plain">DOCUMENTATION</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">|</span>
  <span class="no">module: myos_interfaces</span>
  <span class="no">version_added: 2.9</span>
  <span class="no">short_description: &#39;Manages &lt;xxxx&gt; attributes of &lt;network_os&gt; &lt;resource&gt;&#39;</span>
  <span class="no">description: &#39;Manages &lt;xxxx&gt; attributes of &lt;network_os&gt; &lt;resource&gt;.&#39;</span>
  <span class="no">author: Ansible Network Engineer</span>
 <span class="l l-Scalar l-Scalar-Plain">notes</span><span class="p p-Indicator">:</span>
    <span class="p p-Indicator">-</span> <span class="s">&#39;Tested</span><span class="nv"> </span><span class="s">against</span><span class="nv"> </span><span class="s">&lt;network_os&gt;</span><span class="nv"> </span><span class="s">&lt;version&gt;&#39;</span>
 <span class=" -Error"> </span><span class="l l-Scalar l-Scalar-Plain">options</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">config</span><span class="p p-Indicator">:</span>
      <span class="l l-Scalar l-Scalar-Plain">description</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">The provided configuration</span>
      <span class="l l-Scalar l-Scalar-Plain">type</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">list</span>
      <span class="l l-Scalar l-Scalar-Plain">elements</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">dict</span>
      <span class="l l-Scalar l-Scalar-Plain">suboptions</span><span class="p p-Indicator">:</span>
        <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span>
          <span class="l l-Scalar l-Scalar-Plain">type</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">str</span>
          <span class="l l-Scalar l-Scalar-Plain">description</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">The name of the &lt;resource&gt;</span>
        <span class="l l-Scalar l-Scalar-Plain">some_string</span><span class="p p-Indicator">:</span>
          <span class="l l-Scalar l-Scalar-Plain">type</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">str</span>
          <span class="l l-Scalar l-Scalar-Plain">description</span><span class="p p-Indicator">:</span>
          <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">The some_string_01</span>
          <span class="l l-Scalar l-Scalar-Plain">choices</span><span class="p p-Indicator">:</span>
          <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">choice_a</span>
          <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">choice_b</span>
          <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">choice_c</span>
          <span class="l l-Scalar l-Scalar-Plain">default</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">choice_a</span>
        <span class="l l-Scalar l-Scalar-Plain">some_bool</span><span class="p p-Indicator">:</span>
          <span class="l l-Scalar l-Scalar-Plain">description</span><span class="p p-Indicator">:</span>
          <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">The some_bool.</span>
          <span class="l l-Scalar l-Scalar-Plain">type</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">bool</span>
        <span class="l l-Scalar l-Scalar-Plain">some_int</span><span class="p p-Indicator">:</span>
          <span class="l l-Scalar l-Scalar-Plain">description</span><span class="p p-Indicator">:</span>
          <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">The some_int.</span>
          <span class="l l-Scalar l-Scalar-Plain">type</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">int</span>
          <span class="l l-Scalar l-Scalar-Plain">version_added</span><span class="p p-Indicator">:</span> <span class="s">&#39;1.1&#39;</span>
        <span class="l l-Scalar l-Scalar-Plain">some_dict</span><span class="p p-Indicator">:</span>
          <span class="l l-Scalar l-Scalar-Plain">type</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">dict</span>
          <span class="l l-Scalar l-Scalar-Plain">description</span><span class="p p-Indicator">:</span>
          <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">The some_dict.</span>
          <span class="l l-Scalar l-Scalar-Plain">suboptions</span><span class="p p-Indicator">:</span>
            <span class="l l-Scalar l-Scalar-Plain">property_01</span><span class="p p-Indicator">:</span>
              <span class="l l-Scalar l-Scalar-Plain">description</span><span class="p p-Indicator">:</span>
              <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">The property_01</span>
              <span class="l l-Scalar l-Scalar-Plain">type</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">str</span>
    <span class="l l-Scalar l-Scalar-Plain">state</span><span class="p p-Indicator">:</span>
      <span class="l l-Scalar l-Scalar-Plain">description</span><span class="p p-Indicator">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">The state of the configuration after module completion.</span>
      <span class="l l-Scalar l-Scalar-Plain">type</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">str</span>
      <span class="l l-Scalar l-Scalar-Plain">choices</span><span class="p p-Indicator">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">merged</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">replaced</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">overridden</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">deleted</span>
      <span class="l l-Scalar l-Scalar-Plain">default</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">merged</span>
<span class="l l-Scalar l-Scalar-Plain">EXAMPLES</span><span class="p p-Indicator">:</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">deleted_example_01.txt</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">merged_example_01.txt</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">overridden_example_01.txt</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">replaced_example_01.txt</span>
</pre></div>
</div>
<p>Notice that you should include examples for each of the states that the resource supports. The resource module builder also includes these in the sample model.</p>
<p>See <a class="reference external" href="https://github.com/ansible-network/resource_module_models">Ansible network resource models</a> for more examples.</p>
</div>
<div class="section" id="using-the-resource-module-builder">
<h2><a class="toc-backref" href="#id3">Using the resource module builder</a><a class="headerlink" href="#using-the-resource-module-builder" title="Permalink to this headline">¶</a></h2>
<p>To use the resource module builder to create a collection scaffold from your resource model:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ansible-playbook -e <span class="nv">rm_dest</span><span class="o">=</span>&lt;destination <span class="k">for</span> modules and module utils&gt; <span class="se">\</span>
                 -e <span class="nv">structure</span><span class="o">=</span>collection <span class="se">\</span>
                 -e <span class="nv">collection_org</span><span class="o">=</span>&lt;collection_org&gt; <span class="se">\</span>
                 -e <span class="nv">collection_name</span><span class="o">=</span>&lt;collection_name&gt; <span class="se">\</span>
                 -e <span class="nv">model</span><span class="o">=</span>&lt;model&gt; <span class="se">\</span>
                 site.yml
</pre></div>
</div>
<p>Where the parameters are as follows:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">rm_dest</span></code>: The directory where the resource module builder places the files and directories for the resource module and facts modules.</li>
<li><code class="docutils literal notranslate"><span class="pre">structure</span></code>: The directory layout type (role or collection)<ul>
<li><code class="docutils literal notranslate"><span class="pre">role</span></code>: Generate a role directory layout.</li>
<li><code class="docutils literal notranslate"><span class="pre">collection</span></code>: Generate a collection directory layout.</li>
</ul>
</li>
<li><code class="docutils literal notranslate"><span class="pre">collection_org</span></code>: The organization of the collection, required when <cite>structure=collection</cite>.</li>
<li><code class="docutils literal notranslate"><span class="pre">collection_name</span></code>: The name of the collection, required when <cite>structure=collection</cite>.</li>
<li><code class="docutils literal notranslate"><span class="pre">model</span></code>: The path to the model file.</li>
</ul>
<p>To use the resource module builder to create a role scaffold:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ansible-playbook -e <span class="nv">rm_dest</span><span class="o">=</span>&lt;destination <span class="k">for</span> modules and module utils&gt; <span class="se">\</span>
                 -e <span class="nv">structure</span><span class="o">=</span>role <span class="se">\</span>
                 -e <span class="nv">model</span><span class="o">=</span>&lt;model&gt; <span class="se">\</span>
                 site.yml
</pre></div>
</div>
</div>
<div class="section" id="examples">
<h2><a class="toc-backref" href="#id4">Examples</a><a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h2>
<div class="section" id="collection-directory-layout">
<h3><a class="toc-backref" href="#id5">Collection directory layout</a><a class="headerlink" href="#collection-directory-layout" title="Permalink to this headline">¶</a></h3>
<p>This example shows the directory layout for the following:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">network_os</span></code>: myos</li>
<li><code class="docutils literal notranslate"><span class="pre">resource</span></code>: interfaces</li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ansible-playbook -e <span class="nv">rm_dest</span><span class="o">=</span>~/github/rm_example <span class="se">\</span>
                 -e <span class="nv">structure</span><span class="o">=</span>collection <span class="se">\</span>
                 -e <span class="nv">collection_org</span><span class="o">=</span>cidrblock <span class="se">\</span>
                 -e <span class="nv">collection_name</span><span class="o">=</span>my_collection <span class="se">\</span>
                 -e <span class="nv">model</span><span class="o">=</span>models/myos/interfaces/myos_interfaces.yml <span class="se">\</span>
                 site.yml
</pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>├── docs
├── LICENSE.txt
├── playbooks
├── plugins
|   ├── action
|   ├── filter
|   ├── inventory
|   ├── modules
|   |   ├── __init__.py
|   |   ├── myos_facts.py
|   |   └──  myos_interfaces.py
|   └──  module_utils
|       ├── __init__.py
|       └──  network
|           ├── __init__.py
|           └──  myos
|               ├── argspec
|               |   ├── facts
|               |   |   ├── facts.py
|               |   |   └──  __init__.py
|               |   ├── __init__.py
|               |   └──  interfaces
|               |       ├── __init__.py
|               |       └──  interfaces.py
|               ├── config
|               |   ├── __init__.py
|               |   └──  interfaces
|               |       ├── __init__.py
|               |       └──  interfaces.py
|               ├── facts
|               |   ├── facts.py
|               |   ├── __init__.py
|               |   └──  interfaces
|               |       ├── __init__.py
|               |       └──  interfaces.py
|               ├── __init__.py
|               └──  utils
|                   ├── __init__.py
|                   └──  utils.py
├── README.md
└──  roles
</pre></div>
</div>
</div>
<div class="section" id="role-directory-layout">
<h3><a class="toc-backref" href="#id6">Role directory layout</a><a class="headerlink" href="#role-directory-layout" title="Permalink to this headline">¶</a></h3>
<p>This example displays the role directory layout for the following:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">network_os</span></code>: myos</li>
<li><code class="docutils literal notranslate"><span class="pre">resource</span></code>: interfaces</li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ansible-playbook -e <span class="nv">rm_dest</span><span class="o">=</span>~/github/rm_example/roles/my_role <span class="se">\</span>
                 -e <span class="nv">structure</span><span class="o">=</span>role <span class="se">\</span>
                 -e <span class="nv">model</span><span class="o">=</span>models/myos/interfaces/myos_interfaces.yml <span class="se">\</span>
                 site.yml
</pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>roles
└── my_role
    ├── library
    │   ├── __init__.py
    │   ├── myos_facts.py
    │   └── myos_interfaces.py
    ├── LICENSE.txt
    ├── module_utils
    │   ├── __init__.py
    │   └── network
    │       ├── __init__.py
    │       └── myos
    │           ├── argspec
    │           │   ├── facts
    │           │   │   ├── facts.py
    │           │   │   └── __init__.py
    │           │   ├── __init__.py
    │           │   └── interfaces
    │           │       ├── __init__.py
    │           │       └── interfaces.py
    │           ├── config
    │           │   ├── __init__.py
    │           │   └── interfaces
    │           │       ├── __init__.py
    │           │       └── interfaces.py
    │           ├── facts
    │           │   ├── facts.py
    │           │   ├── __init__.py
    │           │   └── interfaces
    │           │       ├── __init__.py
    │           │       └── interfaces.py
    │           ├── __init__.py
    │           └── utils
    │               ├── __init__.py
    │               └── utils.py
    └── README.md
</pre></div>
</div>
</div>
<div class="section" id="using-the-collection">
<h3><a class="toc-backref" href="#id7">Using the collection</a><a class="headerlink" href="#using-the-collection" title="Permalink to this headline">¶</a></h3>
<p>This example shows how to use the generated collection in a playbook:</p>
<blockquote>
<div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">----</span>
<span class="l l-Scalar l-Scalar-Plain">- hosts</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">myos101</span>
  <span class="l l-Scalar l-Scalar-Plain">gather_facts</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">False</span>
  <span class="l l-Scalar l-Scalar-Plain">tasks</span><span class="p p-Indicator">:</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">cidrblock.my_collection.myos_interfaces</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">register</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">result</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">debug</span><span class="p p-Indicator">:</span>
      <span class="l l-Scalar l-Scalar-Plain">var</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">result</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">cidrblock.my_collection.myos_facts</span><span class="p p-Indicator">:</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">debug</span><span class="p p-Indicator">:</span>
      <span class="l l-Scalar l-Scalar-Plain">var</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">ansible_network_resources</span>
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="using-the-role">
<h3><a class="toc-backref" href="#id8">Using the role</a><a class="headerlink" href="#using-the-role" title="Permalink to this headline">¶</a></h3>
<p>This example shows how to use the generated role in a playbook:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">hosts</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">myos101</span>
  <span class="l l-Scalar l-Scalar-Plain">gather_facts</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">False</span>
  <span class="l l-Scalar l-Scalar-Plain">roles</span><span class="p p-Indicator">:</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">my_role</span>

<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">hosts</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">myos101</span>
  <span class="l l-Scalar l-Scalar-Plain">gather_facts</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">False</span>
  <span class="l l-Scalar l-Scalar-Plain">tasks</span><span class="p p-Indicator">:</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">myos_interfaces</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">register</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">result</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">debug</span><span class="p p-Indicator">:</span>
      <span class="l l-Scalar l-Scalar-Plain">var</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">result</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">myos_facts</span><span class="p p-Indicator">:</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">debug</span><span class="p p-Indicator">:</span>
      <span class="l l-Scalar l-Scalar-Plain">var</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">ansible_network_resources</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="resource-module-structure-and-workflow">
<h2><a class="toc-backref" href="#id9">Resource module structure and workflow</a><a class="headerlink" href="#resource-module-structure-and-workflow" title="Permalink to this headline">¶</a></h2>
<p>The resource module structure includes the following components:</p>
<dl class="docutils">
<dt>Module</dt>
<dd><ul class="first simple">
<li><code class="docutils literal notranslate"><span class="pre">library/&lt;ansible_network_os&gt;_&lt;resource&gt;.py</span></code>.</li>
<li>Imports the <code class="docutils literal notranslate"><span class="pre">module_utils</span></code> resource package and calls <code class="docutils literal notranslate"><span class="pre">execute_module</span></code> API</li>
</ul>
<div class="last highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">result</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">resource_package</span><span class="o">&gt;</span><span class="p">(</span><span class="n">module</span><span class="p">)</span><span class="o">.</span><span class="n">execute_module</span><span class="p">()</span>
</pre></div>
</div>
</dd>
<dt>Module argspec</dt>
<dd><ul class="first last simple">
<li><code class="docutils literal notranslate"><span class="pre">module_utils/&lt;ansible_network_os&gt;/argspec/&lt;resource&gt;/</span></code>.</li>
<li>Argspec for the resource.</li>
</ul>
</dd>
<dt>Facts</dt>
<dd><ul class="first last simple">
<li><code class="docutils literal notranslate"><span class="pre">module_utils/&lt;ansible_network_os&gt;/facts/&lt;resource&gt;/</span></code>.</li>
<li>Populate facts for the resource.</li>
<li>Entry in <code class="docutils literal notranslate"><span class="pre">module_utils/&lt;ansible_network_os&gt;/facts/facts.py</span></code> for <code class="docutils literal notranslate"><span class="pre">get_facts</span></code> API to keep <code class="docutils literal notranslate"><span class="pre">&lt;ansible_network_os&gt;_facts</span></code> module and facts gathered for the resource module in sync for every subset.</li>
<li>Entry of Resource subset in FACTS_RESOURCE_SUBSETS list in <code class="docutils literal notranslate"><span class="pre">module_utils/&lt;ansible_network_os&gt;/facts/facts.py</span></code> to make facts collection work.</li>
</ul>
</dd>
<dt>Module package in module_utils</dt>
<dd><ul class="first last simple">
<li><code class="docutils literal notranslate"><span class="pre">module_utils/&lt;ansible_network_os&gt;/&lt;config&gt;/&lt;resource&gt;/</span></code>.</li>
<li>Implement <code class="docutils literal notranslate"><span class="pre">execute_module</span></code> API that loads the configuration to device and generates the result with <code class="docutils literal notranslate"><span class="pre">changed</span></code>, <code class="docutils literal notranslate"><span class="pre">commands</span></code>, <code class="docutils literal notranslate"><span class="pre">before</span></code> and <code class="docutils literal notranslate"><span class="pre">after</span></code> keys.</li>
<li>Call <code class="docutils literal notranslate"><span class="pre">get_facts</span></code> API that returns the <code class="docutils literal notranslate"><span class="pre">&lt;resource&gt;</span></code> configuration facts or return the difference if the device has onbox diff support.</li>
<li>Compare facts gathered and given key-values if diff is not supported.</li>
<li>Generate final configuration.</li>
</ul>
</dd>
<dt>Utils</dt>
<dd><ul class="first last simple">
<li><code class="docutils literal notranslate"><span class="pre">module_utils/&lt;ansible_network_os&gt;/utils</span></code>.</li>
<li>Utilities for the <code class="docutils literal notranslate"><span class="pre">&lt;ansible_network_os&gt;</span></code> platform.</li>
</ul>
</dd>
</dl>
</div>
<div class="section" id="developer-notes">
<h2><a class="toc-backref" href="#id10">Developer notes</a><a class="headerlink" href="#developer-notes" title="Permalink to this headline">¶</a></h2>
<p>The tests rely on a role generated by the resource module builder. After changes to the resource module builder, the role should be regenerated and the tests modified and run as needed. To generate the role after changes:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>rm -rf rmb_tests/roles/my_role
ansible-playbook -e <span class="nv">rm_dest</span><span class="o">=</span>./rmb_tests/roles/my_role <span class="se">\</span>
                 -e <span class="nv">structure</span><span class="o">=</span>role <span class="se">\</span>
                 -e <span class="nv">model</span><span class="o">=</span>models/myos/interfaces/myos_interfaces.yml <span class="se">\</span>
                 site.yml
</pre></div>
</div>
</div>
<div class="section" id="unit-testing-ansible-network-resource-modules">
<span id="testing-resource-modules"></span><h2><a class="toc-backref" href="#id11">Unit testing Ansible network resource modules</a><a class="headerlink" href="#unit-testing-ansible-network-resource-modules" title="Permalink to this headline">¶</a></h2>
<p>This section walks through an example of how to develop unit tests for Ansible network resource
modules.</p>
<p>See <a class="reference internal" href="../../dev_guide/testing_units.html#testing-units"><span class="std std-ref">Unit Tests</span></a> and <a class="reference internal" href="../../dev_guide/testing_units_modules.html#testing-units-modules"><span class="std std-ref">Unit Testing Ansible Modules</span></a> for general documentation on Ansible unit tests for modules.
Please read those pages first to understand unit tests and why and when you should use them.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The structure of the unit tests matches
the structure of the code base, so the tests that reside in the <code class="file docutils literal notranslate"><span class="pre">test/units/modules/network</span></code> directory
are organized by module groups.</p>
</div>
<div class="section" id="using-mock-objects-to-unit-test-ansible-network-resource-modules">
<h3><a class="toc-backref" href="#id12">Using mock objects to unit test Ansible network resource modules</a><a class="headerlink" href="#using-mock-objects-to-unit-test-ansible-network-resource-modules" title="Permalink to this headline">¶</a></h3>
<p>Mock objects (from <a class="reference external" href="https://docs.python.org/3/library/unittest.mock.html">https://docs.python.org/3/library/unittest.mock.html</a>) can be very
useful in building unit tests for special or difficult cases, but they can also
lead to complex and confusing coding situations.  One good use for mocks would be to
simulate an API. The <code class="docutils literal notranslate"><span class="pre">mock</span></code> Python package is bundled with Ansible (use
<code class="docutils literal notranslate"><span class="pre">import</span> <span class="pre">units.compat.mock</span></code>).</p>
<p>You can mock the device connection and output from the device as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="bp">self</span><span class="o">.</span><span class="n">mock_get_config</span> <span class="o">=</span> <span class="n">patch</span><span class="p">(</span><span class="s1">&#39;ansible.module_utils.network.common.network.Config.get_config&#39;</span><span class="p">)</span>
<span class="bp">self</span><span class="o">.</span><span class="n">get_config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mock_get_config</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

<span class="bp">self</span><span class="o">.</span><span class="n">mock_load_config</span> <span class="o">=</span> <span class="n">patch</span><span class="p">(</span><span class="s1">&#39;ansible.module_utils.network.common.network.Config.load_config&#39;</span><span class="p">)</span>
<span class="bp">self</span><span class="o">.</span><span class="n">load_config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mock_load_config</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

<span class="bp">self</span><span class="o">.</span><span class="n">mock_get_resource_connection_config</span> <span class="o">=</span> <span class="n">patch</span><span class="p">(</span><span class="s1">&#39;ansible.module_utils.network.common.cfg.base.get_resource_connection&#39;</span><span class="p">)</span>
<span class="bp">self</span><span class="o">.</span><span class="n">get_resource_connection_config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mock_get_resource_connection_config</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

<span class="bp">self</span><span class="o">.</span><span class="n">mock_get_resource_connection_facts</span> <span class="o">=</span> <span class="n">patch</span><span class="p">(</span><span class="s1">&#39;ansible.module_utils.network.common.facts.facts.get_resource_connection&#39;</span><span class="p">)</span>
<span class="bp">self</span><span class="o">.</span><span class="n">get_resource_connection_facts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mock_get_resource_connection_facts</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

<span class="bp">self</span><span class="o">.</span><span class="n">mock_edit_config</span> <span class="o">=</span> <span class="n">patch</span><span class="p">(</span><span class="s1">&#39;ansible.module_utils.network.eos.providers.providers.CliProvider.edit_config&#39;</span><span class="p">)</span>
<span class="bp">self</span><span class="o">.</span><span class="n">edit_config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mock_edit_config</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

<span class="bp">self</span><span class="o">.</span><span class="n">mock_execute_show_command</span> <span class="o">=</span> <span class="n">patch</span><span class="p">(</span><span class="s1">&#39;ansible.module_utils.network.eos.facts.l2_interfaces.l2_interfaces.L2_interfacesFacts.get_device_data&#39;</span><span class="p">)</span>
<span class="bp">self</span><span class="o">.</span><span class="n">execute_show_command</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mock_execute_show_command</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</pre></div>
</div>
<p>The facts file of the module now includes a new method, <code class="docutils literal notranslate"><span class="pre">get_device_data</span></code>. Call <code class="docutils literal notranslate"><span class="pre">get_device_data</span></code> here to emulate the device output.</p>
</div>
<div class="section" id="mocking-device-data">
<h3><a class="toc-backref" href="#id13">Mocking device data</a><a class="headerlink" href="#mocking-device-data" title="Permalink to this headline">¶</a></h3>
<p>To mock fetching results from devices or provide other complex data structures that
come from external libraries, you can use <code class="docutils literal notranslate"><span class="pre">fixtures</span></code> to read in pre-generated data. The text files for this pre-generated data live in <code class="docutils literal notranslate"><span class="pre">test/units/modules/network/PLATFORM/fixtures/</span></code>. See for example the <a class="reference external" href="https://github.com/ansible/ansible/blob/devel/test/units/modules/network/eos/fixtures/eos_l2_interfaces_config.cfg">eos_l2_interfaces.cfg file</a>.</p>
<p>Load data using the <code class="docutils literal notranslate"><span class="pre">load_fixture</span></code> method and set this data as the return value of the
<code class="docutils literal notranslate"><span class="pre">get_device_data</span></code> method in the facts file:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">load_fixtures</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">commands</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">transport</span><span class="o">=</span><span class="s1">&#39;cli&#39;</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">load_from_file</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">load_fixture</span><span class="p">(</span><span class="s1">&#39;eos_l2_interfaces_config.cfg&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">execute_show_command</span><span class="o">.</span><span class="n">side_effect</span> <span class="o">=</span> <span class="n">load_from_file</span>
</pre></div>
</div>
<p>See the unit test file <a class="reference external" href="https://github.com/ansible/ansible/blob/devel/test/units/modules/network/eos/test_eos_l2_interfaces.py">test_eos_l2_interfaces</a>
for a practical example.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="../../dev_guide/testing_units.html#testing-units"><span class="std std-ref">Unit Tests</span></a></dt>
<dd>Ansible unit tests documentation</dd>
<dt><a class="reference internal" href="../../dev_guide/testing_units.html#testing-units"><span class="std std-ref">Unit Tests</span></a></dt>
<dd>Deep dive into developing unit tests for Ansible modules</dd>
<dt><a class="reference internal" href="../../dev_guide/testing_running_locally.html#testing-running-locally"><span class="std std-ref">Testing Ansible</span></a></dt>
<dd>Running tests locally including gathering and reporting coverage data</dd>
<dt><a class="reference internal" href="../../dev_guide/developing_modules_general.html#developing-modules-general"><span class="std std-ref">Ansible module development: getting started</span></a></dt>
<dd>Get started developing a module</dd>
</dl>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons">
      
        <a href="developing_plugins_network.html" class="btn btn-neutral float-right" title="Network connection plugins"/>Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral" title="Network Automation Developer Guide"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>


<script type="text/javascript">
  (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
  (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
  e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
  })(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');

  _st('install','yABGvz2N8PwcwBxyfzUc','2.0.0');
</script>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019 Red Hat, Inc.
      <span class="lastupdated">
        Last updated on Aug 10, 2020.
      </span>

    </p>
  </div> 
</footer>
        </div>
      </div>

    </section>

  </div>

  <script type="text/javascript">
      jQuery(function () {
          
          SphinxRtdTheme.Navigation.enableSticky();
          
      });
  </script>

  
  
    
   <!-- extra footer elements for Ansible beyond RTD Sphinx Theme --->
<!-- begin analytics -->
<script type="text/javascript">
var _hsq = _hsq || [];
_hsq.push(["setContentType", "standard-page"]);
      (function(d,s,i,r) {
      if (d.getElementById(i)){return;}
      var n = d.createElement(s),e = document.getElementsByTagName(s)[0];
      n.id=i;n.src = '//js.hs-analytics.net/analytics/'+(Math.ceil(new Date()/r)*r)+'/330046.js';
      e.parentNode.insertBefore(n, e);
      })(document, "script", "hs-analytics",300000);
</script>
<!-- end analytics -->
<script type="text/javascript">
if (("undefined" !== typeof _satellite) && ("function" === typeof _satellite.pageBottom)) {
  _satellite.pageBottom();
}
</script> 

</body>
</html>